Dim queryGroupByDiv As String
queryGroupByDiv = "SELECT   " 
queryGroupByDiv = queryGroupByDiv & "CASE WHEN (sc.spend_base_seq IN (1, 2, 3, 4, 5))THEN 'Distributor' "
queryGroupByDiv = queryGroupByDiv & "     WHEN (sc.spend_base_seq = 6)THEN 'Operator' "
queryGroupByDiv = queryGroupByDiv & "END AS businessunit, "
queryGroupByDiv = queryGroupByDiv & "CASE WHEN (md.FISCAL_MONTH_NUMBER = (:p_Month))THEN SUM (epf.expense_amt) "
queryGroupByDiv = queryGroupByDiv & "END AS monthexpense_amt, "
queryGroupByDiv = queryGroupByDiv & "0 AS monthpounds, "
queryGroupByDiv = queryGroupByDiv & "0 AS monthnetreceivables, "
queryGroupByDiv = queryGroupByDiv & "gd.GROUP_CODE, "
queryGroupByDiv = queryGroupByDiv & "groupdescr.GROUP_DESCR, "
queryGroupByDiv = queryGroupByDiv & "m.DIVISION_CODE, "
queryGroupByDiv = queryGroupByDiv & "m.DIVISION_DESCR, "
queryGroupByDiv = queryGroupByDiv & "mpbd.business_division_code, "
queryGroupByDiv = queryGroupByDiv & "INITCAP (mpbd.business_division_descr) AS businessdivisiondescr, "
queryGroupByDiv = queryGroupByDiv & "sc.spend_base_descr, "
queryGroupByDiv = queryGroupByDiv & "sc.spend_base_seq, "
queryGroupByDiv = queryGroupByDiv & "sc.spend_subcategory_descr, "
queryGroupByDiv = queryGroupByDiv & "sc.spend_subcategory_seq, "
queryGroupByDiv = queryGroupByDiv & "md.year_descr, "
queryGroupByDiv = queryGroupByDiv & "md.month_descr, "
queryGroupByDiv = queryGroupByDiv & "SUM (epf.expense_amt) AS expense_amt, "
queryGroupByDiv = queryGroupByDiv & "0 AS total_pounds_shipped, "
queryGroupByDiv = queryGroupByDiv & "0 AS net_receivable_dollar "
queryGroupByDiv = queryGroupByDiv & "FROM tdw_owner.restated_mkt_prd_bus_div_dim mpbd, "
queryGroupByDiv = queryGroupByDiv & "tdw_owner.expense_payment_fact epf, "
queryGroupByDiv = queryGroupByDiv & "tdw_owner.fsv_spend_category sc, "
queryGroupByDiv = queryGroupByDiv & "tdw_owner.restated_market m, "
queryGroupByDiv = queryGroupByDiv & "tdw_owner.month_dim md, "
queryGroupByDiv = queryGroupByDiv & "tdw_owner.restated_product p, "
queryGroupByDiv = queryGroupByDiv & "tdw_owner.acct_dim a, "
queryGroupByDiv = queryGroupByDiv & "tdw_owner.expense_type et, "
queryGroupByDiv = queryGroupByDiv & "tdw_owner.spend_request_dim s, "
queryGroupByDiv = queryGroupByDiv & "tdw_owner.operator_dim o, "
queryGroupByDiv = queryGroupByDiv & "tdw_owner.day_dim d1, "
queryGroupByDiv = queryGroupByDiv & "tdw_owner.day_dim d2, "
queryGroupByDiv = queryGroupByDiv & "tdw_owner.expense_attribute_dim ead, "
queryGroupByDiv = queryGroupByDiv & "tdw_owner.expense_payee_dim pay, "
queryGroupByDiv = queryGroupByDiv & "tdw_owner.group_detail gd, "
queryGroupByDiv = queryGroupByDiv & "tdw_owner.group_description groupdescr "
queryGroupByDiv = queryGroupByDiv & "WHERE mpbd.restated_mkt_prd_bus_div_key = epf.restated_mkt_prd_bus_div_key "
queryGroupByDiv = queryGroupByDiv & "AND epf.expense_type_key = sc.expense_type_key "
queryGroupByDiv = queryGroupByDiv & "AND epf.acct_key = sc.acct_key "
queryGroupByDiv = queryGroupByDiv & "AND epf.restated_market_key = m.restated_market_key "
queryGroupByDiv = queryGroupByDiv & "AND epf.month_key = md.month_key "
queryGroupByDiv = queryGroupByDiv & "AND epf.restated_product_key = p.restated_product_key "
queryGroupByDiv = queryGroupByDiv & "AND epf.acct_key = a.acct_key "
queryGroupByDiv = queryGroupByDiv & "AND epf.expense_type_key = et.expense_type_key "
queryGroupByDiv = queryGroupByDiv & "AND epf.spend_request_key = s.spend_request_key "
queryGroupByDiv = queryGroupByDiv & "AND epf.operator_key = o.operator_key "
queryGroupByDiv = queryGroupByDiv & "AND epf.report_period_begin_day_key = d1.day_key "
queryGroupByDiv = queryGroupByDiv & "AND epf.report_period_end_day_key = d2.day_key "
queryGroupByDiv = queryGroupByDiv & "AND epf.expense_attribute_key = ead.expense_attribute_key "
queryGroupByDiv = queryGroupByDiv & "AND epf.expense_payee_key = pay.expense_payee_key "
queryGroupByDiv = queryGroupByDiv & "AND gd.GROUP_CODE = groupdescr.GROUP_CODE "
queryGroupByDiv = queryGroupByDiv & "AND gd.group_field_c  =  m.DIVISION_CODE "
queryGroupByDiv = queryGroupByDiv & "AND sc.spend_base_seq e> 0 "
queryGroupByDiv = queryGroupByDiv & "AND sc.spend_subcategory_seq <> 0 "
queryGroupByDiv = queryGroupByDiv & "AND (mpbd.business_division_code IN ('F01', 'F03', 'F04', 'F08', 'F15')) "
queryGroupByDiv = queryGroupByDiv & "AND (m.selling_group_code IN ('119000', '125000', '610000', '800000', '423000')) "
queryGroupByDiv = queryGroupByDiv & "AND (md.year_descr IN (:p_year)) "
queryGroupByDiv = queryGroupByDiv & "and md.fiscal_month_number <= :p_Month "
queryGroupByDiv = queryGroupByDiv & "AND (mpbd.business_division_code IN (:p_businessdivision)) "
queryGroupByDiv = queryGroupByDiv & "AND (m.division_code IN (:p_salesdivision)) "
queryGroupByDiv = queryGroupByDiv & "AND (m.region_code IN (:p_salesregion)) "
queryGroupByDiv = queryGroupByDiv & "AND (m.primary_broker_code IN (:p_primarybroker)) "
queryGroupByDiv = queryGroupByDiv & "AND gd.GROUP_CODE in (:vp) "
queryGroupByDiv = queryGroupByDiv & "GROUP BY  "
queryGroupByDiv = queryGroupByDiv & "gd.GROUP_CODE, "
queryGroupByDiv = queryGroupByDiv & "groupdescr.GROUP_DESCR, "
queryGroupByDiv = queryGroupByDiv & "m.DIVISION_CODE, "
queryGroupByDiv = queryGroupByDiv & "m.DIVISION_DESCR, "
queryGroupByDiv = queryGroupByDiv & "mpbd.business_division_code, "
queryGroupByDiv = queryGroupByDiv & "INITCAP (mpbd.business_division_descr), "
queryGroupByDiv = queryGroupByDiv & "sc.spend_base_descr, "
queryGroupByDiv = queryGroupByDiv & "sc.spend_base_seq, "
queryGroupByDiv = queryGroupByDiv & "sc.spend_subcategory_descr, "
queryGroupByDiv = queryGroupByDiv & "sc.spend_subcategory_seq, "
queryGroupByDiv = queryGroupByDiv & "md.year_descr, "
queryGroupByDiv = queryGroupByDiv & "md.month_descr, "
queryGroupByDiv = queryGroupByDiv & "md.FISCAL_MONTH_NUMBER "
queryGroupByDiv = queryGroupByDiv & "---Add Expense Total Value Added "
queryGroupByDiv = queryGroupByDiv & "UNION "
queryGroupByDiv = queryGroupByDiv & "SELECT    "
queryGroupByDiv = queryGroupByDiv & "CASE WHEN (sc.spend_base_seq IN (1, 2, 3, 4, 5))THEN 'Distributor' "
queryGroupByDiv = queryGroupByDiv & "     WHEN (sc.spend_base_seq = 6)THEN 'Operator' "
queryGroupByDiv = queryGroupByDiv & "END AS businessunit, "
queryGroupByDiv = queryGroupByDiv & "CASE WHEN (md.FISCAL_MONTH_NUMBER = (:p_Month))THEN SUM (epf.expense_amt) "
queryGroupByDiv = queryGroupByDiv & "END AS monthexpense_amt, "
queryGroupByDiv = queryGroupByDiv & "0 AS monthpounds, "
queryGroupByDiv = queryGroupByDiv & "0 AS monthnetreceivables, "
queryGroupByDiv = queryGroupByDiv & "gd.GROUP_CODE, "
queryGroupByDiv = queryGroupByDiv & "groupdescr.GROUP_DESCR, "
queryGroupByDiv = queryGroupByDiv & "m.DIVISION_CODE, "
queryGroupByDiv = queryGroupByDiv & "m.DIVISION_DESCR, "
queryGroupByDiv = queryGroupByDiv & "mpbd.business_division_code, "
queryGroupByDiv = queryGroupByDiv & "'Total Value Added' AS businessdivisiondescr, "
queryGroupByDiv = queryGroupByDiv & "sc.spend_base_descr, "
queryGroupByDiv = queryGroupByDiv & "sc.spend_base_seq, "
queryGroupByDiv = queryGroupByDiv & "sc.spend_subcategory_descr, "
queryGroupByDiv = queryGroupByDiv & "sc.spend_subcategory_seq, "
queryGroupByDiv = queryGroupByDiv & "md.year_descr, "
queryGroupByDiv = queryGroupByDiv & "md.month_descr, "
queryGroupByDiv = queryGroupByDiv & "SUM (epf.expense_amt) AS expense_amt, "
queryGroupByDiv = queryGroupByDiv & "0 AS total_pounds_shipped, "
queryGroupByDiv = queryGroupByDiv & "0 AS net_receivable_dollar "
queryGroupByDiv = queryGroupByDiv & "FROM tdw_owner.restated_mkt_prd_bus_div_dim mpbd, "
queryGroupByDiv = queryGroupByDiv & "tdw_owner.expense_payment_fact epf, "
queryGroupByDiv = queryGroupByDiv & "tdw_owner.fsv_spend_category sc, "
queryGroupByDiv = queryGroupByDiv & "tdw_owner.restated_market m, "
queryGroupByDiv = queryGroupByDiv & "tdw_owner.month_dim md, "
queryGroupByDiv = queryGroupByDiv & "tdw_owner.restated_product p, "
queryGroupByDiv = queryGroupByDiv & "tdw_owner.acct_dim a, "
queryGroupByDiv = queryGroupByDiv & "tdw_owner.expense_type et, "
queryGroupByDiv = queryGroupByDiv & "tdw_owner.spend_request_dim s, "
queryGroupByDiv = queryGroupByDiv & "tdw_owner.operator_dim o, "
queryGroupByDiv = queryGroupByDiv & "tdw_owner.day_dim d1, "
queryGroupByDiv = queryGroupByDiv & "tdw_owner.day_dim d2, "
queryGroupByDiv = queryGroupByDiv & "tdw_owner.expense_attribute_dim ead, "
queryGroupByDiv = queryGroupByDiv & "tdw_owner.expense_payee_dim pay, "
queryGroupByDiv = queryGroupByDiv & "tdw_owner.group_detail gd, "
queryGroupByDiv = queryGroupByDiv & "tdw_owner.group_description groupdescr "
queryGroupByDiv = queryGroupByDiv & "WHERE mpbd.restated_mkt_prd_bus_div_key = epf.restated_mkt_prd_bus_div_key "
queryGroupByDiv = queryGroupByDiv & "AND epf.expense_type_key = sc.expense_type_key "
queryGroupByDiv = queryGroupByDiv & "AND epf.acct_key = sc.acct_key "
queryGroupByDiv = queryGroupByDiv & "AND epf.restated_market_key = m.restated_market_key "
queryGroupByDiv = queryGroupByDiv & "AND epf.month_key = md.month_key "
queryGroupByDiv = queryGroupByDiv & "AND epf.restated_product_key = p.restated_product_key "
queryGroupByDiv = queryGroupByDiv & "AND epf.acct_key = a.acct_key "
queryGroupByDiv = queryGroupByDiv & "AND epf.expense_type_key = et.expense_type_key "
queryGroupByDiv = queryGroupByDiv & "AND epf.spend_request_key = s.spend_request_key "
queryGroupByDiv = queryGroupByDiv & "AND epf.operator_key = o.operator_key "
queryGroupByDiv = queryGroupByDiv & "AND epf.report_period_begin_day_key = d1.day_key "
queryGroupByDiv = queryGroupByDiv & "AND epf.report_period_end_day_key = d2.day_key "
queryGroupByDiv = queryGroupByDiv & "AND epf.expense_attribute_key = ead.expense_attribute_key "
queryGroupByDiv = queryGroupByDiv & "AND epf.expense_payee_key = pay.expense_payee_key "
queryGroupByDiv = queryGroupByDiv & "AND gd.GROUP_CODE = groupdescr.GROUP_CODE "
queryGroupByDiv = queryGroupByDiv & "AND gd.group_field_c  =  m.DIVISION_CODE "
queryGroupByDiv = queryGroupByDiv & "AND sc.spend_base_seq <> 0 "
queryGroupByDiv = queryGroupByDiv & "AND sc.spend_subcategory_seq <> 0 "
queryGroupByDiv = queryGroupByDiv & "AND (mpbd.business_division_code IN ('F01', 'F03', 'F04', 'F08', 'F15')) "
queryGroupByDiv = queryGroupByDiv & "AND (m.selling_group_code IN ('119000', '125000', '610000', '800000', '423000')) "
queryGroupByDiv = queryGroupByDiv & "AND (md.year_descr IN (:p_year)) "
queryGroupByDiv = queryGroupByDiv & "and md.fiscal_month_number <= :p_Month "
queryGroupByDiv = queryGroupByDiv & "AND (mpbd.business_division_code IN (:p_businessdivision)) "
queryGroupByDiv = queryGroupByDiv & "AND (m.division_code IN (:p_salesdivision)) "
queryGroupByDiv = queryGroupByDiv & "AND (m.region_code IN (:p_salesregion)) "
queryGroupByDiv = queryGroupByDiv & "AND (m.primary_broker_code IN (:p_primarybroker)) "
queryGroupByDiv = queryGroupByDiv & "AND gd.GROUP_CODE in (:vp) "
queryGroupByDiv = queryGroupByDiv & "GROUP BY  "
queryGroupByDiv = queryGroupByDiv & "gd.GROUP_CODE, "
queryGroupByDiv = queryGroupByDiv & "groupdescr.GROUP_DESCR, "
queryGroupByDiv = queryGroupByDiv & "m.DIVISION_CODE, "
queryGroupByDiv = queryGroupByDiv & "m.DIVISION_DESCR, "
queryGroupByDiv = queryGroupByDiv & "mpbd.business_division_code, "
queryGroupByDiv = queryGroupByDiv & "'Total Value Added' , "
queryGroupByDiv = queryGroupByDiv & "sc.spend_base_descr, "
queryGroupByDiv = queryGroupByDiv & "sc.spend_base_seq, "
queryGroupByDiv = queryGroupByDiv & "sc.spend_subcategory_descr, "
queryGroupByDiv = queryGroupByDiv & "sc.spend_subcategory_seq, "
queryGroupByDiv = queryGroupByDiv & "md.year_descr, "
queryGroupByDiv = queryGroupByDiv & "md.month_descr, "
queryGroupByDiv = queryGroupByDiv & "md.FISCAL_MONTH_NUMBER, "
queryGroupByDiv = queryGroupByDiv & "mpbd.business_division_Descr "
queryGroupByDiv = queryGroupByDiv & "--Begin Expense Total Market/CVP "
queryGroupByDiv = queryGroupByDiv & "UNION "
queryGroupByDiv = queryGroupByDiv & "SELECT    "
queryGroupByDiv = queryGroupByDiv & "CASE WHEN (sc.spend_base_seq IN (1, 2, 3, 4, 5))THEN 'Distributor' "
queryGroupByDiv = queryGroupByDiv & "     WHEN (sc.spend_base_seq = 6)THEN 'Operator' "
queryGroupByDiv = queryGroupByDiv & "END AS businessunit, "
queryGroupByDiv = queryGroupByDiv & "CASE WHEN (md.FISCAL_MONTH_NUMBER = (:p_Month))THEN SUM (epf.expense_amt) "
queryGroupByDiv = queryGroupByDiv & "END AS monthexpense_amt, "
queryGroupByDiv = queryGroupByDiv & "0 AS monthpounds, "
queryGroupByDiv = queryGroupByDiv & "0 AS monthnetreceivables, "
queryGroupByDiv = queryGroupByDiv & "gd.GROUP_CODE, "
queryGroupByDiv = queryGroupByDiv & "groupdescr.GROUP_DESCR, "
queryGroupByDiv = queryGroupByDiv & "m.DIVISION_CODE, "
queryGroupByDiv = queryGroupByDiv & "m.DIVISION_DESCR, "
queryGroupByDiv = queryGroupByDiv & "mpbd.business_division_code, "
queryGroupByDiv = queryGroupByDiv & "'Total Market/CVP' AS businessdivisiondescr, "
queryGroupByDiv = queryGroupByDiv & "sc.spend_base_descr, "
queryGroupByDiv = queryGroupByDiv & "sc.spend_base_seq, "
queryGroupByDiv = queryGroupByDiv & "sc.spend_subcategory_descr, "
queryGroupByDiv = queryGroupByDiv & "sc.spend_subcategory_seq, "
queryGroupByDiv = queryGroupByDiv & "md.year_descr, "
queryGroupByDiv = queryGroupByDiv & "md.month_descr, "
queryGroupByDiv = queryGroupByDiv & "SUM (epf.expense_amt) AS expense_amt, "
queryGroupByDiv = queryGroupByDiv & "0 AS total_pounds_shipped, "
queryGroupByDiv = queryGroupByDiv & "0 AS net_receivable_dollar "
queryGroupByDiv = queryGroupByDiv & "FROM tdw_owner.restated_mkt_prd_bus_div_dim mpbd, "
queryGroupByDiv = queryGroupByDiv & "tdw_owner.expense_payment_fact epf, "
queryGroupByDiv = queryGroupByDiv & "tdw_owner.fsv_spend_category sc, "
queryGroupByDiv = queryGroupByDiv & "tdw_owner.restated_market m, "
queryGroupByDiv = queryGroupByDiv & "tdw_owner.month_dim md, "
queryGroupByDiv = queryGroupByDiv & "tdw_owner.restated_product p, "
queryGroupByDiv = queryGroupByDiv & "tdw_owner.acct_dim a, "
queryGroupByDiv = queryGroupByDiv & "tdw_owner.expense_type et, "
queryGroupByDiv = queryGroupByDiv & "tdw_owner.spend_request_dim s, "
queryGroupByDiv = queryGroupByDiv & "tdw_owner.operator_dim o, "
queryGroupByDiv = queryGroupByDiv & "tdw_owner.day_dim d1, "
queryGroupByDiv = queryGroupByDiv & "tdw_owner.day_dim d2, "
queryGroupByDiv = queryGroupByDiv & "tdw_owner.expense_attribute_dim ead, "
queryGroupByDiv = queryGroupByDiv & "tdw_owner.expense_payee_dim pay, "
queryGroupByDiv = queryGroupByDiv & "tdw_owner.group_detail gd, "
queryGroupByDiv = queryGroupByDiv & "tdw_owner.group_description groupdescr "
queryGroupByDiv = queryGroupByDiv & "WHERE mpbd.restated_mkt_prd_bus_div_key = epf.restated_mkt_prd_bus_div_key "
queryGroupByDiv = queryGroupByDiv & "AND epf.expense_type_key = sc.expense_type_key "
queryGroupByDiv = queryGroupByDiv & "AND epf.acct_key = sc.acct_key "
queryGroupByDiv = queryGroupByDiv & "AND epf.restated_market_key = m.restated_market_key "
queryGroupByDiv = queryGroupByDiv & "AND epf.month_key = md.month_key "
queryGroupByDiv = queryGroupByDiv & "AND epf.restated_product_key = p.restated_product_key "
queryGroupByDiv = queryGroupByDiv & "AND epf.acct_key = a.acct_key "
queryGroupByDiv = queryGroupByDiv & "AND epf.expense_type_key = et.expense_type_key "
queryGroupByDiv = queryGroupByDiv & "AND epf.spend_request_key = s.spend_request_key "
queryGroupByDiv = queryGroupByDiv & "AND epf.operator_key = o.operator_key "
queryGroupByDiv = queryGroupByDiv & "AND epf.report_period_begin_day_key = d1.day_key "
queryGroupByDiv = queryGroupByDiv & "AND epf.report_period_end_day_key = d2.day_key "
queryGroupByDiv = queryGroupByDiv & "AND epf.expense_attribute_key = ead.expense_attribute_key "
queryGroupByDiv = queryGroupByDiv & "AND epf.expense_payee_key = pay.expense_payee_key "
queryGroupByDiv = queryGroupByDiv & "AND gd.GROUP_CODE = groupdescr.GROUP_CODE "
queryGroupByDiv = queryGroupByDiv & "AND gd.group_field_c  =  m.DIVISION_CODE "
queryGroupByDiv = queryGroupByDiv & "AND sc.spend_base_seq <> 0 "
queryGroupByDiv = queryGroupByDiv & "AND sc.spend_subcategory_seq <> 0 "
queryGroupByDiv = queryGroupByDiv & "AND (mpbd.business_division_code IN ('F01', 'F03', 'F04', 'F08', 'F15')) "
queryGroupByDiv = queryGroupByDiv & "AND (m.selling_group_code IN ('119000', '125000', '610000', '800000', '423000')) "
queryGroupByDiv = queryGroupByDiv & "AND (md.year_descr IN (:p_year)) "
queryGroupByDiv = queryGroupByDiv & "and md.fiscal_month_number <= :p_Month "
queryGroupByDiv = queryGroupByDiv & "AND (mpbd.business_division_code IN (:p_businessdivision)) "
queryGroupByDiv = queryGroupByDiv & "AND (m.division_code IN (:p_salesdivision)) "
queryGroupByDiv = queryGroupByDiv & "AND (m.region_code IN (:p_salesregion)) "
queryGroupByDiv = queryGroupByDiv & "AND (m.primary_broker_code IN (:p_primarybroker)) "
queryGroupByDiv = queryGroupByDiv & "AND gd.GROUP_CODE in (:vp) "
queryGroupByDiv = queryGroupByDiv & "GROUP BY  "
queryGroupByDiv = queryGroupByDiv & "gd.GROUP_CODE, "
queryGroupByDiv = queryGroupByDiv & "groupdescr.GROUP_DESCR, "
queryGroupByDiv = queryGroupByDiv & "m.DIVISION_CODE, "
queryGroupByDiv = queryGroupByDiv & "m.DIVISION_DESCR, "
queryGroupByDiv = queryGroupByDiv & "mpbd.business_division_code, "
queryGroupByDiv = queryGroupByDiv & "'Total Market/CVP', "
queryGroupByDiv = queryGroupByDiv & "sc.spend_base_descr, "
queryGroupByDiv = queryGroupByDiv & "sc.spend_base_seq, "
queryGroupByDiv = queryGroupByDiv & "sc.spend_subcategory_descr, "
queryGroupByDiv = queryGroupByDiv & "sc.spend_subcategory_seq, "
queryGroupByDiv = queryGroupByDiv & "md.year_descr, "
queryGroupByDiv = queryGroupByDiv & "md.month_descr, "
queryGroupByDiv = queryGroupByDiv & "md.FISCAL_MONTH_NUMBER, "
queryGroupByDiv = queryGroupByDiv & "mpbd.business_division_Descr "
queryGroupByDiv = queryGroupByDiv & "--Begin Expense TotalCustomer "
queryGroupByDiv = queryGroupByDiv & "UNION "
queryGroupByDiv = queryGroupByDiv & "SELECT    "
queryGroupByDiv = queryGroupByDiv & "CASE WHEN (sc.spend_base_seq IN (1, 2, 3, 4, 5))THEN 'Distributor' "
queryGroupByDiv = queryGroupByDiv & "     WHEN (sc.spend_base_seq = 6)THEN 'Operator' "
queryGroupByDiv = queryGroupByDiv & "END AS businessunit, "
queryGroupByDiv = queryGroupByDiv & "CASE WHEN (md.FISCAL_MONTH_NUMBER = (:p_Month))THEN SUM (epf.expense_amt) "
queryGroupByDiv = queryGroupByDiv & "END AS monthexpense_amt, "
queryGroupByDiv = queryGroupByDiv & "0 AS monthpounds, "
queryGroupByDiv = queryGroupByDiv & "0 AS monthnetreceivables, "
queryGroupByDiv = queryGroupByDiv & "gd.GROUP_CODE, "
queryGroupByDiv = queryGroupByDiv & "groupdescr.GROUP_DESCR, "
queryGroupByDiv = queryGroupByDiv & "m.DIVISION_CODE, "
queryGroupByDiv = queryGroupByDiv & "m.DIVISION_DESCR, "
queryGroupByDiv = queryGroupByDiv & "mpbd.business_division_code, "
queryGroupByDiv = queryGroupByDiv & "'Total Customer' AS businessdivisiondescr, "
queryGroupByDiv = queryGroupByDiv & "sc.spend_base_descr, "
queryGroupByDiv = queryGroupByDiv & "sc.spend_base_seq, "
queryGroupByDiv = queryGroupByDiv & "sc.spend_subcategory_descr, "
queryGroupByDiv = queryGroupByDiv & "sc.spend_subcategory_seq, "
queryGroupByDiv = queryGroupByDiv & "md.year_descr, "
queryGroupByDiv = queryGroupByDiv & "md.month_descr, "
queryGroupByDiv = queryGroupByDiv & "SUM (epf.expense_amt) AS expense_amt, "
queryGroupByDiv = queryGroupByDiv & "0 AS total_pounds_shipped, "
queryGroupByDiv = queryGroupByDiv & "0 AS net_receivable_dollar "
queryGroupByDiv = queryGroupByDiv & "FROM tdw_owner.restated_mkt_prd_bus_div_dim mpbd, "
queryGroupByDiv = queryGroupByDiv & "tdw_owner.expense_payment_fact epf, "
queryGroupByDiv = queryGroupByDiv & "tdw_owner.fsv_spend_category sc, "
queryGroupByDiv = queryGroupByDiv & "tdw_owner.restated_market m, "
queryGroupByDiv = queryGroupByDiv & "tdw_owner.month_dim md, "
queryGroupByDiv = queryGroupByDiv & "tdw_owner.restated_product p, "
queryGroupByDiv = queryGroupByDiv & "tdw_owner.acct_dim a, "
queryGroupByDiv = queryGroupByDiv & "tdw_owner.expense_type et, "
queryGroupByDiv = queryGroupByDiv & "tdw_owner.spend_request_dim s, "
queryGroupByDiv = queryGroupByDiv & "tdw_owner.operator_dim o, "
queryGroupByDiv = queryGroupByDiv & "tdw_owner.day_dim d1, "
queryGroupByDiv = queryGroupByDiv & "tdw_owner.day_dim d2, "
queryGroupByDiv = queryGroupByDiv & "tdw_owner.expense_attribute_dim ead, "
queryGroupByDiv = queryGroupByDiv & "tdw_owner.expense_payee_dim pay, "
queryGroupByDiv = queryGroupByDiv & "tdw_owner.group_detail gd, "
queryGroupByDiv = queryGroupByDiv & "tdw_owner.group_description groupdescr "
queryGroupByDiv = queryGroupByDiv & "WHERE mpbd.restated_mkt_prd_bus_div_key = epf.restated_mkt_prd_bus_div_key "
queryGroupByDiv = queryGroupByDiv & "AND epf.expense_type_key = sc.expense_type_key "
queryGroupByDiv = queryGroupByDiv & "AND epf.acct_key = sc.acct_key "
queryGroupByDiv = queryGroupByDiv & "AND epf.restated_market_key = m.restated_market_key "
queryGroupByDiv = queryGroupByDiv & "AND epf.month_key = md.month_key "
queryGroupByDiv = queryGroupByDiv & "AND epf.restated_product_key = p.restated_product_key "
queryGroupByDiv = queryGroupByDiv & "AND epf.acct_key = a.acct_key "
queryGroupByDiv = queryGroupByDiv & "AND epf.expense_type_key = et.expense_type_key "
queryGroupByDiv = queryGroupByDiv & "AND epf.spend_request_key = s.spend_request_key "
queryGroupByDiv = queryGroupByDiv & "AND epf.operator_key = o.operator_key "
queryGroupByDiv = queryGroupByDiv & "AND epf.report_period_begin_day_key = d1.day_key "
queryGroupByDiv = queryGroupByDiv & "AND epf.report_period_end_day_key = d2.day_key "
queryGroupByDiv = queryGroupByDiv & "AND epf.expense_attribute_key = ead.expense_attribute_key "
queryGroupByDiv = queryGroupByDiv & "AND epf.expense_payee_key = pay.expense_payee_key "
queryGroupByDiv = queryGroupByDiv & "AND gd.GROUP_CODE = groupdescr.GROUP_CODE "
queryGroupByDiv = queryGroupByDiv & "AND gd.group_field_c  =  m.DIVISION_CODE "
queryGroupByDiv = queryGroupByDiv & "AND sc.spend_base_seq <> 0 "
queryGroupByDiv = queryGroupByDiv & "AND sc.spend_subcategory_seq <> 0 "
queryGroupByDiv = queryGroupByDiv & "AND (mpbd.business_division_code IN ('F01', 'F03', 'F04', 'F08', 'F15')) "
queryGroupByDiv = queryGroupByDiv & "AND (m.selling_group_code IN ('119000', '125000', '610000', '800000', '423000')) "
queryGroupByDiv = queryGroupByDiv & "AND (md.year_descr IN (:p_year)) "
queryGroupByDiv = queryGroupByDiv & "and md.fiscal_month_number <= :p_Month "
queryGroupByDiv = queryGroupByDiv & "AND (mpbd.business_division_code IN (:p_businessdivision)) "
queryGroupByDiv = queryGroupByDiv & "AND (m.division_code IN (:p_salesdivision)) "
queryGroupByDiv = queryGroupByDiv & "AND (m.region_code IN (:p_salesregion)) "
queryGroupByDiv = queryGroupByDiv & "AND (m.primary_broker_code IN (:p_primarybroker)) "
queryGroupByDiv = queryGroupByDiv & "AND gd.GROUP_CODE in (:vp) "
queryGroupByDiv = queryGroupByDiv & "GROUP BY  "
queryGroupByDiv = queryGroupByDiv & "gd.GROUP_CODE, "
queryGroupByDiv = queryGroupByDiv & "groupdescr.GROUP_DESCR, "
queryGroupByDiv = queryGroupByDiv & "m.DIVISION_CODE, "
queryGroupByDiv = queryGroupByDiv & "m.DIVISION_DESCR, "
queryGroupByDiv = queryGroupByDiv & "mpbd.business_division_code, "
queryGroupByDiv = queryGroupByDiv & "'Total Customer', "
queryGroupByDiv = queryGroupByDiv & "sc.spend_base_descr, "
queryGroupByDiv = queryGroupByDiv & "sc.spend_base_seq, "
queryGroupByDiv = queryGroupByDiv & "sc.spend_subcategory_descr, "
queryGroupByDiv = queryGroupByDiv & "sc.spend_subcategory_seq, "
queryGroupByDiv = queryGroupByDiv & "md.year_descr, "
queryGroupByDiv = queryGroupByDiv & "md.month_descr, "
queryGroupByDiv = queryGroupByDiv & "md.FISCAL_MONTH_NUMBER, "
queryGroupByDiv = queryGroupByDiv & "mpbd.business_division_Descr "
queryGroupByDiv = queryGroupByDiv & " "
queryGroupByDiv = queryGroupByDiv & "--Begin Volume "
queryGroupByDiv = queryGroupByDiv & "UNION "
queryGroupByDiv = queryGroupByDiv & "SELECT   'zzz' AS businessunit, "
queryGroupByDiv = queryGroupByDiv & "0 AS monthexpense_amt, "
queryGroupByDiv = queryGroupByDiv & "CASE WHEN (ids_mf.FISCAL_MONTH_NUMBER = (:p_Month)) "
queryGroupByDiv = queryGroupByDiv & "     THEN SUM (  ids_mf.mf_pounds_shipped "
queryGroupByDiv = queryGroupByDiv & "               + ids_mf.mf_adjusted_pounds_shipped "
queryGroupByDiv = queryGroupByDiv & "                + ids_mf.ids_pounds_shipped) "
queryGroupByDiv = queryGroupByDiv & "END AS monthpounds, "
queryGroupByDiv = queryGroupByDiv & "CASE WHEN (ids_mf.FISCAL_MONTH_NUMBER = (:p_Month)) "
queryGroupByDiv = queryGroupByDiv & "     THEN SUM (  ids_mf.mf_gross_sales_amount "
queryGroupByDiv = queryGroupByDiv & "               - ids_mf.mf_allow_amount "
queryGroupByDiv = queryGroupByDiv & "               - ids_mf.mf_off_invoice_amount "
queryGroupByDiv = queryGroupByDiv & "               + ids_mf.mf_revenue_adjustment "
queryGroupByDiv = queryGroupByDiv & "               + ids_mf.ids_indirect_sales_amount) "
queryGroupByDiv = queryGroupByDiv & "END AS monthnetreceivables, "
queryGroupByDiv = queryGroupByDiv & "gd.GROUP_CODE, "
queryGroupByDiv = queryGroupByDiv & "groupdescr.GROUP_DESCR, "
queryGroupByDiv = queryGroupByDiv & "m.DIVISION_CODE, "
queryGroupByDiv = queryGroupByDiv & "m.DIVISION_DESCR, "
queryGroupByDiv = queryGroupByDiv & "mpbd.business_division_code, "
queryGroupByDiv = queryGroupByDiv & "INITCAP (mpbd.business_division_descr) AS businessdivisiondescr, "
queryGroupByDiv = queryGroupByDiv & "NULL AS spend_base_descr, "
queryGroupByDiv = queryGroupByDiv & "NULL AS spend_base_seq, "
queryGroupByDiv = queryGroupByDiv & "NULL AS spend_subcategory_descr, "
queryGroupByDiv = queryGroupByDiv & "NULL AS spend_subcategory_seq, "
queryGroupByDiv = queryGroupByDiv & "ids_mf.year_descr, "
queryGroupByDiv = queryGroupByDiv & "ids_mf.month_descr, "
queryGroupByDiv = queryGroupByDiv & "0 AS expense_amt, "
queryGroupByDiv = queryGroupByDiv & "SUM (  ids_mf.mf_pounds_shipped "
queryGroupByDiv = queryGroupByDiv & "       + ids_mf.mf_adjusted_pounds_shipped "
queryGroupByDiv = queryGroupByDiv & "       + ids_mf.ids_pounds_shipped "
queryGroupByDiv = queryGroupByDiv & "       ) AS total_pounds_shipped, "
queryGroupByDiv = queryGroupByDiv & "SUM (  ids_mf.mf_gross_sales_amount "
queryGroupByDiv = queryGroupByDiv & "       - ids_mf.mf_allow_amount "
queryGroupByDiv = queryGroupByDiv & "       - ids_mf.mf_off_invoice_amount "
queryGroupByDiv = queryGroupByDiv & "       + ids_mf.mf_revenue_adjustment "
queryGroupByDiv = queryGroupByDiv & "       + ids_mf.ids_indirect_sales_amount "
queryGroupByDiv = queryGroupByDiv & "       ) AS net_receivable_dollar "
queryGroupByDiv = queryGroupByDiv & "FROM (SELECT   mpbd1.business_division_code, "
queryGroupByDiv = queryGroupByDiv & "mpbd1.business_division_descr, "
queryGroupByDiv = queryGroupByDiv & "mpbd1.restated_market_key, "
queryGroupByDiv = queryGroupByDiv & "mpbd1.restated_product_key, "
queryGroupByDiv = queryGroupByDiv & "md1.year_descr, "
queryGroupByDiv = queryGroupByDiv & "md1.month_descr, "
queryGroupByDiv = queryGroupByDiv & "md1.FISCAL_MONTH_NUMBER, "
queryGroupByDiv = queryGroupByDiv & "SUM (mf.pounds_shipped) AS mf_pounds_shipped, "
queryGroupByDiv = queryGroupByDiv & "SUM (mf.adj_pounds_shipped) AS mf_adjusted_pounds_shipped, "
queryGroupByDiv = queryGroupByDiv & "SUM (mf.gross_sales_amount) AS mf_gross_sales_amount, "
queryGroupByDiv = queryGroupByDiv & "SUM (mf.allow_amount) AS mf_allow_amount, "
queryGroupByDiv = queryGroupByDiv & "SUM (mf.revenue_adjustment) AS mf_revenue_adjustment, "
queryGroupByDiv = queryGroupByDiv & "SUM (mf.off_invoice_amount) AS mf_off_invoice_amount, "
queryGroupByDiv = queryGroupByDiv & "0 AS ids_pounds_shipped, "
queryGroupByDiv = queryGroupByDiv & "0 AS ids_indirect_sales_amount "
queryGroupByDiv = queryGroupByDiv & "FROM tdw_owner.restated_mkt_prd_bus_div_dim mpbd1, "
queryGroupByDiv = queryGroupByDiv & "tdw_owner.restated_market m1, "
queryGroupByDiv = queryGroupByDiv & "tdw_owner.month_dim md1, "
queryGroupByDiv = queryGroupByDiv & "tdw_owner.restated_product p1, "
queryGroupByDiv = queryGroupByDiv & "tdw_owner.day_dim d1, "
queryGroupByDiv = queryGroupByDiv & "tdw_owner.margin_fact mf, "
queryGroupByDiv = queryGroupByDiv & "tdw_owner.group_detail gd, "
queryGroupByDiv = queryGroupByDiv & "tdw_owner.group_description groupdescr "
queryGroupByDiv = queryGroupByDiv & "WHERE mf.restated_market_key = m1.restated_market_key "
queryGroupByDiv = queryGroupByDiv & "AND mf.restated_product_key = p1.restated_product_key "
queryGroupByDiv = queryGroupByDiv & "AND mf.restated_market_key = mpbd1.restated_market_key "
queryGroupByDiv = queryGroupByDiv & "AND mf.restated_product_key = mpbd1.restated_product_key "
queryGroupByDiv = queryGroupByDiv & "AND mf.invoice_day_key = d1.day_key "
queryGroupByDiv = queryGroupByDiv & "AND d1.month_ending_date = md1.month_ending_date "
queryGroupByDiv = queryGroupByDiv & "AND gd.GROUP_CODE = groupdescr.GROUP_CODE "
queryGroupByDiv = queryGroupByDiv & "AND gd.group_field_c  =  m1.DIVISION_CODE "
queryGroupByDiv = queryGroupByDiv & "AND (mpbd1.business_division_code IN ('F01', 'F03', 'F04', 'F08', 'F15')) "
queryGroupByDiv = queryGroupByDiv & "AND (m1.selling_group_code IN ('119000', '125000', '610000', '800000', '423000')) "
queryGroupByDiv = queryGroupByDiv & "AND (md1.year_descr IN (:p_year)) "
queryGroupByDiv = queryGroupByDiv & "and md1.fiscal_month_number <= :p_Month "
queryGroupByDiv = queryGroupByDiv & "AND (mpbd1.business_division_code IN (:p_businessdivision)) "
queryGroupByDiv = queryGroupByDiv & "AND (m1.division_code IN (:p_salesdivision)) "
queryGroupByDiv = queryGroupByDiv & "AND (m1.region_code IN (:p_salesregion)) "
queryGroupByDiv = queryGroupByDiv & "AND (m1.primary_broker_code IN (:p_primarybroker)) "
queryGroupByDiv = queryGroupByDiv & "AND gd.GROUP_CODE in (:vp) "
queryGroupByDiv = queryGroupByDiv & "GROUP BY mpbd1.business_division_code, "
queryGroupByDiv = queryGroupByDiv & "mpbd1.business_division_descr, "
queryGroupByDiv = queryGroupByDiv & "mpbd1.restated_market_key, "
queryGroupByDiv = queryGroupByDiv & "mpbd1.restated_product_key, "
queryGroupByDiv = queryGroupByDiv & "md1.year_descr, "
queryGroupByDiv = queryGroupByDiv & "md1.month_descr, "
queryGroupByDiv = queryGroupByDiv & "md1.FISCAL_MONTH_NUMBER "
queryGroupByDiv = queryGroupByDiv & "UNION "
queryGroupByDiv = queryGroupByDiv & "SELECT   /*+ RULE */ "
queryGroupByDiv = queryGroupByDiv & "mpbd1.business_division_code, "
queryGroupByDiv = queryGroupByDiv & "mpbd1.business_division_descr, "
queryGroupByDiv = queryGroupByDiv & "mpbd1.restated_market_key, "
queryGroupByDiv = queryGroupByDiv & "mpbd1.restated_product_key, "
queryGroupByDiv = queryGroupByDiv & "md1.year_descr, "
queryGroupByDiv = queryGroupByDiv & "md1.month_descr, "
queryGroupByDiv = queryGroupByDiv & "md1.FISCAL_MONTH_NUMBER, "
queryGroupByDiv = queryGroupByDiv & "0 AS mf_pounds_shipped, "
queryGroupByDiv = queryGroupByDiv & "0 AS mf_adjusted_pounds_shipped, "
queryGroupByDiv = queryGroupByDiv & "0 AS mf_gross_sales_amount, "
queryGroupByDiv = queryGroupByDiv & "0 AS mf_allow_amount, "
queryGroupByDiv = queryGroupByDiv & "0 AS mf_revenue_adjustment, "
queryGroupByDiv = queryGroupByDiv & "0 AS mf_off_invoice_amount, "
queryGroupByDiv = queryGroupByDiv & "SUM (ids.pounds_shipped) AS ids_pounds_shipped, "
queryGroupByDiv = queryGroupByDiv & "SUM (ids.indirect_sales_amount)AS ids_indirect_sales_amount "
queryGroupByDiv = queryGroupByDiv & "FROM tdw_owner.restated_mkt_prd_bus_div_dim mpbd1, "
queryGroupByDiv = queryGroupByDiv & "tdw_owner.restated_market m1, "
queryGroupByDiv = queryGroupByDiv & "tdw_owner.month_dim md1, "
queryGroupByDiv = queryGroupByDiv & "tdw_owner.restated_product p1, "
queryGroupByDiv = queryGroupByDiv & "tdw_owner.indirect_sales ids, "
queryGroupByDiv = queryGroupByDiv & "tdw_owner.week_dim w1, "
queryGroupByDiv = queryGroupByDiv & "tdw_owner.group_detail gd, "
queryGroupByDiv = queryGroupByDiv & "tdw_owner.group_description groupdescr "
queryGroupByDiv = queryGroupByDiv & "WHERE ids.restated_market_key = m1.restated_market_key "
queryGroupByDiv = queryGroupByDiv & "AND ids.restated_product_key = p1.restated_product_key "
queryGroupByDiv = queryGroupByDiv & "AND ids.restated_market_key = mpbd1.restated_market_key "
queryGroupByDiv = queryGroupByDiv & "AND ids.restated_product_key = mpbd1.restated_product_key "
queryGroupByDiv = queryGroupByDiv & "AND ids.week_key = w1.week_key "
queryGroupByDiv = queryGroupByDiv & "AND w1.month_ending_date = md1.month_ending_date "
queryGroupByDiv = queryGroupByDiv & "AND gd.GROUP_CODE = groupdescr.GROUP_CODE "
queryGroupByDiv = queryGroupByDiv & "AND gd.group_field_c  =  m1.DIVISION_CODE "
queryGroupByDiv = queryGroupByDiv & "AND (mpbd1.business_division_code IN ('F01', 'F03', 'F04', 'F08', 'F15')) "
queryGroupByDiv = queryGroupByDiv & "AND (m1.selling_group_code IN ('119000', '125000', '610000', '800000', '423000')) "
queryGroupByDiv = queryGroupByDiv & "AND (md1.year_descr IN (:p_year)) "
queryGroupByDiv = queryGroupByDiv & "and md1.fiscal_month_number <= :p_Month "
queryGroupByDiv = queryGroupByDiv & "AND (mpbd1.business_division_code IN (:p_businessdivision)) "
queryGroupByDiv = queryGroupByDiv & "AND (m1.division_code IN (:p_salesdivision)) "
queryGroupByDiv = queryGroupByDiv & "AND (m1.region_code IN (:p_salesregion)) "
queryGroupByDiv = queryGroupByDiv & "AND (m1.primary_broker_code IN (:p_primarybroker)) "
queryGroupByDiv = queryGroupByDiv & "AND gd.GROUP_CODE in (:vp) "
queryGroupByDiv = queryGroupByDiv & "GROUP BY mpbd1.business_division_code, "
queryGroupByDiv = queryGroupByDiv & "mpbd1.business_division_descr, "
queryGroupByDiv = queryGroupByDiv & "mpbd1.restated_market_key, "
queryGroupByDiv = queryGroupByDiv & "mpbd1.restated_product_key, "
queryGroupByDiv = queryGroupByDiv & "md1.year_descr, "
queryGroupByDiv = queryGroupByDiv & "md1.month_descr, "
queryGroupByDiv = queryGroupByDiv & "md1.FISCAL_MONTH_NUMBER "
queryGroupByDiv = queryGroupByDiv & ")--end sub queryGroupByDiv "
queryGroupByDiv = queryGroupByDiv & "   ids_mf, "
queryGroupByDiv = queryGroupByDiv & "tdw_owner.restated_mkt_prd_bus_div_dim mpbd, "
queryGroupByDiv = queryGroupByDiv & "tdw_owner.restated_market m, "
queryGroupByDiv = queryGroupByDiv & "tdw_owner.restated_product p, "
queryGroupByDiv = queryGroupByDiv & "tdw_owner.group_detail gd, "
queryGroupByDiv = queryGroupByDiv & "tdw_owner.group_description groupdescr "
queryGroupByDiv = queryGroupByDiv & "WHERE ids_mf.restated_market_key = mpbd.restated_market_key "
queryGroupByDiv = queryGroupByDiv & "AND ids_mf.restated_product_key = mpbd.restated_product_key "
queryGroupByDiv = queryGroupByDiv & "AND ids_mf.restated_market_key = m.restated_market_key "
queryGroupByDiv = queryGroupByDiv & "AND ids_mf.restated_product_key = p.restated_product_key "
queryGroupByDiv = queryGroupByDiv & "AND gd.GROUP_CODE = groupdescr.GROUP_CODE "
queryGroupByDiv = queryGroupByDiv & "AND gd.group_field_c  =  m.DIVISION_CODE "
queryGroupByDiv = queryGroupByDiv & "AND (mpbd.business_division_code IN ('F01', 'F03', 'F04', 'F08', 'F15')) "
queryGroupByDiv = queryGroupByDiv & "AND (m.selling_group_code IN ('119000', '125000', '610000', '800000', '423000')) "
queryGroupByDiv = queryGroupByDiv & "AND (ids_mf.year_descr IN (:p_year)) "
queryGroupByDiv = queryGroupByDiv & "and ids_mf.fiscal_month_number <= :p_Month "
queryGroupByDiv = queryGroupByDiv & "AND (mpbd.business_division_code IN (:p_businessdivision)) "
queryGroupByDiv = queryGroupByDiv & "AND (m.division_code IN (:p_salesdivision)) "
queryGroupByDiv = queryGroupByDiv & "AND (m.region_code IN (:p_salesregion)) "
queryGroupByDiv = queryGroupByDiv & "AND (m.primary_broker_code IN (:p_primarybroker)) "
queryGroupByDiv = queryGroupByDiv & "AND gd.GROUP_CODE in (:vp) "
queryGroupByDiv = queryGroupByDiv & "GROUP BY  "
queryGroupByDiv = queryGroupByDiv & "gd.GROUP_CODE, "
queryGroupByDiv = queryGroupByDiv & "groupdescr.GROUP_DESCR, "
queryGroupByDiv = queryGroupByDiv & "m.DIVISION_CODE, "
queryGroupByDiv = queryGroupByDiv & "m.DIVISION_DESCR, "
queryGroupByDiv = queryGroupByDiv & "'zzz', "
queryGroupByDiv = queryGroupByDiv & "mpbd.business_division_code, "
queryGroupByDiv = queryGroupByDiv & "INITCAP (mpbd.business_division_descr), "
queryGroupByDiv = queryGroupByDiv & "ids_mf.year_descr, "
queryGroupByDiv = queryGroupByDiv & "ids_mf.month_descr, "
queryGroupByDiv = queryGroupByDiv & "ids_mf.FISCAL_MONTH_NUMBER, "
queryGroupByDiv = queryGroupByDiv & "mpbd.business_division_Descr "
queryGroupByDiv = queryGroupByDiv & "--Begin Volume 'Total Value Added' "
queryGroupByDiv = queryGroupByDiv & "UNION "
queryGroupByDiv = queryGroupByDiv & "SELECT    "
queryGroupByDiv = queryGroupByDiv & "'zzz' AS businessunit, "
queryGroupByDiv = queryGroupByDiv & "0 AS monthexpense_amt, "
queryGroupByDiv = queryGroupByDiv & "CASE WHEN (ids_mf.FISCAL_MONTH_NUMBER = (:p_Month)) "
queryGroupByDiv = queryGroupByDiv & "     THEN SUM (  ids_mf.mf_pounds_shipped "
queryGroupByDiv = queryGroupByDiv & "               + ids_mf.mf_adjusted_pounds_shipped "
queryGroupByDiv = queryGroupByDiv & "               + ids_mf.ids_pounds_shipped) "
queryGroupByDiv = queryGroupByDiv & "END AS monthpounds, "
queryGroupByDiv = queryGroupByDiv & "CASE WHEN (ids_mf.FISCAL_MONTH_NUMBER = (:p_Month)) "
queryGroupByDiv = queryGroupByDiv & "     THEN SUM (  ids_mf.mf_gross_sales_amount "
queryGroupByDiv = queryGroupByDiv & "               - ids_mf.mf_allow_amount "
queryGroupByDiv = queryGroupByDiv & "               - ids_mf.mf_off_invoice_amount "
queryGroupByDiv = queryGroupByDiv & "                 + ids_mf.mf_revenue_adjustment "
queryGroupByDiv = queryGroupByDiv & "               + ids_mf.ids_indirect_sales_amount) "
queryGroupByDiv = queryGroupByDiv & "END AS monthnetreceivables, "
queryGroupByDiv = queryGroupByDiv & "gd.GROUP_CODE, "
queryGroupByDiv = queryGroupByDiv & "groupdescr.GROUP_DESCR, "
queryGroupByDiv = queryGroupByDiv & "m.DIVISION_CODE, "
queryGroupByDiv = queryGroupByDiv & "m.DIVISION_DESCR, "
queryGroupByDiv = queryGroupByDiv & "mpbd.business_division_code, "
queryGroupByDiv = queryGroupByDiv & "'Total Value Added' AS businessdivisiondescr, "
queryGroupByDiv = queryGroupByDiv & "NULL AS spend_base_descr, "
queryGroupByDiv = queryGroupByDiv & "NULL AS spend_base_seq, "
queryGroupByDiv = queryGroupByDiv & "NULL AS spend_subcategory_descr, "
queryGroupByDiv = queryGroupByDiv & "NULL AS spend_subcategory_seq, "
queryGroupByDiv = queryGroupByDiv & "ids_mf.year_descr, "
queryGroupByDiv = queryGroupByDiv & "ids_mf.month_descr, "
queryGroupByDiv = queryGroupByDiv & "0 AS expense_amt, "
queryGroupByDiv = queryGroupByDiv & "SUM (  ids_mf.mf_pounds_shipped "
queryGroupByDiv = queryGroupByDiv & "        + ids_mf.mf_adjusted_pounds_shipped "
queryGroupByDiv = queryGroupByDiv & "        + ids_mf.ids_pounds_shipped "
queryGroupByDiv = queryGroupByDiv & "        ) AS total_pounds_shipped, "
queryGroupByDiv = queryGroupByDiv & "SUM (  ids_mf.mf_gross_sales_amount "
queryGroupByDiv = queryGroupByDiv & "       - ids_mf.mf_allow_amount "
queryGroupByDiv = queryGroupByDiv & "       - ids_mf.mf_off_invoice_amount "
queryGroupByDiv = queryGroupByDiv & "       + ids_mf.mf_revenue_adjustment "
queryGroupByDiv = queryGroupByDiv & "       + ids_mf.ids_indirect_sales_amount "
queryGroupByDiv = queryGroupByDiv & "       ) AS net_receivable_dollar "
queryGroupByDiv = queryGroupByDiv & "FROM ( "
queryGroupByDiv = queryGroupByDiv & "--Begin sub queryGroupByDiv "
queryGroupByDiv = queryGroupByDiv & "SELECT   mpbd1.business_division_code, "
queryGroupByDiv = queryGroupByDiv & "mpbd1.business_division_descr, "
queryGroupByDiv = queryGroupByDiv & "mpbd1.restated_market_key, "
queryGroupByDiv = queryGroupByDiv & "mpbd1.restated_product_key, "
queryGroupByDiv = queryGroupByDiv & "md1.year_descr, "
queryGroupByDiv = queryGroupByDiv & "md1.month_descr, "
queryGroupByDiv = queryGroupByDiv & "md1.FISCAL_MONTH_NUMBER, "
queryGroupByDiv = queryGroupByDiv & "SUM (mf.pounds_shipped) AS mf_pounds_shipped, "
queryGroupByDiv = queryGroupByDiv & "SUM (mf.adj_pounds_shipped) AS mf_adjusted_pounds_shipped, "
queryGroupByDiv = queryGroupByDiv & "SUM (mf.gross_sales_amount) AS mf_gross_sales_amount, "
queryGroupByDiv = queryGroupByDiv & "SUM (mf.allow_amount) AS mf_allow_amount, "
queryGroupByDiv = queryGroupByDiv & "SUM (mf.revenue_adjustment) AS mf_revenue_adjustment, "
queryGroupByDiv = queryGroupByDiv & "SUM (mf.off_invoice_amount) AS mf_off_invoice_amount, "
queryGroupByDiv = queryGroupByDiv & "0 AS ids_pounds_shipped, "
queryGroupByDiv = queryGroupByDiv & "0 AS ids_indirect_sales_amount "
queryGroupByDiv = queryGroupByDiv & "FROM tdw_owner.restated_mkt_prd_bus_div_dim mpbd1, "
queryGroupByDiv = queryGroupByDiv & "tdw_owner.restated_market m1, "
queryGroupByDiv = queryGroupByDiv & "tdw_owner.month_dim md1, "
queryGroupByDiv = queryGroupByDiv & "tdw_owner.restated_product p1, "
queryGroupByDiv = queryGroupByDiv & "tdw_owner.day_dim d1, "
queryGroupByDiv = queryGroupByDiv & "tdw_owner.margin_fact mf, "
queryGroupByDiv = queryGroupByDiv & "tdw_owner.group_detail gd, "
queryGroupByDiv = queryGroupByDiv & "tdw_owner.group_description groupdescr "
queryGroupByDiv = queryGroupByDiv & "WHERE mf.restated_market_key = m1.restated_market_key "
queryGroupByDiv = queryGroupByDiv & "AND mf.restated_product_key = p1.restated_product_key "
queryGroupByDiv = queryGroupByDiv & "AND mf.restated_market_key = mpbd1.restated_market_key "
queryGroupByDiv = queryGroupByDiv & "AND mf.restated_product_key = mpbd1.restated_product_key "
queryGroupByDiv = queryGroupByDiv & "AND mf.invoice_day_key = d1.day_key "
queryGroupByDiv = queryGroupByDiv & "AND d1.month_ending_date = md1.month_ending_date "
queryGroupByDiv = queryGroupByDiv & "AND gd.GROUP_CODE = groupdescr.GROUP_CODE "
queryGroupByDiv = queryGroupByDiv & "AND gd.group_field_c  =  m1.DIVISION_CODE "
queryGroupByDiv = queryGroupByDiv & "AND (mpbd1.business_division_code IN ('F01', 'F08', 'F15')) "
queryGroupByDiv = queryGroupByDiv & "AND (m1.selling_group_code IN ('119000', '125000', '610000', '800000', '423000')) "
queryGroupByDiv = queryGroupByDiv & "AND (md1.year_descr IN (:p_year)) "
queryGroupByDiv = queryGroupByDiv & "and md1.fiscal_month_number <= :p_Month "
queryGroupByDiv = queryGroupByDiv & "AND (mpbd1.business_division_code IN (:p_businessdivision)) "
queryGroupByDiv = queryGroupByDiv & "AND (m1.division_code IN (:p_salesdivision)) "
queryGroupByDiv = queryGroupByDiv & "AND (m1.region_code IN (:p_salesregion)) "
queryGroupByDiv = queryGroupByDiv & "AND (m1.primary_broker_code IN (:p_primarybroker)) "
queryGroupByDiv = queryGroupByDiv & "AND gd.GROUP_CODE in (:vp) "
queryGroupByDiv = queryGroupByDiv & "GROUP BY mpbd1.business_division_code, "
queryGroupByDiv = queryGroupByDiv & "mpbd1.business_division_descr, "
queryGroupByDiv = queryGroupByDiv & "mpbd1.restated_market_key, "
queryGroupByDiv = queryGroupByDiv & "mpbd1.restated_product_key, "
queryGroupByDiv = queryGroupByDiv & "md1.year_descr, "
queryGroupByDiv = queryGroupByDiv & "md1.month_descr, "
queryGroupByDiv = queryGroupByDiv & "md1.FISCAL_MONTH_NUMBER "
queryGroupByDiv = queryGroupByDiv & "UNION "
queryGroupByDiv = queryGroupByDiv & "SELECT   /*+ RULE */ "
queryGroupByDiv = queryGroupByDiv & "mpbd1.business_division_code, "
queryGroupByDiv = queryGroupByDiv & "mpbd1.business_division_descr, "
queryGroupByDiv = queryGroupByDiv & "mpbd1.restated_market_key, "
queryGroupByDiv = queryGroupByDiv & "mpbd1.restated_product_key, "
queryGroupByDiv = queryGroupByDiv & "md1.year_descr, "
queryGroupByDiv = queryGroupByDiv & "md1.month_descr, "
queryGroupByDiv = queryGroupByDiv & "md1.FISCAL_MONTH_NUMBER, "
queryGroupByDiv = queryGroupByDiv & "0 AS mf_pounds_shipped, "
queryGroupByDiv = queryGroupByDiv & "0 AS mf_adjusted_pounds_shipped, "
queryGroupByDiv = queryGroupByDiv & "0 AS mf_gross_sales_amount, "
queryGroupByDiv = queryGroupByDiv & "0 AS mf_allow_amount, "
queryGroupByDiv = queryGroupByDiv & "0 AS mf_revenue_adjustment, "
queryGroupByDiv = queryGroupByDiv & "0 AS mf_off_invoice_amount, "
queryGroupByDiv = queryGroupByDiv & "SUM (ids.pounds_shipped) AS ids_pounds_shipped, "
queryGroupByDiv = queryGroupByDiv & "SUM (ids.indirect_sales_amount)AS ids_indirect_sales_amount "
queryGroupByDiv = queryGroupByDiv & "FROM tdw_owner.restated_mkt_prd_bus_div_dim mpbd1, "
queryGroupByDiv = queryGroupByDiv & "tdw_owner.restated_market m1, "
queryGroupByDiv = queryGroupByDiv & "tdw_owner.month_dim md1, "
queryGroupByDiv = queryGroupByDiv & "tdw_owner.restated_product p1, "
queryGroupByDiv = queryGroupByDiv & "tdw_owner.indirect_sales ids, "
queryGroupByDiv = queryGroupByDiv & "tdw_owner.week_dim w1, "
queryGroupByDiv = queryGroupByDiv & "tdw_owner.group_detail gd, "
queryGroupByDiv = queryGroupByDiv & "tdw_owner.group_description groupdescr "
queryGroupByDiv = queryGroupByDiv & "WHERE ids.restated_market_key = m1.restated_market_key "
queryGroupByDiv = queryGroupByDiv & "AND ids.restated_product_key = p1.restated_product_key "
queryGroupByDiv = queryGroupByDiv & "AND ids.restated_market_key = mpbd1.restated_market_key "
queryGroupByDiv = queryGroupByDiv & "AND ids.restated_product_key = mpbd1.restated_product_key "
queryGroupByDiv = queryGroupByDiv & "AND ids.week_key = w1.week_key "
queryGroupByDiv = queryGroupByDiv & "AND w1.month_ending_date = md1.month_ending_date "
queryGroupByDiv = queryGroupByDiv & "AND gd.GROUP_CODE = groupdescr.GROUP_CODE "
queryGroupByDiv = queryGroupByDiv & "AND gd.group_field_c  =  m1.DIVISION_CODE "
queryGroupByDiv = queryGroupByDiv & "AND (mpbd1.business_division_code IN ('F01', 'F08', 'F15')) "
queryGroupByDiv = queryGroupByDiv & "AND (m1.selling_group_code IN ('119000', '125000', '610000', '800000', '423000')) "
queryGroupByDiv = queryGroupByDiv & "AND (md1.year_descr IN (:p_year)) "
queryGroupByDiv = queryGroupByDiv & "and md1.fiscal_month_number <= :p_Month "
queryGroupByDiv = queryGroupByDiv & "AND (mpbd1.business_division_code IN (:p_businessdivision)) "
queryGroupByDiv = queryGroupByDiv & "AND (m1.division_code IN (:p_salesdivision)) "
queryGroupByDiv = queryGroupByDiv & "AND (m1.region_code IN (:p_salesregion)) "
queryGroupByDiv = queryGroupByDiv & "AND (m1.primary_broker_code IN (:p_primarybroker)) "
queryGroupByDiv = queryGroupByDiv & "AND gd.GROUP_CODE in (:vp) "
queryGroupByDiv = queryGroupByDiv & "GROUP BY mpbd1.business_division_code, "
queryGroupByDiv = queryGroupByDiv & "mpbd1.business_division_descr, "
queryGroupByDiv = queryGroupByDiv & "mpbd1.restated_market_key, "
queryGroupByDiv = queryGroupByDiv & "mpbd1.restated_product_key, "
queryGroupByDiv = queryGroupByDiv & "md1.year_descr, "
queryGroupByDiv = queryGroupByDiv & "md1.month_descr, "
queryGroupByDiv = queryGroupByDiv & "md1.FISCAL_MONTH_NUMBER "
queryGroupByDiv = queryGroupByDiv & ") --end sub queryGroupByDiv "
queryGroupByDiv = queryGroupByDiv & "   ids_mf, "
queryGroupByDiv = queryGroupByDiv & "tdw_owner.restated_mkt_prd_bus_div_dim mpbd, "
queryGroupByDiv = queryGroupByDiv & "tdw_owner.restated_market m, "
queryGroupByDiv = queryGroupByDiv & "tdw_owner.restated_product p, "
queryGroupByDiv = queryGroupByDiv & "tdw_owner.group_detail gd, "
queryGroupByDiv = queryGroupByDiv & "tdw_owner.group_description groupdescr "
queryGroupByDiv = queryGroupByDiv & "WHERE ids_mf.restated_market_key = mpbd.restated_market_key "
queryGroupByDiv = queryGroupByDiv & "AND ids_mf.restated_product_key = mpbd.restated_product_key "
queryGroupByDiv = queryGroupByDiv & "AND ids_mf.restated_market_key = m.restated_market_key "
queryGroupByDiv = queryGroupByDiv & "AND ids_mf.restated_product_key = p.restated_product_key "
queryGroupByDiv = queryGroupByDiv & "AND gd.GROUP_CODE = groupdescr.GROUP_CODE "
queryGroupByDiv = queryGroupByDiv & "AND gd.group_field_c  =  m.DIVISION_CODE "
queryGroupByDiv = queryGroupByDiv & "AND (mpbd.business_division_code IN ('F01', 'F08', 'F15')) "
queryGroupByDiv = queryGroupByDiv & "AND (m.selling_group_code IN ('119000', '125000', '610000', '800000', '423000')) "
queryGroupByDiv = queryGroupByDiv & "AND (ids_mf.year_descr IN (:p_year)) "
queryGroupByDiv = queryGroupByDiv & "and ids_mf.fiscal_month_number <= :p_Month "
queryGroupByDiv = queryGroupByDiv & "AND (mpbd.business_division_code IN (:p_businessdivision)) "
queryGroupByDiv = queryGroupByDiv & "AND (m.division_code IN (:p_salesdivision)) "
queryGroupByDiv = queryGroupByDiv & "AND (m.region_code IN (:p_salesregion)) "
queryGroupByDiv = queryGroupByDiv & "AND (m.primary_broker_code IN (:p_primarybroker)) "
queryGroupByDiv = queryGroupByDiv & "AND gd.GROUP_CODE in (:vp) "
queryGroupByDiv = queryGroupByDiv & "GROUP BY  "
queryGroupByDiv = queryGroupByDiv & "gd.GROUP_CODE, "
queryGroupByDiv = queryGroupByDiv & "groupdescr.GROUP_DESCR, "
queryGroupByDiv = queryGroupByDiv & "m.DIVISION_CODE, "
queryGroupByDiv = queryGroupByDiv & "m.DIVISION_DESCR, "
queryGroupByDiv = queryGroupByDiv & "'zzz', "
queryGroupByDiv = queryGroupByDiv & "mpbd.business_division_code, "
queryGroupByDiv = queryGroupByDiv & "'Total Value Added', "
queryGroupByDiv = queryGroupByDiv & "ids_mf.year_descr, "
queryGroupByDiv = queryGroupByDiv & "ids_mf.month_descr, "
queryGroupByDiv = queryGroupByDiv & "ids_mf.FISCAL_MONTH_NUMBER, "
queryGroupByDiv = queryGroupByDiv & "mpbd.business_division_Descr "
queryGroupByDiv = queryGroupByDiv & "---Begin Volume Total Market/CVP "
queryGroupByDiv = queryGroupByDiv & "UNION "
queryGroupByDiv = queryGroupByDiv & "SELECT    "
queryGroupByDiv = queryGroupByDiv & "'zzz' AS businessunit, "
queryGroupByDiv = queryGroupByDiv & "0 AS monthexpense_amt, "
queryGroupByDiv = queryGroupByDiv & "CASE WHEN (ids_mf.FISCAL_MONTH_NUMBER = (:p_Month)) "
queryGroupByDiv = queryGroupByDiv & "     THEN SUM (  ids_mf.mf_pounds_shipped "
queryGroupByDiv = queryGroupByDiv & "               + ids_mf.mf_adjusted_pounds_shipped "
queryGroupByDiv = queryGroupByDiv & "               + ids_mf.ids_pounds_shipped) "
queryGroupByDiv = queryGroupByDiv & "END AS monthpounds, "
queryGroupByDiv = queryGroupByDiv & "CASE WHEN (ids_mf.FISCAL_MONTH_NUMBER = (:p_Month)) "
queryGroupByDiv = queryGroupByDiv & "     THEN SUM (  ids_mf.mf_gross_sales_amount "
queryGroupByDiv = queryGroupByDiv & "                - ids_mf.mf_allow_amount "
queryGroupByDiv = queryGroupByDiv & "                - ids_mf.mf_off_invoice_amount "
queryGroupByDiv = queryGroupByDiv & "                + ids_mf.mf_revenue_adjustment "
queryGroupByDiv = queryGroupByDiv & "                + ids_mf.ids_indirect_sales_amount) "
queryGroupByDiv = queryGroupByDiv & "END AS monthnetreceivables, "
queryGroupByDiv = queryGroupByDiv & "gd.GROUP_CODE, "
queryGroupByDiv = queryGroupByDiv & "groupdescr.GROUP_DESCR, "
queryGroupByDiv = queryGroupByDiv & "m.DIVISION_CODE, "
queryGroupByDiv = queryGroupByDiv & "m.DIVISION_DESCR, "
queryGroupByDiv = queryGroupByDiv & "mpbd.business_division_code, "
queryGroupByDiv = queryGroupByDiv & "'Total Market/CVP' AS businessdivisiondescr, "
queryGroupByDiv = queryGroupByDiv & "NULL AS spend_base_descr, "
queryGroupByDiv = queryGroupByDiv & "NULL AS spend_base_seq, "
queryGroupByDiv = queryGroupByDiv & "NULL AS spend_subcategory_descr, "
queryGroupByDiv = queryGroupByDiv & "NULL AS spend_subcategory_seq, "
queryGroupByDiv = queryGroupByDiv & "ids_mf.year_descr, "
queryGroupByDiv = queryGroupByDiv & "ids_mf.month_descr, "
queryGroupByDiv = queryGroupByDiv & "0 AS expense_amt, "
queryGroupByDiv = queryGroupByDiv & "SUM (  ids_mf.mf_pounds_shipped "
queryGroupByDiv = queryGroupByDiv & "        + ids_mf.mf_adjusted_pounds_shipped "
queryGroupByDiv = queryGroupByDiv & "        + ids_mf.ids_pounds_shipped "
queryGroupByDiv = queryGroupByDiv & "        ) AS total_pounds_shipped, "
queryGroupByDiv = queryGroupByDiv & "SUM (  ids_mf.mf_gross_sales_amount "
queryGroupByDiv = queryGroupByDiv & "        - ids_mf.mf_allow_amount "
queryGroupByDiv = queryGroupByDiv & "        - ids_mf.mf_off_invoice_amount "
queryGroupByDiv = queryGroupByDiv & "        + ids_mf.mf_revenue_adjustment "
queryGroupByDiv = queryGroupByDiv & "        + ids_mf.ids_indirect_sales_amount "
queryGroupByDiv = queryGroupByDiv & ") AS net_receivable_dollar "
queryGroupByDiv = queryGroupByDiv & "FROM ( "
queryGroupByDiv = queryGroupByDiv & "---Begin sub queryGroupByDiv "
queryGroupByDiv = queryGroupByDiv & "SELECT   mpbd1.business_division_code, "
queryGroupByDiv = queryGroupByDiv & "mpbd1.business_division_descr, "
queryGroupByDiv = queryGroupByDiv & "mpbd1.restated_market_key, "
queryGroupByDiv = queryGroupByDiv & "mpbd1.restated_product_key, "
queryGroupByDiv = queryGroupByDiv & "md1.year_descr, "
queryGroupByDiv = queryGroupByDiv & "md1.month_descr, "
queryGroupByDiv = queryGroupByDiv & "md1.FISCAL_MONTH_NUMBER, "
queryGroupByDiv = queryGroupByDiv & "SUM (mf.pounds_shipped) AS mf_pounds_shipped, "
queryGroupByDiv = queryGroupByDiv & "SUM (mf.adj_pounds_shipped) AS mf_adjusted_pounds_shipped, "
queryGroupByDiv = queryGroupByDiv & "SUM (mf.gross_sales_amount) AS mf_gross_sales_amount, "
queryGroupByDiv = queryGroupByDiv & "SUM (mf.allow_amount) AS mf_allow_amount, "
queryGroupByDiv = queryGroupByDiv & "SUM (mf.revenue_adjustment) AS mf_revenue_adjustment, "
queryGroupByDiv = queryGroupByDiv & "SUM (mf.off_invoice_amount) AS mf_off_invoice_amount, "
queryGroupByDiv = queryGroupByDiv & "0 AS ids_pounds_shipped, "
queryGroupByDiv = queryGroupByDiv & "0 AS ids_indirect_sales_amount "
queryGroupByDiv = queryGroupByDiv & "FROM tdw_owner.restated_mkt_prd_bus_div_dim mpbd1, "
queryGroupByDiv = queryGroupByDiv & "tdw_owner.restated_market m1, "
queryGroupByDiv = queryGroupByDiv & "tdw_owner.month_dim md1, "
queryGroupByDiv = queryGroupByDiv & "tdw_owner.restated_product p1, "
queryGroupByDiv = queryGroupByDiv & "tdw_owner.day_dim d1, "
queryGroupByDiv = queryGroupByDiv & "tdw_owner.margin_fact mf, "
queryGroupByDiv = queryGroupByDiv & "tdw_owner.group_detail gd, "
queryGroupByDiv = queryGroupByDiv & "tdw_owner.group_description groupdescr "
queryGroupByDiv = queryGroupByDiv & "WHERE mf.restated_market_key = m1.restated_market_key "
queryGroupByDiv = queryGroupByDiv & "AND mf.restated_product_key = p1.restated_product_key "
queryGroupByDiv = queryGroupByDiv & "AND mf.restated_market_key = mpbd1.restated_market_key "
queryGroupByDiv = queryGroupByDiv & "AND mf.restated_product_key = mpbd1.restated_product_key "
queryGroupByDiv = queryGroupByDiv & "AND mf.invoice_day_key = d1.day_key "
queryGroupByDiv = queryGroupByDiv & "AND d1.month_ending_date = md1.month_ending_date "
queryGroupByDiv = queryGroupByDiv & "AND gd.GROUP_CODE = groupdescr.GROUP_CODE "
queryGroupByDiv = queryGroupByDiv & "AND gd.group_field_c  =  m1.DIVISION_CODE "
queryGroupByDiv = queryGroupByDiv & "AND (mpbd1.business_division_code IN ('F03', 'F04')) "
queryGroupByDiv = queryGroupByDiv & "AND (m1.selling_group_code IN ('119000', '125000', '610000', '800000', '423000')) "
queryGroupByDiv = queryGroupByDiv & "AND (md1.year_descr IN (:p_year)) "
queryGroupByDiv = queryGroupByDiv & "and md1.fiscal_month_number <= :p_Month "
queryGroupByDiv = queryGroupByDiv & "AND (mpbd1.business_division_code IN (:p_businessdivision)) "
queryGroupByDiv = queryGroupByDiv & "AND (m1.division_code IN (:p_salesdivision)) "
queryGroupByDiv = queryGroupByDiv & "AND (m1.region_code IN (:p_salesregion)) "
queryGroupByDiv = queryGroupByDiv & "AND (m1.primary_broker_code IN (:p_primarybroker)) "
queryGroupByDiv = queryGroupByDiv & "AND gd.GROUP_CODE in (:vp) "
queryGroupByDiv = queryGroupByDiv & "GROUP BY mpbd1.business_division_code, "
queryGroupByDiv = queryGroupByDiv & "mpbd1.business_division_descr, "
queryGroupByDiv = queryGroupByDiv & "mpbd1.restated_market_key, "
queryGroupByDiv = queryGroupByDiv & "mpbd1.restated_product_key, "
queryGroupByDiv = queryGroupByDiv & "md1.year_descr, "
queryGroupByDiv = queryGroupByDiv & "md1.month_descr, "
queryGroupByDiv = queryGroupByDiv & "md1.FISCAL_MONTH_NUMBER "
queryGroupByDiv = queryGroupByDiv & "UNION "
queryGroupByDiv = queryGroupByDiv & "SELECT   /*+ RULE */ "
queryGroupByDiv = queryGroupByDiv & "mpbd1.business_division_code, "
queryGroupByDiv = queryGroupByDiv & "mpbd1.business_division_descr, "
queryGroupByDiv = queryGroupByDiv & "mpbd1.restated_market_key, "
queryGroupByDiv = queryGroupByDiv & "mpbd1.restated_product_key, "
queryGroupByDiv = queryGroupByDiv & "md1.year_descr, "
queryGroupByDiv = queryGroupByDiv & "md1.month_descr, "
queryGroupByDiv = queryGroupByDiv & "md1.FISCAL_MONTH_NUMBER, "
queryGroupByDiv = queryGroupByDiv & "0 AS mf_pounds_shipped, "
queryGroupByDiv = queryGroupByDiv & "0 AS mf_adjusted_pounds_shipped, "
queryGroupByDiv = queryGroupByDiv & "0 AS mf_gross_sales_amount, "
queryGroupByDiv = queryGroupByDiv & "0 AS mf_allow_amount, "
queryGroupByDiv = queryGroupByDiv & "0 AS mf_revenue_adjustment, "
queryGroupByDiv = queryGroupByDiv & "0 AS mf_off_invoice_amount, "
queryGroupByDiv = queryGroupByDiv & "SUM (ids.pounds_shipped) AS ids_pounds_shipped, "
queryGroupByDiv = queryGroupByDiv & "SUM (ids.indirect_sales_amount) "
queryGroupByDiv = queryGroupByDiv & "                 AS ids_indirect_sales_amount "
queryGroupByDiv = queryGroupByDiv & "FROM tdw_owner.restated_mkt_prd_bus_div_dim mpbd1, "
queryGroupByDiv = queryGroupByDiv & "tdw_owner.restated_market m1, "
queryGroupByDiv = queryGroupByDiv & "tdw_owner.month_dim md1, "
queryGroupByDiv = queryGroupByDiv & "tdw_owner.restated_product p1, "
queryGroupByDiv = queryGroupByDiv & "tdw_owner.indirect_sales ids, "
queryGroupByDiv = queryGroupByDiv & "tdw_owner.week_dim w1, "
queryGroupByDiv = queryGroupByDiv & "tdw_owner.group_detail gd, "
queryGroupByDiv = queryGroupByDiv & "tdw_owner.group_description groupdescr "
queryGroupByDiv = queryGroupByDiv & "WHERE ids.restated_market_key = m1.restated_market_key "
queryGroupByDiv = queryGroupByDiv & "AND ids.restated_product_key = p1.restated_product_key "
queryGroupByDiv = queryGroupByDiv & "AND ids.restated_market_key = mpbd1.restated_market_key "
queryGroupByDiv = queryGroupByDiv & "AND ids.restated_product_key = mpbd1.restated_product_key "
queryGroupByDiv = queryGroupByDiv & "AND ids.week_key = w1.week_key "
queryGroupByDiv = queryGroupByDiv & "AND w1.month_ending_date = md1.month_ending_date "
queryGroupByDiv = queryGroupByDiv & "AND gd.GROUP_CODE = groupdescr.GROUP_CODE "
queryGroupByDiv = queryGroupByDiv & "AND gd.group_field_c  =  m1.DIVISION_CODE "
queryGroupByDiv = queryGroupByDiv & "AND (mpbd1.business_division_code IN ('F03', 'F04')) "
queryGroupByDiv = queryGroupByDiv & "AND (m1.selling_group_code IN ('119000', '125000', '610000', '800000', '423000')) "
queryGroupByDiv = queryGroupByDiv & "AND (md1.year_descr IN (:p_year)) "
queryGroupByDiv = queryGroupByDiv & "and md1.fiscal_month_number <= :p_Month "
queryGroupByDiv = queryGroupByDiv & "AND (mpbd1.business_division_code IN (:p_businessdivision)) "
queryGroupByDiv = queryGroupByDiv & "AND (m1.division_code IN (:p_salesdivision)) "
queryGroupByDiv = queryGroupByDiv & "AND (m1.region_code IN (:p_salesregion)) "
queryGroupByDiv = queryGroupByDiv & "AND (m1.primary_broker_code IN (:p_primarybroker)) "
queryGroupByDiv = queryGroupByDiv & "AND gd.GROUP_CODE in (:vp) "
queryGroupByDiv = queryGroupByDiv & "GROUP BY mpbd1.business_division_code, "
queryGroupByDiv = queryGroupByDiv & "mpbd1.business_division_descr, "
queryGroupByDiv = queryGroupByDiv & "mpbd1.restated_market_key, "
queryGroupByDiv = queryGroupByDiv & "mpbd1.restated_product_key, "
queryGroupByDiv = queryGroupByDiv & "md1.year_descr, "
queryGroupByDiv = queryGroupByDiv & "md1.month_descr, "
queryGroupByDiv = queryGroupByDiv & "md1.FISCAL_MONTH_NUMBER "
queryGroupByDiv = queryGroupByDiv & ")  ---End sub queryGroupByDiv "
queryGroupByDiv = queryGroupByDiv & "   ids_mf, "
queryGroupByDiv = queryGroupByDiv & "tdw_owner.restated_mkt_prd_bus_div_dim mpbd, "
queryGroupByDiv = queryGroupByDiv & "tdw_owner.restated_market m, "
queryGroupByDiv = queryGroupByDiv & "tdw_owner.restated_product p, "
queryGroupByDiv = queryGroupByDiv & "tdw_owner.group_detail gd, "
queryGroupByDiv = queryGroupByDiv & "tdw_owner.group_description groupdescr "
queryGroupByDiv = queryGroupByDiv & "WHERE ids_mf.restated_market_key = mpbd.restated_market_key "
queryGroupByDiv = queryGroupByDiv & "AND ids_mf.restated_product_key = mpbd.restated_product_key "
queryGroupByDiv = queryGroupByDiv & "AND ids_mf.restated_market_key = m.restated_market_key "
queryGroupByDiv = queryGroupByDiv & "AND ids_mf.restated_product_key = p.restated_product_key "
queryGroupByDiv = queryGroupByDiv & "AND gd.GROUP_CODE = groupdescr.GROUP_CODE "
queryGroupByDiv = queryGroupByDiv & "AND gd.group_field_c  =  m.DIVISION_CODE "
queryGroupByDiv = queryGroupByDiv & "AND (mpbd.business_division_code IN ('F03', 'F04')) "
queryGroupByDiv = queryGroupByDiv & "AND (m.selling_group_code IN ('119000', '125000', '610000', '800000', '423000')) "
queryGroupByDiv = queryGroupByDiv & "AND (ids_mf.year_descr IN (:p_year)) "
queryGroupByDiv = queryGroupByDiv & "and ids_mf.fiscal_month_number <= :p_Month "
queryGroupByDiv = queryGroupByDiv & "AND (mpbd.business_division_code IN (:p_businessdivision)) "
queryGroupByDiv = queryGroupByDiv & "AND (m.division_code IN (:p_salesdivision)) "
queryGroupByDiv = queryGroupByDiv & "AND (m.region_code IN (:p_salesregion)) "
queryGroupByDiv = queryGroupByDiv & "AND (m.primary_broker_code IN (:p_primarybroker)) "
queryGroupByDiv = queryGroupByDiv & "AND gd.GROUP_CODE in (:vp) "
queryGroupByDiv = queryGroupByDiv & "GROUP BY  "
queryGroupByDiv = queryGroupByDiv & "gd.GROUP_CODE, "
queryGroupByDiv = queryGroupByDiv & "groupdescr.GROUP_DESCR, "
queryGroupByDiv = queryGroupByDiv & "m.DIVISION_CODE, "
queryGroupByDiv = queryGroupByDiv & "m.DIVISION_DESCR, "
queryGroupByDiv = queryGroupByDiv & "'zzz', "
queryGroupByDiv = queryGroupByDiv & "mpbd.business_division_code, "
queryGroupByDiv = queryGroupByDiv & "'Total Market/CVP', "
queryGroupByDiv = queryGroupByDiv & "ids_mf.year_descr, "
queryGroupByDiv = queryGroupByDiv & "ids_mf.month_descr, "
queryGroupByDiv = queryGroupByDiv & "ids_mf.FISCAL_MONTH_NUMBER, "
queryGroupByDiv = queryGroupByDiv & "mpbd.business_division_Descr "
queryGroupByDiv = queryGroupByDiv & "---Begin Volume Total customer "
queryGroupByDiv = queryGroupByDiv & "UNION "
queryGroupByDiv = queryGroupByDiv & "SELECT    "
queryGroupByDiv = queryGroupByDiv & "'zzz' AS businessunit, "
queryGroupByDiv = queryGroupByDiv & "0 AS monthexpense_amt, "
queryGroupByDiv = queryGroupByDiv & "CASE WHEN (ids_mf.FISCAL_MONTH_NUMBER = (:p_Month)) "
queryGroupByDiv = queryGroupByDiv & "     THEN SUM (  ids_mf.mf_pounds_shipped "
queryGroupByDiv = queryGroupByDiv & "               + ids_mf.mf_adjusted_pounds_shipped "
queryGroupByDiv = queryGroupByDiv & "               + ids_mf.ids_pounds_shipped) "
queryGroupByDiv = queryGroupByDiv & "END AS monthpounds, "
queryGroupByDiv = queryGroupByDiv & "CASE WHEN (ids_mf.FISCAL_MONTH_NUMBER = (:p_Month)) "
queryGroupByDiv = queryGroupByDiv & "     THEN SUM (  ids_mf.mf_gross_sales_amount "
queryGroupByDiv = queryGroupByDiv & "                - ids_mf.mf_allow_amount "
queryGroupByDiv = queryGroupByDiv & "                - ids_mf.mf_off_invoice_amount "
queryGroupByDiv = queryGroupByDiv & "                + ids_mf.mf_revenue_adjustment "
queryGroupByDiv = queryGroupByDiv & "                + ids_mf.ids_indirect_sales_amount) "
queryGroupByDiv = queryGroupByDiv & "END AS monthnetreceivables, "
queryGroupByDiv = queryGroupByDiv & "gd.GROUP_CODE, "
queryGroupByDiv = queryGroupByDiv & "groupdescr.GROUP_DESCR, "
queryGroupByDiv = queryGroupByDiv & "m.DIVISION_CODE, "
queryGroupByDiv = queryGroupByDiv & "m.DIVISION_DESCR, "
queryGroupByDiv = queryGroupByDiv & "mpbd.business_division_code, "
queryGroupByDiv = queryGroupByDiv & "'Total Customer' AS businessdivisiondescr, "
queryGroupByDiv = queryGroupByDiv & "NULL AS spend_base_descr, "
queryGroupByDiv = queryGroupByDiv & "NULL AS spend_base_seq, "
queryGroupByDiv = queryGroupByDiv & "NULL AS spend_subcategory_descr, "
queryGroupByDiv = queryGroupByDiv & "NULL AS spend_subcategory_seq, "
queryGroupByDiv = queryGroupByDiv & "ids_mf.year_descr, "
queryGroupByDiv = queryGroupByDiv & "ids_mf.month_descr, "
queryGroupByDiv = queryGroupByDiv & "0 AS expense_amt, "
queryGroupByDiv = queryGroupByDiv & "SUM (  ids_mf.mf_pounds_shipped "
queryGroupByDiv = queryGroupByDiv & "       + ids_mf.mf_adjusted_pounds_shipped "
queryGroupByDiv = queryGroupByDiv & "       + ids_mf.ids_pounds_shipped "
queryGroupByDiv = queryGroupByDiv & "      ) AS total_pounds_shipped, "
queryGroupByDiv = queryGroupByDiv & "SUM (  ids_mf.mf_gross_sales_amount "
queryGroupByDiv = queryGroupByDiv & "     - ids_mf.mf_allow_amount "
queryGroupByDiv = queryGroupByDiv & "     - ids_mf.mf_off_invoice_amount "
queryGroupByDiv = queryGroupByDiv & "     + ids_mf.mf_revenue_adjustment "
queryGroupByDiv = queryGroupByDiv & "     + ids_mf.ids_indirect_sales_amount "
queryGroupByDiv = queryGroupByDiv & "     ) AS net_receivable_dollar "
queryGroupByDiv = queryGroupByDiv & "FROM ( "
queryGroupByDiv = queryGroupByDiv & "---Begin sub queryGroupByDiv "
queryGroupByDiv = queryGroupByDiv & "SELECT   mpbd1.business_division_code, "
queryGroupByDiv = queryGroupByDiv & "mpbd1.business_division_descr, "
queryGroupByDiv = queryGroupByDiv & "mpbd1.restated_market_key, "
queryGroupByDiv = queryGroupByDiv & "mpbd1.restated_product_key, "
queryGroupByDiv = queryGroupByDiv & "md1.year_descr, "
queryGroupByDiv = queryGroupByDiv & "md1.month_descr, "
queryGroupByDiv = queryGroupByDiv & "md1.FISCAL_MONTH_NUMBER, "
queryGroupByDiv = queryGroupByDiv & "SUM (mf.pounds_shipped) AS mf_pounds_shipped, "
queryGroupByDiv = queryGroupByDiv & "SUM (mf.adj_pounds_shipped) AS mf_adjusted_pounds_shipped, "
queryGroupByDiv = queryGroupByDiv & "SUM (mf.gross_sales_amount) AS mf_gross_sales_amount, "
queryGroupByDiv = queryGroupByDiv & "SUM (mf.allow_amount) AS mf_allow_amount, "
queryGroupByDiv = queryGroupByDiv & "SUM (mf.revenue_adjustment) AS mf_revenue_adjustment, "
queryGroupByDiv = queryGroupByDiv & "SUM (mf.off_invoice_amount) AS mf_off_invoice_amount, "
queryGroupByDiv = queryGroupByDiv & "0 AS ids_pounds_shipped, "
queryGroupByDiv = queryGroupByDiv & "0 AS ids_indirect_sales_amount "
queryGroupByDiv = queryGroupByDiv & "FROM tdw_owner.restated_mkt_prd_bus_div_dim mpbd1, "
queryGroupByDiv = queryGroupByDiv & "tdw_owner.restated_market m1, "
queryGroupByDiv = queryGroupByDiv & "tdw_owner.month_dim md1, "
queryGroupByDiv = queryGroupByDiv & "tdw_owner.restated_product p1, "
queryGroupByDiv = queryGroupByDiv & "tdw_owner.day_dim d1, "
queryGroupByDiv = queryGroupByDiv & "tdw_owner.margin_fact mf, "
queryGroupByDiv = queryGroupByDiv & "tdw_owner.group_detail gd, "
queryGroupByDiv = queryGroupByDiv & "tdw_owner.group_description groupdescr "
queryGroupByDiv = queryGroupByDiv & "WHERE mf.restated_market_key = m1.restated_market_key "
queryGroupByDiv = queryGroupByDiv & "AND mf.restated_product_key = p1.restated_product_key "
queryGroupByDiv = queryGroupByDiv & "AND mf.restated_market_key = mpbd1.restated_market_key "
queryGroupByDiv = queryGroupByDiv & "AND mf.restated_product_key = mpbd1.restated_product_key "
queryGroupByDiv = queryGroupByDiv & "AND mf.invoice_day_key = d1.day_key "
queryGroupByDiv = queryGroupByDiv & "AND d1.month_ending_date = md1.month_ending_date "
queryGroupByDiv = queryGroupByDiv & "AND gd.GROUP_CODE = groupdescr.GROUP_CODE "
queryGroupByDiv = queryGroupByDiv & "AND gd.group_field_c  =  m1.DIVISION_CODE "
queryGroupByDiv = queryGroupByDiv & "AND (mpbd1.business_division_code IN ('F01', 'F03', 'F04', 'F08', 'F15')) "
queryGroupByDiv = queryGroupByDiv & "AND (m1.selling_group_code IN ('119000', '125000', '610000', '800000', '423000')) "
queryGroupByDiv = queryGroupByDiv & "AND (md1.year_descr IN (:p_year)) "
queryGroupByDiv = queryGroupByDiv & "and md1.fiscal_month_number <= :p_Month "
queryGroupByDiv = queryGroupByDiv & "AND (mpbd1.business_division_code IN (:p_businessdivision)) "
queryGroupByDiv = queryGroupByDiv & "AND (m1.division_code IN (:p_salesdivision)) "
queryGroupByDiv = queryGroupByDiv & "AND (m1.region_code IN (:p_salesregion)) "
queryGroupByDiv = queryGroupByDiv & "AND (m1.primary_broker_code IN (:p_primarybroker)) "
queryGroupByDiv = queryGroupByDiv & "AND gd.GROUP_CODE in (:vp) "
queryGroupByDiv = queryGroupByDiv & "GROUP BY mpbd1.business_division_code, "
queryGroupByDiv = queryGroupByDiv & "mpbd1.business_division_descr, "
queryGroupByDiv = queryGroupByDiv & "mpbd1.restated_market_key, "
queryGroupByDiv = queryGroupByDiv & "mpbd1.restated_product_key, "
queryGroupByDiv = queryGroupByDiv & "md1.year_descr, "
queryGroupByDiv = queryGroupByDiv & "md1.month_descr, "
queryGroupByDiv = queryGroupByDiv & "md1.FISCAL_MONTH_NUMBER "
queryGroupByDiv = queryGroupByDiv & "UNION "
queryGroupByDiv = queryGroupByDiv & "SELECT   /*+ RULE */ "
queryGroupByDiv = queryGroupByDiv & "mpbd1.business_division_code, "
queryGroupByDiv = queryGroupByDiv & "mpbd1.business_division_descr, "
queryGroupByDiv = queryGroupByDiv & "mpbd1.restated_market_key, "
queryGroupByDiv = queryGroupByDiv & "mpbd1.restated_product_key, "
queryGroupByDiv = queryGroupByDiv & "md1.year_descr, "
queryGroupByDiv = queryGroupByDiv & "md1.month_descr, "
queryGroupByDiv = queryGroupByDiv & "md1.FISCAL_MONTH_NUMBER, "
queryGroupByDiv = queryGroupByDiv & "0 AS mf_pounds_shipped, "
queryGroupByDiv = queryGroupByDiv & "0 AS mf_adjusted_pounds_shipped, "
queryGroupByDiv = queryGroupByDiv & "0 AS mf_gross_sales_amount, "
queryGroupByDiv = queryGroupByDiv & "0 AS mf_allow_amount, "
queryGroupByDiv = queryGroupByDiv & "0 AS mf_revenue_adjustment, "
queryGroupByDiv = queryGroupByDiv & "0 AS mf_off_invoice_amount, "
queryGroupByDiv = queryGroupByDiv & "SUM (ids.pounds_shipped) AS ids_pounds_shipped, "
queryGroupByDiv = queryGroupByDiv & "SUM (ids.indirect_sales_amount) "
queryGroupByDiv = queryGroupByDiv & "                 AS ids_indirect_sales_amount "
queryGroupByDiv = queryGroupByDiv & "FROM tdw_owner.restated_mkt_prd_bus_div_dim mpbd1, "
queryGroupByDiv = queryGroupByDiv & "tdw_owner.restated_market m1, "
queryGroupByDiv = queryGroupByDiv & "tdw_owner.month_dim md1, "
queryGroupByDiv = queryGroupByDiv & "tdw_owner.restated_product p1, "
queryGroupByDiv = queryGroupByDiv & "tdw_owner.indirect_sales ids, "
queryGroupByDiv = queryGroupByDiv & "tdw_owner.week_dim w1, "
queryGroupByDiv = queryGroupByDiv & "tdw_owner.group_detail gd, "
queryGroupByDiv = queryGroupByDiv & "tdw_owner.group_description groupdescr "
queryGroupByDiv = queryGroupByDiv & "WHERE ids.restated_market_key = m1.restated_market_key "
queryGroupByDiv = queryGroupByDiv & "AND ids.restated_product_key = p1.restated_product_key "
queryGroupByDiv = queryGroupByDiv & "AND ids.restated_market_key = mpbd1.restated_market_key "
queryGroupByDiv = queryGroupByDiv & "AND ids.restated_product_key = mpbd1.restated_product_key "
queryGroupByDiv = queryGroupByDiv & "AND ids.week_key = w1.week_key "
queryGroupByDiv = queryGroupByDiv & "AND w1.month_ending_date = md1.month_ending_date "
queryGroupByDiv = queryGroupByDiv & "AND gd.GROUP_CODE = groupdescr.GROUP_CODE "
queryGroupByDiv = queryGroupByDiv & "AND gd.group_field_c  =  m1.DIVISION_CODE "
queryGroupByDiv = queryGroupByDiv & "AND (mpbd1.business_division_code IN ('F01', 'F03', 'F04', 'F08', 'F15')) "
queryGroupByDiv = queryGroupByDiv & "AND (m1.selling_group_code IN ('119000', '125000', '610000', '800000', '423000')) "
queryGroupByDiv = queryGroupByDiv & "AND (md1.year_descr IN (:p_year)) "
queryGroupByDiv = queryGroupByDiv & "and md1.fiscal_month_number <= :p_Month "
queryGroupByDiv = queryGroupByDiv & "AND (mpbd1.business_division_code IN (:p_businessdivision)) "
queryGroupByDiv = queryGroupByDiv & "AND (m1.division_code IN (:p_salesdivision)) "
queryGroupByDiv = queryGroupByDiv & "AND (m1.region_code IN (:p_salesregion)) "
queryGroupByDiv = queryGroupByDiv & "AND (m1.primary_broker_code IN (:p_primarybroker)) "
queryGroupByDiv = queryGroupByDiv & "AND gd.GROUP_CODE in (:vp) "
queryGroupByDiv = queryGroupByDiv & "GROUP BY mpbd1.business_division_code, "
queryGroupByDiv = queryGroupByDiv & "mpbd1.business_division_descr, "
queryGroupByDiv = queryGroupByDiv & "mpbd1.restated_market_key, "
queryGroupByDiv = queryGroupByDiv & "mpbd1.restated_product_key, "
queryGroupByDiv = queryGroupByDiv & "md1.year_descr, "
queryGroupByDiv = queryGroupByDiv & "md1.month_descr, "
queryGroupByDiv = queryGroupByDiv & "md1.FISCAL_MONTH_NUMBER "
queryGroupByDiv = queryGroupByDiv & ")   --end sub queryGroupByDiv "
queryGroupByDiv = queryGroupByDiv & "   ids_mf, "
queryGroupByDiv = queryGroupByDiv & "tdw_owner.restated_mkt_prd_bus_div_dim mpbd, "
queryGroupByDiv = queryGroupByDiv & "tdw_owner.restated_market m, "
queryGroupByDiv = queryGroupByDiv & "tdw_owner.restated_product p, "
queryGroupByDiv = queryGroupByDiv & "tdw_owner.group_detail gd, "
queryGroupByDiv = queryGroupByDiv & "tdw_owner.group_description groupdescr "
queryGroupByDiv = queryGroupByDiv & "WHERE ids_mf.restated_market_key = mpbd.restated_market_key "
queryGroupByDiv = queryGroupByDiv & "AND ids_mf.restated_product_key = mpbd.restated_product_key "
queryGroupByDiv = queryGroupByDiv & "AND ids_mf.restated_market_key = m.restated_market_key "
queryGroupByDiv = queryGroupByDiv & "AND ids_mf.restated_product_key = p.restated_product_key "
queryGroupByDiv = queryGroupByDiv & "AND gd.GROUP_CODE = groupdescr.GROUP_CODE "
queryGroupByDiv = queryGroupByDiv & "AND gd.group_field_c  =  m.DIVISION_CODE "
queryGroupByDiv = queryGroupByDiv & "AND (mpbd.business_division_code IN ('F01', 'F03', 'F04', 'F08', 'F15')) "
queryGroupByDiv = queryGroupByDiv & "AND (m.selling_group_code IN ('119000', '125000', '610000', '800000', '423000')) "
queryGroupByDiv = queryGroupByDiv & "AND (ids_mf.year_descr IN (:p_year)) "
queryGroupByDiv = queryGroupByDiv & "and ids_mf.fiscal_month_number <= :p_Month "
queryGroupByDiv = queryGroupByDiv & "AND (mpbd.business_division_code IN (:p_businessdivision)) "
queryGroupByDiv = queryGroupByDiv & "AND (m.division_code IN (:p_salesdivision)) "
queryGroupByDiv = queryGroupByDiv & "AND (m.region_code IN (:p_salesregion)) "
queryGroupByDiv = queryGroupByDiv & "AND (m.primary_broker_code IN (:p_primarybroker)) "
queryGroupByDiv = queryGroupByDiv & "AND gd.GROUP_CODE in (:vp) "
queryGroupByDiv = queryGroupByDiv & "GROUP BY  "
queryGroupByDiv = queryGroupByDiv & "gd.GROUP_CODE, "
queryGroupByDiv = queryGroupByDiv & "groupdescr.GROUP_DESCR, "
queryGroupByDiv = queryGroupByDiv & "m.DIVISION_CODE, "
queryGroupByDiv = queryGroupByDiv & "m.DIVISION_DESCR, "
queryGroupByDiv = queryGroupByDiv & "'zzz', "
queryGroupByDiv = queryGroupByDiv & "mpbd.business_division_code, "
queryGroupByDiv = queryGroupByDiv & "'Total Customer', "
queryGroupByDiv = queryGroupByDiv & "ids_mf.year_descr, "
queryGroupByDiv = queryGroupByDiv & "ids_mf.month_descr, "
queryGroupByDiv = queryGroupByDiv & "ids_mf.FISCAL_MONTH_NUMBER, "
queryGroupByDiv = queryGroupByDiv & "mpbd.business_division_Descr "
queryGroupByDiv = queryGroupByDiv & "ORDER BY businessdivisiondescr, spend_base_seq, spend_subcategory_seq"

Dim queryGroupByReg As String
queryGroupByReg = "SELECT   " 
queryGroupByReg = queryGroupByReg & "CASE WHEN (sc.spend_base_seq IN (1, 2, 3, 4, 5))THEN 'Distributor' "
queryGroupByReg = queryGroupByReg & "     WHEN (sc.spend_base_seq = 6)THEN 'Operator' "
queryGroupByReg = queryGroupByReg & "END AS businessunit, "
queryGroupByReg = queryGroupByReg & "CASE WHEN (md.FISCAL_MONTH_NUMBER = (:p_Month))THEN SUM (epf.expense_amt) "
queryGroupByReg = queryGroupByReg & "END AS monthexpense_amt, "
queryGroupByReg = queryGroupByReg & "0 AS monthpounds, "
queryGroupByReg = queryGroupByReg & "0 AS monthnetreceivables, "
queryGroupByReg = queryGroupByReg & "gd.GROUP_CODE, "
queryGroupByReg = queryGroupByReg & "groupdescr.GROUP_DESCR, "
queryGroupByReg = queryGroupByReg & "m.REGION_CODE, "
queryGroupByReg = queryGroupByReg & "m.REGION_DESCR, "
queryGroupByReg = queryGroupByReg & "mpbd.business_division_code, "
queryGroupByReg = queryGroupByReg & "INITCAP (mpbd.business_division_descr) AS businessdivisiondescr, "
queryGroupByReg = queryGroupByReg & "sc.spend_base_descr, "
queryGroupByReg = queryGroupByReg & "sc.spend_base_seq, "
queryGroupByReg = queryGroupByReg & "sc.spend_subcategory_descr, "
queryGroupByReg = queryGroupByReg & "sc.spend_subcategory_seq, "
queryGroupByReg = queryGroupByReg & "md.year_descr, "
queryGroupByReg = queryGroupByReg & "md.month_descr, "
queryGroupByReg = queryGroupByReg & "SUM (epf.expense_amt) AS expense_amt, "
queryGroupByReg = queryGroupByReg & "0 AS total_pounds_shipped, "
queryGroupByReg = queryGroupByReg & "0 AS net_receivable_dollar "
queryGroupByReg = queryGroupByReg & "FROM tdw_owner.restated_mkt_prd_bus_div_dim mpbd, "
queryGroupByReg = queryGroupByReg & "tdw_owner.expense_payment_fact epf, "
queryGroupByReg = queryGroupByReg & "tdw_owner.fsv_spend_category sc, "
queryGroupByReg = queryGroupByReg & "tdw_owner.restated_market m, "
queryGroupByReg = queryGroupByReg & "tdw_owner.month_dim md, "
queryGroupByReg = queryGroupByReg & "tdw_owner.restated_product p, "
queryGroupByReg = queryGroupByReg & "tdw_owner.acct_dim a, "
queryGroupByReg = queryGroupByReg & "tdw_owner.expense_type et, "
queryGroupByReg = queryGroupByReg & "tdw_owner.spend_request_dim s, "
queryGroupByReg = queryGroupByReg & "tdw_owner.operator_dim o, "
queryGroupByReg = queryGroupByReg & "tdw_owner.day_dim d1, "
queryGroupByReg = queryGroupByReg & "tdw_owner.day_dim d2, "
queryGroupByReg = queryGroupByReg & "tdw_owner.expense_attribute_dim ead, "
queryGroupByReg = queryGroupByReg & "tdw_owner.expense_payee_dim pay, "
queryGroupByReg = queryGroupByReg & "tdw_owner.group_detail gd, "
queryGroupByReg = queryGroupByReg & "tdw_owner.group_description groupdescr "
queryGroupByReg = queryGroupByReg & "WHERE mpbd.restated_mkt_prd_bus_div_key = epf.restated_mkt_prd_bus_div_key "
queryGroupByReg = queryGroupByReg & "AND epf.expense_type_key = sc.expense_type_key "
queryGroupByReg = queryGroupByReg & "AND epf.acct_key = sc.acct_key "
queryGroupByReg = queryGroupByReg & "AND epf.restated_market_key = m.restated_market_key "
queryGroupByReg = queryGroupByReg & "AND epf.month_key = md.month_key "
queryGroupByReg = queryGroupByReg & "AND epf.restated_product_key = p.restated_product_key "
queryGroupByReg = queryGroupByReg & "AND epf.acct_key = a.acct_key "
queryGroupByReg = queryGroupByReg & "AND epf.expense_type_key = et.expense_type_key "
queryGroupByReg = queryGroupByReg & "AND epf.spend_request_key = s.spend_request_key "
queryGroupByReg = queryGroupByReg & "AND epf.operator_key = o.operator_key "
queryGroupByReg = queryGroupByReg & "AND epf.report_period_begin_day_key = d1.day_key "
queryGroupByReg = queryGroupByReg & "AND epf.report_period_end_day_key = d2.day_key "
queryGroupByReg = queryGroupByReg & "AND epf.expense_attribute_key = ead.expense_attribute_key "
queryGroupByReg = queryGroupByReg & "AND epf.expense_payee_key = pay.expense_payee_key "
queryGroupByReg = queryGroupByReg & "AND gd.GROUP_CODE = groupdescr.GROUP_CODE "
queryGroupByReg = queryGroupByReg & "AND gd.group_field_c  =  m.DIVISION_CODE "
queryGroupByReg = queryGroupByReg & "AND sc.spend_base_seq S> 0 "
queryGroupByReg = queryGroupByReg & "AND sc.spend_subcategory_seq <> 0 "
queryGroupByReg = queryGroupByReg & "AND (mpbd.business_division_code IN ('F01', 'F03', 'F04', 'F08', 'F15')) "
queryGroupByReg = queryGroupByReg & "AND (m.selling_group_code IN ('119000', '125000', '610000', '800000', '423000')) "
queryGroupByReg = queryGroupByReg & "AND (md.year_descr IN (:p_year)) "
queryGroupByReg = queryGroupByReg & "and md.fiscal_month_number <= :p_Month "
queryGroupByReg = queryGroupByReg & "AND (mpbd.business_division_code IN (:p_businessdivision)) "
queryGroupByReg = queryGroupByReg & "AND (m.division_code IN (:p_salesdivision)) "
queryGroupByReg = queryGroupByReg & "AND (m.region_code IN (:p_salesregion)) "
queryGroupByReg = queryGroupByReg & "AND (m.primary_broker_code IN (:p_primarybroker)) "
queryGroupByReg = queryGroupByReg & "AND gd.GROUP_CODE in (:vp) "
queryGroupByReg = queryGroupByReg & "GROUP BY  "
queryGroupByReg = queryGroupByReg & "gd.GROUP_CODE, "
queryGroupByReg = queryGroupByReg & "groupdescr.GROUP_DESCR, "
queryGroupByReg = queryGroupByReg & "m.REGION_CODE, "
queryGroupByReg = queryGroupByReg & "m.REGION_DESCR, "
queryGroupByReg = queryGroupByReg & "mpbd.business_division_code, "
queryGroupByReg = queryGroupByReg & "INITCAP (mpbd.business_division_descr), "
queryGroupByReg = queryGroupByReg & "sc.spend_base_descr, "
queryGroupByReg = queryGroupByReg & "sc.spend_base_seq, "
queryGroupByReg = queryGroupByReg & "sc.spend_subcategory_descr, "
queryGroupByReg = queryGroupByReg & "sc.spend_subcategory_seq, "
queryGroupByReg = queryGroupByReg & "md.year_descr, "
queryGroupByReg = queryGroupByReg & "md.month_descr, "
queryGroupByReg = queryGroupByReg & "md.FISCAL_MONTH_NUMBER "
queryGroupByReg = queryGroupByReg & "---Add Expense Total Value Added "
queryGroupByReg = queryGroupByReg & "UNION "
queryGroupByReg = queryGroupByReg & "SELECT    "
queryGroupByReg = queryGroupByReg & "CASE WHEN (sc.spend_base_seq IN (1, 2, 3, 4, 5))THEN 'Distributor' "
queryGroupByReg = queryGroupByReg & "     WHEN (sc.spend_base_seq = 6)THEN 'Operator' "
queryGroupByReg = queryGroupByReg & "END AS businessunit, "
queryGroupByReg = queryGroupByReg & "CASE WHEN (md.FISCAL_MONTH_NUMBER = (:p_Month))THEN SUM (epf.expense_amt) "
queryGroupByReg = queryGroupByReg & "END AS monthexpense_amt, "
queryGroupByReg = queryGroupByReg & "0 AS monthpounds, "
queryGroupByReg = queryGroupByReg & "0 AS monthnetreceivables, "
queryGroupByReg = queryGroupByReg & "gd.GROUP_CODE, "
queryGroupByReg = queryGroupByReg & "groupdescr.GROUP_DESCR, "
queryGroupByReg = queryGroupByReg & "m.REGION_CODE, "
queryGroupByReg = queryGroupByReg & "m.REGION_DESCR, "
queryGroupByReg = queryGroupByReg & "mpbd.business_division_code, "
queryGroupByReg = queryGroupByReg & "'Total Value Added' AS businessdivisiondescr, "
queryGroupByReg = queryGroupByReg & "sc.spend_base_descr, "
queryGroupByReg = queryGroupByReg & "sc.spend_base_seq, "
queryGroupByReg = queryGroupByReg & "sc.spend_subcategory_descr, "
queryGroupByReg = queryGroupByReg & "sc.spend_subcategory_seq, "
queryGroupByReg = queryGroupByReg & "md.year_descr, "
queryGroupByReg = queryGroupByReg & "md.month_descr, "
queryGroupByReg = queryGroupByReg & "SUM (epf.expense_amt) AS expense_amt, "
queryGroupByReg = queryGroupByReg & "0 AS total_pounds_shipped, "
queryGroupByReg = queryGroupByReg & "0 AS net_receivable_dollar "
queryGroupByReg = queryGroupByReg & "FROM tdw_owner.restated_mkt_prd_bus_div_dim mpbd, "
queryGroupByReg = queryGroupByReg & "tdw_owner.expense_payment_fact epf, "
queryGroupByReg = queryGroupByReg & "tdw_owner.fsv_spend_category sc, "
queryGroupByReg = queryGroupByReg & "tdw_owner.restated_market m, "
queryGroupByReg = queryGroupByReg & "tdw_owner.month_dim md, "
queryGroupByReg = queryGroupByReg & "tdw_owner.restated_product p, "
queryGroupByReg = queryGroupByReg & "tdw_owner.acct_dim a, "
queryGroupByReg = queryGroupByReg & "tdw_owner.expense_type et, "
queryGroupByReg = queryGroupByReg & "tdw_owner.spend_request_dim s, "
queryGroupByReg = queryGroupByReg & "tdw_owner.operator_dim o, "
queryGroupByReg = queryGroupByReg & "tdw_owner.day_dim d1, "
queryGroupByReg = queryGroupByReg & "tdw_owner.day_dim d2, "
queryGroupByReg = queryGroupByReg & "tdw_owner.expense_attribute_dim ead, "
queryGroupByReg = queryGroupByReg & "tdw_owner.expense_payee_dim pay, "
queryGroupByReg = queryGroupByReg & "tdw_owner.group_detail gd, "
queryGroupByReg = queryGroupByReg & "tdw_owner.group_description groupdescr "
queryGroupByReg = queryGroupByReg & "WHERE mpbd.restated_mkt_prd_bus_div_key = epf.restated_mkt_prd_bus_div_key "
queryGroupByReg = queryGroupByReg & "AND epf.expense_type_key = sc.expense_type_key "
queryGroupByReg = queryGroupByReg & "AND epf.acct_key = sc.acct_key "
queryGroupByReg = queryGroupByReg & "AND epf.restated_market_key = m.restated_market_key "
queryGroupByReg = queryGroupByReg & "AND epf.month_key = md.month_key "
queryGroupByReg = queryGroupByReg & "AND epf.restated_product_key = p.restated_product_key "
queryGroupByReg = queryGroupByReg & "AND epf.acct_key = a.acct_key "
queryGroupByReg = queryGroupByReg & "AND epf.expense_type_key = et.expense_type_key "
queryGroupByReg = queryGroupByReg & "AND epf.spend_request_key = s.spend_request_key "
queryGroupByReg = queryGroupByReg & "AND epf.operator_key = o.operator_key "
queryGroupByReg = queryGroupByReg & "AND epf.report_period_begin_day_key = d1.day_key "
queryGroupByReg = queryGroupByReg & "AND epf.report_period_end_day_key = d2.day_key "
queryGroupByReg = queryGroupByReg & "AND epf.expense_attribute_key = ead.expense_attribute_key "
queryGroupByReg = queryGroupByReg & "AND epf.expense_payee_key = pay.expense_payee_key "
queryGroupByReg = queryGroupByReg & "AND gd.GROUP_CODE = groupdescr.GROUP_CODE "
queryGroupByReg = queryGroupByReg & "AND gd.group_field_c  =  m.DIVISION_CODE "
queryGroupByReg = queryGroupByReg & "AND sc.spend_base_seq <> 0 "
queryGroupByReg = queryGroupByReg & "AND sc.spend_subcategory_seq <> 0 "
queryGroupByReg = queryGroupByReg & "AND (mpbd.business_division_code IN ('F01', 'F03', 'F04', 'F08', 'F15')) "
queryGroupByReg = queryGroupByReg & "AND (m.selling_group_code IN ('119000', '125000', '610000', '800000', '423000')) "
queryGroupByReg = queryGroupByReg & "AND (md.year_descr IN (:p_year)) "
queryGroupByReg = queryGroupByReg & "and md.fiscal_month_number <= :p_Month "
queryGroupByReg = queryGroupByReg & "AND (mpbd.business_division_code IN (:p_businessdivision)) "
queryGroupByReg = queryGroupByReg & "AND (m.division_code IN (:p_salesdivision)) "
queryGroupByReg = queryGroupByReg & "AND (m.region_code IN (:p_salesregion)) "
queryGroupByReg = queryGroupByReg & "AND (m.primary_broker_code IN (:p_primarybroker)) "
queryGroupByReg = queryGroupByReg & "AND gd.GROUP_CODE in (:vp) "
queryGroupByReg = queryGroupByReg & "GROUP BY  "
queryGroupByReg = queryGroupByReg & "gd.GROUP_CODE, "
queryGroupByReg = queryGroupByReg & "groupdescr.GROUP_DESCR, "
queryGroupByReg = queryGroupByReg & "m.REGION_CODE, "
queryGroupByReg = queryGroupByReg & "m.REGION_DESCR, "
queryGroupByReg = queryGroupByReg & "mpbd.business_division_code, "
queryGroupByReg = queryGroupByReg & "'Total Value Added' , "
queryGroupByReg = queryGroupByReg & "sc.spend_base_descr, "
queryGroupByReg = queryGroupByReg & "sc.spend_base_seq, "
queryGroupByReg = queryGroupByReg & "sc.spend_subcategory_descr, "
queryGroupByReg = queryGroupByReg & "sc.spend_subcategory_seq, "
queryGroupByReg = queryGroupByReg & "md.year_descr, "
queryGroupByReg = queryGroupByReg & "md.month_descr, "
queryGroupByReg = queryGroupByReg & "md.FISCAL_MONTH_NUMBER, "
queryGroupByReg = queryGroupByReg & "mpbd.business_division_Descr "
queryGroupByReg = queryGroupByReg & "--Begin Expense Total Market/CVP "
queryGroupByReg = queryGroupByReg & "UNION "
queryGroupByReg = queryGroupByReg & "SELECT    "
queryGroupByReg = queryGroupByReg & "CASE WHEN (sc.spend_base_seq IN (1, 2, 3, 4, 5))THEN 'Distributor' "
queryGroupByReg = queryGroupByReg & "     WHEN (sc.spend_base_seq = 6)THEN 'Operator' "
queryGroupByReg = queryGroupByReg & "END AS businessunit, "
queryGroupByReg = queryGroupByReg & "CASE WHEN (md.FISCAL_MONTH_NUMBER = (:p_Month))THEN SUM (epf.expense_amt) "
queryGroupByReg = queryGroupByReg & "END AS monthexpense_amt, "
queryGroupByReg = queryGroupByReg & "0 AS monthpounds, "
queryGroupByReg = queryGroupByReg & "0 AS monthnetreceivables, "
queryGroupByReg = queryGroupByReg & "gd.GROUP_CODE, "
queryGroupByReg = queryGroupByReg & "groupdescr.GROUP_DESCR, "
queryGroupByReg = queryGroupByReg & "m.REGION_CODE, "
queryGroupByReg = queryGroupByReg & "m.REGION_DESCR, "
queryGroupByReg = queryGroupByReg & "mpbd.business_division_code, "
queryGroupByReg = queryGroupByReg & "'Total Market/CVP' AS businessdivisiondescr, "
queryGroupByReg = queryGroupByReg & "sc.spend_base_descr, "
queryGroupByReg = queryGroupByReg & "sc.spend_base_seq, "
queryGroupByReg = queryGroupByReg & "sc.spend_subcategory_descr, "
queryGroupByReg = queryGroupByReg & "sc.spend_subcategory_seq, "
queryGroupByReg = queryGroupByReg & "md.year_descr, "
queryGroupByReg = queryGroupByReg & "md.month_descr, "
queryGroupByReg = queryGroupByReg & "SUM (epf.expense_amt) AS expense_amt, "
queryGroupByReg = queryGroupByReg & "0 AS total_pounds_shipped, "
queryGroupByReg = queryGroupByReg & "0 AS net_receivable_dollar "
queryGroupByReg = queryGroupByReg & "FROM tdw_owner.restated_mkt_prd_bus_div_dim mpbd, "
queryGroupByReg = queryGroupByReg & "tdw_owner.expense_payment_fact epf, "
queryGroupByReg = queryGroupByReg & "tdw_owner.fsv_spend_category sc, "
queryGroupByReg = queryGroupByReg & "tdw_owner.restated_market m, "
queryGroupByReg = queryGroupByReg & "tdw_owner.month_dim md, "
queryGroupByReg = queryGroupByReg & "tdw_owner.restated_product p, "
queryGroupByReg = queryGroupByReg & "tdw_owner.acct_dim a, "
queryGroupByReg = queryGroupByReg & "tdw_owner.expense_type et, "
queryGroupByReg = queryGroupByReg & "tdw_owner.spend_request_dim s, "
queryGroupByReg = queryGroupByReg & "tdw_owner.operator_dim o, "
queryGroupByReg = queryGroupByReg & "tdw_owner.day_dim d1, "
queryGroupByReg = queryGroupByReg & "tdw_owner.day_dim d2, "
queryGroupByReg = queryGroupByReg & "tdw_owner.expense_attribute_dim ead, "
queryGroupByReg = queryGroupByReg & "tdw_owner.expense_payee_dim pay, "
queryGroupByReg = queryGroupByReg & "tdw_owner.group_detail gd, "
queryGroupByReg = queryGroupByReg & "tdw_owner.group_description groupdescr "
queryGroupByReg = queryGroupByReg & "WHERE mpbd.restated_mkt_prd_bus_div_key = epf.restated_mkt_prd_bus_div_key "
queryGroupByReg = queryGroupByReg & "AND epf.expense_type_key = sc.expense_type_key "
queryGroupByReg = queryGroupByReg & "AND epf.acct_key = sc.acct_key "
queryGroupByReg = queryGroupByReg & "AND epf.restated_market_key = m.restated_market_key "
queryGroupByReg = queryGroupByReg & "AND epf.month_key = md.month_key "
queryGroupByReg = queryGroupByReg & "AND epf.restated_product_key = p.restated_product_key "
queryGroupByReg = queryGroupByReg & "AND epf.acct_key = a.acct_key "
queryGroupByReg = queryGroupByReg & "AND epf.expense_type_key = et.expense_type_key "
queryGroupByReg = queryGroupByReg & "AND epf.spend_request_key = s.spend_request_key "
queryGroupByReg = queryGroupByReg & "AND epf.operator_key = o.operator_key "
queryGroupByReg = queryGroupByReg & "AND epf.report_period_begin_day_key = d1.day_key "
queryGroupByReg = queryGroupByReg & "AND epf.report_period_end_day_key = d2.day_key "
queryGroupByReg = queryGroupByReg & "AND epf.expense_attribute_key = ead.expense_attribute_key "
queryGroupByReg = queryGroupByReg & "AND epf.expense_payee_key = pay.expense_payee_key "
queryGroupByReg = queryGroupByReg & "AND gd.GROUP_CODE = groupdescr.GROUP_CODE "
queryGroupByReg = queryGroupByReg & "AND gd.group_field_c  =  m.DIVISION_CODE "
queryGroupByReg = queryGroupByReg & "AND sc.spend_base_seq <> 0 "
queryGroupByReg = queryGroupByReg & "AND sc.spend_subcategory_seq <> 0 "
queryGroupByReg = queryGroupByReg & "AND (mpbd.business_division_code IN ('F01', 'F03', 'F04', 'F08', 'F15')) "
queryGroupByReg = queryGroupByReg & "AND (m.selling_group_code IN ('119000', '125000', '610000', '800000', '423000')) "
queryGroupByReg = queryGroupByReg & "AND (md.year_descr IN (:p_year)) "
queryGroupByReg = queryGroupByReg & "and md.fiscal_month_number <= :p_Month "
queryGroupByReg = queryGroupByReg & "AND (mpbd.business_division_code IN (:p_businessdivision)) "
queryGroupByReg = queryGroupByReg & "AND (m.division_code IN (:p_salesdivision)) "
queryGroupByReg = queryGroupByReg & "AND (m.region_code IN (:p_salesregion)) "
queryGroupByReg = queryGroupByReg & "AND (m.primary_broker_code IN (:p_primarybroker)) "
queryGroupByReg = queryGroupByReg & "AND gd.GROUP_CODE in (:vp) "
queryGroupByReg = queryGroupByReg & "GROUP BY  "
queryGroupByReg = queryGroupByReg & "gd.GROUP_CODE, "
queryGroupByReg = queryGroupByReg & "groupdescr.GROUP_DESCR, "
queryGroupByReg = queryGroupByReg & "m.REGION_CODE, "
queryGroupByReg = queryGroupByReg & "m.REGION_DESCR, "
queryGroupByReg = queryGroupByReg & "mpbd.business_division_code, "
queryGroupByReg = queryGroupByReg & "'Total Market/CVP', "
queryGroupByReg = queryGroupByReg & "sc.spend_base_descr, "
queryGroupByReg = queryGroupByReg & "sc.spend_base_seq, "
queryGroupByReg = queryGroupByReg & "sc.spend_subcategory_descr, "
queryGroupByReg = queryGroupByReg & "sc.spend_subcategory_seq, "
queryGroupByReg = queryGroupByReg & "md.year_descr, "
queryGroupByReg = queryGroupByReg & "md.month_descr, "
queryGroupByReg = queryGroupByReg & "md.FISCAL_MONTH_NUMBER, "
queryGroupByReg = queryGroupByReg & "mpbd.business_division_Descr "
queryGroupByReg = queryGroupByReg & "--Begin Expense TotalCustomer "
queryGroupByReg = queryGroupByReg & "UNION "
queryGroupByReg = queryGroupByReg & "SELECT    "
queryGroupByReg = queryGroupByReg & "CASE WHEN (sc.spend_base_seq IN (1, 2, 3, 4, 5))THEN 'Distributor' "
queryGroupByReg = queryGroupByReg & "     WHEN (sc.spend_base_seq = 6)THEN 'Operator' "
queryGroupByReg = queryGroupByReg & "END AS businessunit, "
queryGroupByReg = queryGroupByReg & "CASE WHEN (md.FISCAL_MONTH_NUMBER = (:p_Month))THEN SUM (epf.expense_amt) "
queryGroupByReg = queryGroupByReg & "END AS monthexpense_amt, "
queryGroupByReg = queryGroupByReg & "0 AS monthpounds, "
queryGroupByReg = queryGroupByReg & "0 AS monthnetreceivables, "
queryGroupByReg = queryGroupByReg & "gd.GROUP_CODE, "
queryGroupByReg = queryGroupByReg & "groupdescr.GROUP_DESCR, "
queryGroupByReg = queryGroupByReg & "m.REGION_CODE, "
queryGroupByReg = queryGroupByReg & "m.REGION_DESCR, "
queryGroupByReg = queryGroupByReg & "mpbd.business_division_code, "
queryGroupByReg = queryGroupByReg & "'Total Customer' AS businessdivisiondescr, "
queryGroupByReg = queryGroupByReg & "sc.spend_base_descr, "
queryGroupByReg = queryGroupByReg & "sc.spend_base_seq, "
queryGroupByReg = queryGroupByReg & "sc.spend_subcategory_descr, "
queryGroupByReg = queryGroupByReg & "sc.spend_subcategory_seq, "
queryGroupByReg = queryGroupByReg & "md.year_descr, "
queryGroupByReg = queryGroupByReg & "md.month_descr, "
queryGroupByReg = queryGroupByReg & "SUM (epf.expense_amt) AS expense_amt, "
queryGroupByReg = queryGroupByReg & "0 AS total_pounds_shipped, "
queryGroupByReg = queryGroupByReg & "0 AS net_receivable_dollar "
queryGroupByReg = queryGroupByReg & "FROM tdw_owner.restated_mkt_prd_bus_div_dim mpbd, "
queryGroupByReg = queryGroupByReg & "tdw_owner.expense_payment_fact epf, "
queryGroupByReg = queryGroupByReg & "tdw_owner.fsv_spend_category sc, "
queryGroupByReg = queryGroupByReg & "tdw_owner.restated_market m, "
queryGroupByReg = queryGroupByReg & "tdw_owner.month_dim md, "
queryGroupByReg = queryGroupByReg & "tdw_owner.restated_product p, "
queryGroupByReg = queryGroupByReg & "tdw_owner.acct_dim a, "
queryGroupByReg = queryGroupByReg & "tdw_owner.expense_type et, "
queryGroupByReg = queryGroupByReg & "tdw_owner.spend_request_dim s, "
queryGroupByReg = queryGroupByReg & "tdw_owner.operator_dim o, "
queryGroupByReg = queryGroupByReg & "tdw_owner.day_dim d1, "
queryGroupByReg = queryGroupByReg & "tdw_owner.day_dim d2, "
queryGroupByReg = queryGroupByReg & "tdw_owner.expense_attribute_dim ead, "
queryGroupByReg = queryGroupByReg & "tdw_owner.expense_payee_dim pay, "
queryGroupByReg = queryGroupByReg & "tdw_owner.group_detail gd, "
queryGroupByReg = queryGroupByReg & "tdw_owner.group_description groupdescr "
queryGroupByReg = queryGroupByReg & "WHERE mpbd.restated_mkt_prd_bus_div_key = epf.restated_mkt_prd_bus_div_key "
queryGroupByReg = queryGroupByReg & "AND epf.expense_type_key = sc.expense_type_key "
queryGroupByReg = queryGroupByReg & "AND epf.acct_key = sc.acct_key "
queryGroupByReg = queryGroupByReg & "AND epf.restated_market_key = m.restated_market_key "
queryGroupByReg = queryGroupByReg & "AND epf.month_key = md.month_key "
queryGroupByReg = queryGroupByReg & "AND epf.restated_product_key = p.restated_product_key "
queryGroupByReg = queryGroupByReg & "AND epf.acct_key = a.acct_key "
queryGroupByReg = queryGroupByReg & "AND epf.expense_type_key = et.expense_type_key "
queryGroupByReg = queryGroupByReg & "AND epf.spend_request_key = s.spend_request_key "
queryGroupByReg = queryGroupByReg & "AND epf.operator_key = o.operator_key "
queryGroupByReg = queryGroupByReg & "AND epf.report_period_begin_day_key = d1.day_key "
queryGroupByReg = queryGroupByReg & "AND epf.report_period_end_day_key = d2.day_key "
queryGroupByReg = queryGroupByReg & "AND epf.expense_attribute_key = ead.expense_attribute_key "
queryGroupByReg = queryGroupByReg & "AND epf.expense_payee_key = pay.expense_payee_key "
queryGroupByReg = queryGroupByReg & "AND gd.GROUP_CODE = groupdescr.GROUP_CODE "
queryGroupByReg = queryGroupByReg & "AND gd.group_field_c  =  m.DIVISION_CODE "
queryGroupByReg = queryGroupByReg & "AND sc.spend_base_seq <> 0 "
queryGroupByReg = queryGroupByReg & "AND sc.spend_subcategory_seq <> 0 "
queryGroupByReg = queryGroupByReg & "AND (mpbd.business_division_code IN ('F01', 'F03', 'F04', 'F08', 'F15')) "
queryGroupByReg = queryGroupByReg & "AND (m.selling_group_code IN ('119000', '125000', '610000', '800000', '423000')) "
queryGroupByReg = queryGroupByReg & "AND (md.year_descr IN (:p_year)) "
queryGroupByReg = queryGroupByReg & "and md.fiscal_month_number <= :p_Month "
queryGroupByReg = queryGroupByReg & "AND (mpbd.business_division_code IN (:p_businessdivision)) "
queryGroupByReg = queryGroupByReg & "AND (m.division_code IN (:p_salesdivision)) "
queryGroupByReg = queryGroupByReg & "AND (m.region_code IN (:p_salesregion)) "
queryGroupByReg = queryGroupByReg & "AND (m.primary_broker_code IN (:p_primarybroker)) "
queryGroupByReg = queryGroupByReg & "AND gd.GROUP_CODE in (:vp) "
queryGroupByReg = queryGroupByReg & "GROUP BY  "
queryGroupByReg = queryGroupByReg & "gd.GROUP_CODE, "
queryGroupByReg = queryGroupByReg & "groupdescr.GROUP_DESCR, "
queryGroupByReg = queryGroupByReg & "m.REGION_CODE, "
queryGroupByReg = queryGroupByReg & "m.REGION_DESCR, "
queryGroupByReg = queryGroupByReg & "mpbd.business_division_code, "
queryGroupByReg = queryGroupByReg & "'Total Customer', "
queryGroupByReg = queryGroupByReg & "sc.spend_base_descr, "
queryGroupByReg = queryGroupByReg & "sc.spend_base_seq, "
queryGroupByReg = queryGroupByReg & "sc.spend_subcategory_descr, "
queryGroupByReg = queryGroupByReg & "sc.spend_subcategory_seq, "
queryGroupByReg = queryGroupByReg & "md.year_descr, "
queryGroupByReg = queryGroupByReg & "md.month_descr, "
queryGroupByReg = queryGroupByReg & "md.FISCAL_MONTH_NUMBER, "
queryGroupByReg = queryGroupByReg & "mpbd.business_division_Descr "
queryGroupByReg = queryGroupByReg & " "
queryGroupByReg = queryGroupByReg & "--Begin Volume "
queryGroupByReg = queryGroupByReg & "UNION "
queryGroupByReg = queryGroupByReg & "SELECT   'zzz' AS businessunit, "
queryGroupByReg = queryGroupByReg & "0 AS monthexpense_amt, "
queryGroupByReg = queryGroupByReg & "CASE WHEN (ids_mf.FISCAL_MONTH_NUMBER = (:p_Month)) "
queryGroupByReg = queryGroupByReg & "     THEN SUM (  ids_mf.mf_pounds_shipped "
queryGroupByReg = queryGroupByReg & "               + ids_mf.mf_adjusted_pounds_shipped "
queryGroupByReg = queryGroupByReg & "                + ids_mf.ids_pounds_shipped) "
queryGroupByReg = queryGroupByReg & "END AS monthpounds, "
queryGroupByReg = queryGroupByReg & "CASE WHEN (ids_mf.FISCAL_MONTH_NUMBER = (:p_Month)) "
queryGroupByReg = queryGroupByReg & "     THEN SUM (  ids_mf.mf_gross_sales_amount "
queryGroupByReg = queryGroupByReg & "               - ids_mf.mf_allow_amount "
queryGroupByReg = queryGroupByReg & "               - ids_mf.mf_off_invoice_amount "
queryGroupByReg = queryGroupByReg & "               + ids_mf.mf_revenue_adjustment "
queryGroupByReg = queryGroupByReg & "               + ids_mf.ids_indirect_sales_amount) "
queryGroupByReg = queryGroupByReg & "END AS monthnetreceivables, "
queryGroupByReg = queryGroupByReg & "gd.GROUP_CODE, "
queryGroupByReg = queryGroupByReg & "groupdescr.GROUP_DESCR, "
queryGroupByReg = queryGroupByReg & "m.REGION_CODE, "
queryGroupByReg = queryGroupByReg & "m.REGION_DESCR, "
queryGroupByReg = queryGroupByReg & "mpbd.business_division_code, "
queryGroupByReg = queryGroupByReg & "INITCAP (mpbd.business_division_descr) AS businessdivisiondescr, "
queryGroupByReg = queryGroupByReg & "NULL AS spend_base_descr, "
queryGroupByReg = queryGroupByReg & "NULL AS spend_base_seq, "
queryGroupByReg = queryGroupByReg & "NULL AS spend_subcategory_descr, "
queryGroupByReg = queryGroupByReg & "NULL AS spend_subcategory_seq, "
queryGroupByReg = queryGroupByReg & "ids_mf.year_descr, "
queryGroupByReg = queryGroupByReg & "ids_mf.month_descr, "
queryGroupByReg = queryGroupByReg & "0 AS expense_amt, "
queryGroupByReg = queryGroupByReg & "SUM (  ids_mf.mf_pounds_shipped "
queryGroupByReg = queryGroupByReg & "       + ids_mf.mf_adjusted_pounds_shipped "
queryGroupByReg = queryGroupByReg & "       + ids_mf.ids_pounds_shipped "
queryGroupByReg = queryGroupByReg & "       ) AS total_pounds_shipped, "
queryGroupByReg = queryGroupByReg & "SUM (  ids_mf.mf_gross_sales_amount "
queryGroupByReg = queryGroupByReg & "       - ids_mf.mf_allow_amount "
queryGroupByReg = queryGroupByReg & "       - ids_mf.mf_off_invoice_amount "
queryGroupByReg = queryGroupByReg & "       + ids_mf.mf_revenue_adjustment "
queryGroupByReg = queryGroupByReg & "       + ids_mf.ids_indirect_sales_amount "
queryGroupByReg = queryGroupByReg & "       ) AS net_receivable_dollar "
queryGroupByReg = queryGroupByReg & "FROM (SELECT   mpbd1.business_division_code, "
queryGroupByReg = queryGroupByReg & "mpbd1.business_division_descr, "
queryGroupByReg = queryGroupByReg & "mpbd1.restated_market_key, "
queryGroupByReg = queryGroupByReg & "mpbd1.restated_product_key, "
queryGroupByReg = queryGroupByReg & "md1.year_descr, "
queryGroupByReg = queryGroupByReg & "md1.month_descr, "
queryGroupByReg = queryGroupByReg & "md1.FISCAL_MONTH_NUMBER, "
queryGroupByReg = queryGroupByReg & "SUM (mf.pounds_shipped) AS mf_pounds_shipped, "
queryGroupByReg = queryGroupByReg & "SUM (mf.adj_pounds_shipped) AS mf_adjusted_pounds_shipped, "
queryGroupByReg = queryGroupByReg & "SUM (mf.gross_sales_amount) AS mf_gross_sales_amount, "
queryGroupByReg = queryGroupByReg & "SUM (mf.allow_amount) AS mf_allow_amount, "
queryGroupByReg = queryGroupByReg & "SUM (mf.revenue_adjustment) AS mf_revenue_adjustment, "
queryGroupByReg = queryGroupByReg & "SUM (mf.off_invoice_amount) AS mf_off_invoice_amount, "
queryGroupByReg = queryGroupByReg & "0 AS ids_pounds_shipped, "
queryGroupByReg = queryGroupByReg & "0 AS ids_indirect_sales_amount "
queryGroupByReg = queryGroupByReg & "FROM tdw_owner.restated_mkt_prd_bus_div_dim mpbd1, "
queryGroupByReg = queryGroupByReg & "tdw_owner.restated_market m1, "
queryGroupByReg = queryGroupByReg & "tdw_owner.month_dim md1, "
queryGroupByReg = queryGroupByReg & "tdw_owner.restated_product p1, "
queryGroupByReg = queryGroupByReg & "tdw_owner.day_dim d1, "
queryGroupByReg = queryGroupByReg & "tdw_owner.margin_fact mf, "
queryGroupByReg = queryGroupByReg & "tdw_owner.group_detail gd, "
queryGroupByReg = queryGroupByReg & "tdw_owner.group_description groupdescr "
queryGroupByReg = queryGroupByReg & "WHERE mf.restated_market_key = m1.restated_market_key "
queryGroupByReg = queryGroupByReg & "AND mf.restated_product_key = p1.restated_product_key "
queryGroupByReg = queryGroupByReg & "AND mf.restated_market_key = mpbd1.restated_market_key "
queryGroupByReg = queryGroupByReg & "AND mf.restated_product_key = mpbd1.restated_product_key "
queryGroupByReg = queryGroupByReg & "AND mf.invoice_day_key = d1.day_key "
queryGroupByReg = queryGroupByReg & "AND d1.month_ending_date = md1.month_ending_date "
queryGroupByReg = queryGroupByReg & "AND gd.GROUP_CODE = groupdescr.GROUP_CODE "
queryGroupByReg = queryGroupByReg & "AND gd.group_field_c  =  m1.DIVISION_CODE "
queryGroupByReg = queryGroupByReg & "AND (mpbd1.business_division_code IN ('F01', 'F03', 'F04', 'F08', 'F15')) "
queryGroupByReg = queryGroupByReg & "AND (m1.selling_group_code IN ('119000', '125000', '610000', '800000', '423000')) "
queryGroupByReg = queryGroupByReg & "AND (md1.year_descr IN (:p_year)) "
queryGroupByReg = queryGroupByReg & "and md1.fiscal_month_number <= :p_Month "
queryGroupByReg = queryGroupByReg & "AND (mpbd1.business_division_code IN (:p_businessdivision)) "
queryGroupByReg = queryGroupByReg & "AND (m1.division_code IN (:p_salesdivision)) "
queryGroupByReg = queryGroupByReg & "AND (m1.region_code IN (:p_salesregion)) "
queryGroupByReg = queryGroupByReg & "AND (m1.primary_broker_code IN (:p_primarybroker)) "
queryGroupByReg = queryGroupByReg & "AND gd.GROUP_CODE in (:vp) "
queryGroupByReg = queryGroupByReg & "GROUP BY mpbd1.business_division_code, "
queryGroupByReg = queryGroupByReg & "mpbd1.business_division_descr, "
queryGroupByReg = queryGroupByReg & "mpbd1.restated_market_key, "
queryGroupByReg = queryGroupByReg & "mpbd1.restated_product_key, "
queryGroupByReg = queryGroupByReg & "md1.year_descr, "
queryGroupByReg = queryGroupByReg & "md1.month_descr, "
queryGroupByReg = queryGroupByReg & "md1.FISCAL_MONTH_NUMBER "
queryGroupByReg = queryGroupByReg & "UNION "
queryGroupByReg = queryGroupByReg & "SELECT   /*+ RULE */ "
queryGroupByReg = queryGroupByReg & "mpbd1.business_division_code, "
queryGroupByReg = queryGroupByReg & "mpbd1.business_division_descr, "
queryGroupByReg = queryGroupByReg & "mpbd1.restated_market_key, "
queryGroupByReg = queryGroupByReg & "mpbd1.restated_product_key, "
queryGroupByReg = queryGroupByReg & "md1.year_descr, "
queryGroupByReg = queryGroupByReg & "md1.month_descr, "
queryGroupByReg = queryGroupByReg & "md1.FISCAL_MONTH_NUMBER, "
queryGroupByReg = queryGroupByReg & "0 AS mf_pounds_shipped, "
queryGroupByReg = queryGroupByReg & "0 AS mf_adjusted_pounds_shipped, "
queryGroupByReg = queryGroupByReg & "0 AS mf_gross_sales_amount, "
queryGroupByReg = queryGroupByReg & "0 AS mf_allow_amount, "
queryGroupByReg = queryGroupByReg & "0 AS mf_revenue_adjustment, "
queryGroupByReg = queryGroupByReg & "0 AS mf_off_invoice_amount, "
queryGroupByReg = queryGroupByReg & "SUM (ids.pounds_shipped) AS ids_pounds_shipped, "
queryGroupByReg = queryGroupByReg & "SUM (ids.indirect_sales_amount)AS ids_indirect_sales_amount "
queryGroupByReg = queryGroupByReg & "FROM tdw_owner.restated_mkt_prd_bus_div_dim mpbd1, "
queryGroupByReg = queryGroupByReg & "tdw_owner.restated_market m1, "
queryGroupByReg = queryGroupByReg & "tdw_owner.month_dim md1, "
queryGroupByReg = queryGroupByReg & "tdw_owner.restated_product p1, "
queryGroupByReg = queryGroupByReg & "tdw_owner.indirect_sales ids, "
queryGroupByReg = queryGroupByReg & "tdw_owner.week_dim w1, "
queryGroupByReg = queryGroupByReg & "tdw_owner.group_detail gd, "
queryGroupByReg = queryGroupByReg & "tdw_owner.group_description groupdescr "
queryGroupByReg = queryGroupByReg & "WHERE ids.restated_market_key = m1.restated_market_key "
queryGroupByReg = queryGroupByReg & "AND ids.restated_product_key = p1.restated_product_key "
queryGroupByReg = queryGroupByReg & "AND ids.restated_market_key = mpbd1.restated_market_key "
queryGroupByReg = queryGroupByReg & "AND ids.restated_product_key = mpbd1.restated_product_key "
queryGroupByReg = queryGroupByReg & "AND ids.week_key = w1.week_key "
queryGroupByReg = queryGroupByReg & "AND w1.month_ending_date = md1.month_ending_date "
queryGroupByReg = queryGroupByReg & "AND gd.GROUP_CODE = groupdescr.GROUP_CODE "
queryGroupByReg = queryGroupByReg & "AND gd.group_field_c  =  m1.DIVISION_CODE "
queryGroupByReg = queryGroupByReg & "AND (mpbd1.business_division_code IN ('F01', 'F03', 'F04', 'F08', 'F15')) "
queryGroupByReg = queryGroupByReg & "AND (m1.selling_group_code IN ('119000', '125000', '610000', '800000', '423000')) "
queryGroupByReg = queryGroupByReg & "AND (md1.year_descr IN (:p_year)) "
queryGroupByReg = queryGroupByReg & "and md1.fiscal_month_number <= :p_Month "
queryGroupByReg = queryGroupByReg & "AND (mpbd1.business_division_code IN (:p_businessdivision)) "
queryGroupByReg = queryGroupByReg & "AND (m1.division_code IN (:p_salesdivision)) "
queryGroupByReg = queryGroupByReg & "AND (m1.region_code IN (:p_salesregion)) "
queryGroupByReg = queryGroupByReg & "AND (m1.primary_broker_code IN (:p_primarybroker)) "
queryGroupByReg = queryGroupByReg & "AND gd.GROUP_CODE in (:vp) "
queryGroupByReg = queryGroupByReg & "GROUP BY mpbd1.business_division_code, "
queryGroupByReg = queryGroupByReg & "mpbd1.business_division_descr, "
queryGroupByReg = queryGroupByReg & "mpbd1.restated_market_key, "
queryGroupByReg = queryGroupByReg & "mpbd1.restated_product_key, "
queryGroupByReg = queryGroupByReg & "md1.year_descr, "
queryGroupByReg = queryGroupByReg & "md1.month_descr, "
queryGroupByReg = queryGroupByReg & "md1.FISCAL_MONTH_NUMBER "
queryGroupByReg = queryGroupByReg & ")--end sub queryGroupByReg "
queryGroupByReg = queryGroupByReg & "   ids_mf, "
queryGroupByReg = queryGroupByReg & "tdw_owner.restated_mkt_prd_bus_div_dim mpbd, "
queryGroupByReg = queryGroupByReg & "tdw_owner.restated_market m, "
queryGroupByReg = queryGroupByReg & "tdw_owner.restated_product p, "
queryGroupByReg = queryGroupByReg & "tdw_owner.group_detail gd, "
queryGroupByReg = queryGroupByReg & "tdw_owner.group_description groupdescr "
queryGroupByReg = queryGroupByReg & "WHERE ids_mf.restated_market_key = mpbd.restated_market_key "
queryGroupByReg = queryGroupByReg & "AND ids_mf.restated_product_key = mpbd.restated_product_key "
queryGroupByReg = queryGroupByReg & "AND ids_mf.restated_market_key = m.restated_market_key "
queryGroupByReg = queryGroupByReg & "AND ids_mf.restated_product_key = p.restated_product_key "
queryGroupByReg = queryGroupByReg & "AND gd.GROUP_CODE = groupdescr.GROUP_CODE "
queryGroupByReg = queryGroupByReg & "AND gd.group_field_c  =  m.DIVISION_CODE "
queryGroupByReg = queryGroupByReg & "AND (mpbd.business_division_code IN ('F01', 'F03', 'F04', 'F08', 'F15')) "
queryGroupByReg = queryGroupByReg & "AND (m.selling_group_code IN ('119000', '125000', '610000', '800000', '423000')) "
queryGroupByReg = queryGroupByReg & "AND (ids_mf.year_descr IN (:p_year)) "
queryGroupByReg = queryGroupByReg & "and ids_mf.fiscal_month_number <= :p_Month "
queryGroupByReg = queryGroupByReg & "AND (mpbd.business_division_code IN (:p_businessdivision)) "
queryGroupByReg = queryGroupByReg & "AND (m.division_code IN (:p_salesdivision)) "
queryGroupByReg = queryGroupByReg & "AND (m.region_code IN (:p_salesregion)) "
queryGroupByReg = queryGroupByReg & "AND (m.primary_broker_code IN (:p_primarybroker)) "
queryGroupByReg = queryGroupByReg & "AND gd.GROUP_CODE in (:vp) "
queryGroupByReg = queryGroupByReg & "GROUP BY  "
queryGroupByReg = queryGroupByReg & "gd.GROUP_CODE, "
queryGroupByReg = queryGroupByReg & "groupdescr.GROUP_DESCR, "
queryGroupByReg = queryGroupByReg & "m.REGION_CODE, "
queryGroupByReg = queryGroupByReg & "m.REGION_DESCR, "
queryGroupByReg = queryGroupByReg & "'zzz', "
queryGroupByReg = queryGroupByReg & "mpbd.business_division_code, "
queryGroupByReg = queryGroupByReg & "INITCAP (mpbd.business_division_descr), "
queryGroupByReg = queryGroupByReg & "ids_mf.year_descr, "
queryGroupByReg = queryGroupByReg & "ids_mf.month_descr, "
queryGroupByReg = queryGroupByReg & "ids_mf.FISCAL_MONTH_NUMBER, "
queryGroupByReg = queryGroupByReg & "mpbd.business_division_Descr "
queryGroupByReg = queryGroupByReg & "--Begin Volume 'Total Value Added' "
queryGroupByReg = queryGroupByReg & "UNION "
queryGroupByReg = queryGroupByReg & "SELECT    "
queryGroupByReg = queryGroupByReg & "'zzz' AS businessunit, "
queryGroupByReg = queryGroupByReg & "0 AS monthexpense_amt, "
queryGroupByReg = queryGroupByReg & "CASE WHEN (ids_mf.FISCAL_MONTH_NUMBER = (:p_Month)) "
queryGroupByReg = queryGroupByReg & "     THEN SUM (  ids_mf.mf_pounds_shipped "
queryGroupByReg = queryGroupByReg & "               + ids_mf.mf_adjusted_pounds_shipped "
queryGroupByReg = queryGroupByReg & "               + ids_mf.ids_pounds_shipped) "
queryGroupByReg = queryGroupByReg & "END AS monthpounds, "
queryGroupByReg = queryGroupByReg & "CASE WHEN (ids_mf.FISCAL_MONTH_NUMBER = (:p_Month)) "
queryGroupByReg = queryGroupByReg & "     THEN SUM (  ids_mf.mf_gross_sales_amount "
queryGroupByReg = queryGroupByReg & "               - ids_mf.mf_allow_amount "
queryGroupByReg = queryGroupByReg & "               - ids_mf.mf_off_invoice_amount "
queryGroupByReg = queryGroupByReg & "                 + ids_mf.mf_revenue_adjustment "
queryGroupByReg = queryGroupByReg & "               + ids_mf.ids_indirect_sales_amount) "
queryGroupByReg = queryGroupByReg & "END AS monthnetreceivables, "
queryGroupByReg = queryGroupByReg & "gd.GROUP_CODE, "
queryGroupByReg = queryGroupByReg & "groupdescr.GROUP_DESCR, "
queryGroupByReg = queryGroupByReg & "m.REGION_CODE, "
queryGroupByReg = queryGroupByReg & "m.REGION_DESCR, "
queryGroupByReg = queryGroupByReg & "mpbd.business_division_code, "
queryGroupByReg = queryGroupByReg & "'Total Value Added' AS businessdivisiondescr, "
queryGroupByReg = queryGroupByReg & "NULL AS spend_base_descr, "
queryGroupByReg = queryGroupByReg & "NULL AS spend_base_seq, "
queryGroupByReg = queryGroupByReg & "NULL AS spend_subcategory_descr, "
queryGroupByReg = queryGroupByReg & "NULL AS spend_subcategory_seq, "
queryGroupByReg = queryGroupByReg & "ids_mf.year_descr, "
queryGroupByReg = queryGroupByReg & "ids_mf.month_descr, "
queryGroupByReg = queryGroupByReg & "0 AS expense_amt, "
queryGroupByReg = queryGroupByReg & "SUM (  ids_mf.mf_pounds_shipped "
queryGroupByReg = queryGroupByReg & "        + ids_mf.mf_adjusted_pounds_shipped "
queryGroupByReg = queryGroupByReg & "        + ids_mf.ids_pounds_shipped "
queryGroupByReg = queryGroupByReg & "        ) AS total_pounds_shipped, "
queryGroupByReg = queryGroupByReg & "SUM (  ids_mf.mf_gross_sales_amount "
queryGroupByReg = queryGroupByReg & "       - ids_mf.mf_allow_amount "
queryGroupByReg = queryGroupByReg & "       - ids_mf.mf_off_invoice_amount "
queryGroupByReg = queryGroupByReg & "       + ids_mf.mf_revenue_adjustment "
queryGroupByReg = queryGroupByReg & "       + ids_mf.ids_indirect_sales_amount "
queryGroupByReg = queryGroupByReg & "       ) AS net_receivable_dollar "
queryGroupByReg = queryGroupByReg & "FROM ( "
queryGroupByReg = queryGroupByReg & "--Begin sub queryGroupByReg "
queryGroupByReg = queryGroupByReg & "SELECT   mpbd1.business_division_code, "
queryGroupByReg = queryGroupByReg & "mpbd1.business_division_descr, "
queryGroupByReg = queryGroupByReg & "mpbd1.restated_market_key, "
queryGroupByReg = queryGroupByReg & "mpbd1.restated_product_key, "
queryGroupByReg = queryGroupByReg & "md1.year_descr, "
queryGroupByReg = queryGroupByReg & "md1.month_descr, "
queryGroupByReg = queryGroupByReg & "md1.FISCAL_MONTH_NUMBER, "
queryGroupByReg = queryGroupByReg & "SUM (mf.pounds_shipped) AS mf_pounds_shipped, "
queryGroupByReg = queryGroupByReg & "SUM (mf.adj_pounds_shipped) AS mf_adjusted_pounds_shipped, "
queryGroupByReg = queryGroupByReg & "SUM (mf.gross_sales_amount) AS mf_gross_sales_amount, "
queryGroupByReg = queryGroupByReg & "SUM (mf.allow_amount) AS mf_allow_amount, "
queryGroupByReg = queryGroupByReg & "SUM (mf.revenue_adjustment) AS mf_revenue_adjustment, "
queryGroupByReg = queryGroupByReg & "SUM (mf.off_invoice_amount) AS mf_off_invoice_amount, "
queryGroupByReg = queryGroupByReg & "0 AS ids_pounds_shipped, "
queryGroupByReg = queryGroupByReg & "0 AS ids_indirect_sales_amount "
queryGroupByReg = queryGroupByReg & "FROM tdw_owner.restated_mkt_prd_bus_div_dim mpbd1, "
queryGroupByReg = queryGroupByReg & "tdw_owner.restated_market m1, "
queryGroupByReg = queryGroupByReg & "tdw_owner.month_dim md1, "
queryGroupByReg = queryGroupByReg & "tdw_owner.restated_product p1, "
queryGroupByReg = queryGroupByReg & "tdw_owner.day_dim d1, "
queryGroupByReg = queryGroupByReg & "tdw_owner.margin_fact mf, "
queryGroupByReg = queryGroupByReg & "tdw_owner.group_detail gd, "
queryGroupByReg = queryGroupByReg & "tdw_owner.group_description groupdescr "
queryGroupByReg = queryGroupByReg & "WHERE mf.restated_market_key = m1.restated_market_key "
queryGroupByReg = queryGroupByReg & "AND mf.restated_product_key = p1.restated_product_key "
queryGroupByReg = queryGroupByReg & "AND mf.restated_market_key = mpbd1.restated_market_key "
queryGroupByReg = queryGroupByReg & "AND mf.restated_product_key = mpbd1.restated_product_key "
queryGroupByReg = queryGroupByReg & "AND mf.invoice_day_key = d1.day_key "
queryGroupByReg = queryGroupByReg & "AND d1.month_ending_date = md1.month_ending_date "
queryGroupByReg = queryGroupByReg & "AND gd.GROUP_CODE = groupdescr.GROUP_CODE "
queryGroupByReg = queryGroupByReg & "AND gd.group_field_c  =  m1.DIVISION_CODE "
queryGroupByReg = queryGroupByReg & "AND (mpbd1.business_division_code IN ('F01', 'F08', 'F15')) "
queryGroupByReg = queryGroupByReg & "AND (m1.selling_group_code IN ('119000', '125000', '610000', '800000', '423000')) "
queryGroupByReg = queryGroupByReg & "AND (md1.year_descr IN (:p_year)) "
queryGroupByReg = queryGroupByReg & "and md1.fiscal_month_number <= :p_Month "
queryGroupByReg = queryGroupByReg & "AND (mpbd1.business_division_code IN (:p_businessdivision)) "
queryGroupByReg = queryGroupByReg & "AND (m1.division_code IN (:p_salesdivision)) "
queryGroupByReg = queryGroupByReg & "AND (m1.region_code IN (:p_salesregion)) "
queryGroupByReg = queryGroupByReg & "AND (m1.primary_broker_code IN (:p_primarybroker)) "
queryGroupByReg = queryGroupByReg & "AND gd.GROUP_CODE in (:vp) "
queryGroupByReg = queryGroupByReg & "GROUP BY mpbd1.business_division_code, "
queryGroupByReg = queryGroupByReg & "mpbd1.business_division_descr, "
queryGroupByReg = queryGroupByReg & "mpbd1.restated_market_key, "
queryGroupByReg = queryGroupByReg & "mpbd1.restated_product_key, "
queryGroupByReg = queryGroupByReg & "md1.year_descr, "
queryGroupByReg = queryGroupByReg & "md1.month_descr, "
queryGroupByReg = queryGroupByReg & "md1.FISCAL_MONTH_NUMBER "
queryGroupByReg = queryGroupByReg & "UNION "
queryGroupByReg = queryGroupByReg & "SELECT   /*+ RULE */ "
queryGroupByReg = queryGroupByReg & "mpbd1.business_division_code, "
queryGroupByReg = queryGroupByReg & "mpbd1.business_division_descr, "
queryGroupByReg = queryGroupByReg & "mpbd1.restated_market_key, "
queryGroupByReg = queryGroupByReg & "mpbd1.restated_product_key, "
queryGroupByReg = queryGroupByReg & "md1.year_descr, "
queryGroupByReg = queryGroupByReg & "md1.month_descr, "
queryGroupByReg = queryGroupByReg & "md1.FISCAL_MONTH_NUMBER, "
queryGroupByReg = queryGroupByReg & "0 AS mf_pounds_shipped, "
queryGroupByReg = queryGroupByReg & "0 AS mf_adjusted_pounds_shipped, "
queryGroupByReg = queryGroupByReg & "0 AS mf_gross_sales_amount, "
queryGroupByReg = queryGroupByReg & "0 AS mf_allow_amount, "
queryGroupByReg = queryGroupByReg & "0 AS mf_revenue_adjustment, "
queryGroupByReg = queryGroupByReg & "0 AS mf_off_invoice_amount, "
queryGroupByReg = queryGroupByReg & "SUM (ids.pounds_shipped) AS ids_pounds_shipped, "
queryGroupByReg = queryGroupByReg & "SUM (ids.indirect_sales_amount)AS ids_indirect_sales_amount "
queryGroupByReg = queryGroupByReg & "FROM tdw_owner.restated_mkt_prd_bus_div_dim mpbd1, "
queryGroupByReg = queryGroupByReg & "tdw_owner.restated_market m1, "
queryGroupByReg = queryGroupByReg & "tdw_owner.month_dim md1, "
queryGroupByReg = queryGroupByReg & "tdw_owner.restated_product p1, "
queryGroupByReg = queryGroupByReg & "tdw_owner.indirect_sales ids, "
queryGroupByReg = queryGroupByReg & "tdw_owner.week_dim w1, "
queryGroupByReg = queryGroupByReg & "tdw_owner.group_detail gd, "
queryGroupByReg = queryGroupByReg & "tdw_owner.group_description groupdescr "
queryGroupByReg = queryGroupByReg & "WHERE ids.restated_market_key = m1.restated_market_key "
queryGroupByReg = queryGroupByReg & "AND ids.restated_product_key = p1.restated_product_key "
queryGroupByReg = queryGroupByReg & "AND ids.restated_market_key = mpbd1.restated_market_key "
queryGroupByReg = queryGroupByReg & "AND ids.restated_product_key = mpbd1.restated_product_key "
queryGroupByReg = queryGroupByReg & "AND ids.week_key = w1.week_key "
queryGroupByReg = queryGroupByReg & "AND w1.month_ending_date = md1.month_ending_date "
queryGroupByReg = queryGroupByReg & "AND gd.GROUP_CODE = groupdescr.GROUP_CODE "
queryGroupByReg = queryGroupByReg & "AND gd.group_field_c  =  m1.DIVISION_CODE "
queryGroupByReg = queryGroupByReg & "AND (mpbd1.business_division_code IN ('F01', 'F08', 'F15')) "
queryGroupByReg = queryGroupByReg & "AND (m1.selling_group_code IN ('119000', '125000', '610000', '800000', '423000')) "
queryGroupByReg = queryGroupByReg & "AND (md1.year_descr IN (:p_year)) "
queryGroupByReg = queryGroupByReg & "and md1.fiscal_month_number <= :p_Month "
queryGroupByReg = queryGroupByReg & "AND (mpbd1.business_division_code IN (:p_businessdivision)) "
queryGroupByReg = queryGroupByReg & "AND (m1.division_code IN (:p_salesdivision)) "
queryGroupByReg = queryGroupByReg & "AND (m1.region_code IN (:p_salesregion)) "
queryGroupByReg = queryGroupByReg & "AND (m1.primary_broker_code IN (:p_primarybroker)) "
queryGroupByReg = queryGroupByReg & "AND gd.GROUP_CODE in (:vp) "
queryGroupByReg = queryGroupByReg & "GROUP BY mpbd1.business_division_code, "
queryGroupByReg = queryGroupByReg & "mpbd1.business_division_descr, "
queryGroupByReg = queryGroupByReg & "mpbd1.restated_market_key, "
queryGroupByReg = queryGroupByReg & "mpbd1.restated_product_key, "
queryGroupByReg = queryGroupByReg & "md1.year_descr, "
queryGroupByReg = queryGroupByReg & "md1.month_descr, "
queryGroupByReg = queryGroupByReg & "md1.FISCAL_MONTH_NUMBER "
queryGroupByReg = queryGroupByReg & ") --end sub queryGroupByReg "
queryGroupByReg = queryGroupByReg & "   ids_mf, "
queryGroupByReg = queryGroupByReg & "tdw_owner.restated_mkt_prd_bus_div_dim mpbd, "
queryGroupByReg = queryGroupByReg & "tdw_owner.restated_market m, "
queryGroupByReg = queryGroupByReg & "tdw_owner.restated_product p, "
queryGroupByReg = queryGroupByReg & "tdw_owner.group_detail gd, "
queryGroupByReg = queryGroupByReg & "tdw_owner.group_description groupdescr "
queryGroupByReg = queryGroupByReg & "WHERE ids_mf.restated_market_key = mpbd.restated_market_key "
queryGroupByReg = queryGroupByReg & "AND ids_mf.restated_product_key = mpbd.restated_product_key "
queryGroupByReg = queryGroupByReg & "AND ids_mf.restated_market_key = m.restated_market_key "
queryGroupByReg = queryGroupByReg & "AND ids_mf.restated_product_key = p.restated_product_key "
queryGroupByReg = queryGroupByReg & "AND gd.GROUP_CODE = groupdescr.GROUP_CODE "
queryGroupByReg = queryGroupByReg & "AND gd.group_field_c  =  m.DIVISION_CODE "
queryGroupByReg = queryGroupByReg & "AND (mpbd.business_division_code IN ('F01', 'F08', 'F15')) "
queryGroupByReg = queryGroupByReg & "AND (m.selling_group_code IN ('119000', '125000', '610000', '800000', '423000')) "
queryGroupByReg = queryGroupByReg & "AND (ids_mf.year_descr IN (:p_year)) "
queryGroupByReg = queryGroupByReg & "and ids_mf.fiscal_month_number <= :p_Month "
queryGroupByReg = queryGroupByReg & "AND (mpbd.business_division_code IN (:p_businessdivision)) "
queryGroupByReg = queryGroupByReg & "AND (m.division_code IN (:p_salesdivision)) "
queryGroupByReg = queryGroupByReg & "AND (m.region_code IN (:p_salesregion)) "
queryGroupByReg = queryGroupByReg & "AND (m.primary_broker_code IN (:p_primarybroker)) "
queryGroupByReg = queryGroupByReg & "AND gd.GROUP_CODE in (:vp) "
queryGroupByReg = queryGroupByReg & "GROUP BY  "
queryGroupByReg = queryGroupByReg & "gd.GROUP_CODE, "
queryGroupByReg = queryGroupByReg & "groupdescr.GROUP_DESCR, "
queryGroupByReg = queryGroupByReg & "m.REGION_CODE, "
queryGroupByReg = queryGroupByReg & "m.REGION_DESCR, "
queryGroupByReg = queryGroupByReg & "'zzz', "
queryGroupByReg = queryGroupByReg & "mpbd.business_division_code, "
queryGroupByReg = queryGroupByReg & "'Total Value Added', "
queryGroupByReg = queryGroupByReg & "ids_mf.year_descr, "
queryGroupByReg = queryGroupByReg & "ids_mf.month_descr, "
queryGroupByReg = queryGroupByReg & "ids_mf.FISCAL_MONTH_NUMBER, "
queryGroupByReg = queryGroupByReg & "mpbd.business_division_Descr "
queryGroupByReg = queryGroupByReg & "---Begin Volume Total Market/CVP "
queryGroupByReg = queryGroupByReg & "UNION "
queryGroupByReg = queryGroupByReg & "SELECT    "
queryGroupByReg = queryGroupByReg & "'zzz' AS businessunit, "
queryGroupByReg = queryGroupByReg & "0 AS monthexpense_amt, "
queryGroupByReg = queryGroupByReg & "CASE WHEN (ids_mf.FISCAL_MONTH_NUMBER = (:p_Month)) "
queryGroupByReg = queryGroupByReg & "     THEN SUM (  ids_mf.mf_pounds_shipped "
queryGroupByReg = queryGroupByReg & "               + ids_mf.mf_adjusted_pounds_shipped "
queryGroupByReg = queryGroupByReg & "               + ids_mf.ids_pounds_shipped) "
queryGroupByReg = queryGroupByReg & "END AS monthpounds, "
queryGroupByReg = queryGroupByReg & "CASE WHEN (ids_mf.FISCAL_MONTH_NUMBER = (:p_Month)) "
queryGroupByReg = queryGroupByReg & "     THEN SUM (  ids_mf.mf_gross_sales_amount "
queryGroupByReg = queryGroupByReg & "                - ids_mf.mf_allow_amount "
queryGroupByReg = queryGroupByReg & "                - ids_mf.mf_off_invoice_amount "
queryGroupByReg = queryGroupByReg & "                + ids_mf.mf_revenue_adjustment "
queryGroupByReg = queryGroupByReg & "                + ids_mf.ids_indirect_sales_amount) "
queryGroupByReg = queryGroupByReg & "END AS monthnetreceivables, "
queryGroupByReg = queryGroupByReg & "gd.GROUP_CODE, "
queryGroupByReg = queryGroupByReg & "groupdescr.GROUP_DESCR, "
queryGroupByReg = queryGroupByReg & "m.REGION_CODE, "
queryGroupByReg = queryGroupByReg & "m.REGION_DESCR, "
queryGroupByReg = queryGroupByReg & "mpbd.business_division_code, "
queryGroupByReg = queryGroupByReg & "'Total Market/CVP' AS businessdivisiondescr, "
queryGroupByReg = queryGroupByReg & "NULL AS spend_base_descr, "
queryGroupByReg = queryGroupByReg & "NULL AS spend_base_seq, "
queryGroupByReg = queryGroupByReg & "NULL AS spend_subcategory_descr, "
queryGroupByReg = queryGroupByReg & "NULL AS spend_subcategory_seq, "
queryGroupByReg = queryGroupByReg & "ids_mf.year_descr, "
queryGroupByReg = queryGroupByReg & "ids_mf.month_descr, "
queryGroupByReg = queryGroupByReg & "0 AS expense_amt, "
queryGroupByReg = queryGroupByReg & "SUM (  ids_mf.mf_pounds_shipped "
queryGroupByReg = queryGroupByReg & "        + ids_mf.mf_adjusted_pounds_shipped "
queryGroupByReg = queryGroupByReg & "        + ids_mf.ids_pounds_shipped "
queryGroupByReg = queryGroupByReg & "        ) AS total_pounds_shipped, "
queryGroupByReg = queryGroupByReg & "SUM (  ids_mf.mf_gross_sales_amount "
queryGroupByReg = queryGroupByReg & "        - ids_mf.mf_allow_amount "
queryGroupByReg = queryGroupByReg & "        - ids_mf.mf_off_invoice_amount "
queryGroupByReg = queryGroupByReg & "        + ids_mf.mf_revenue_adjustment "
queryGroupByReg = queryGroupByReg & "        + ids_mf.ids_indirect_sales_amount "
queryGroupByReg = queryGroupByReg & ") AS net_receivable_dollar "
queryGroupByReg = queryGroupByReg & "FROM ( "
queryGroupByReg = queryGroupByReg & "---Begin sub queryGroupByReg "
queryGroupByReg = queryGroupByReg & "SELECT   mpbd1.business_division_code, "
queryGroupByReg = queryGroupByReg & "mpbd1.business_division_descr, "
queryGroupByReg = queryGroupByReg & "mpbd1.restated_market_key, "
queryGroupByReg = queryGroupByReg & "mpbd1.restated_product_key, "
queryGroupByReg = queryGroupByReg & "md1.year_descr, "
queryGroupByReg = queryGroupByReg & "md1.month_descr, "
queryGroupByReg = queryGroupByReg & "md1.FISCAL_MONTH_NUMBER, "
queryGroupByReg = queryGroupByReg & "SUM (mf.pounds_shipped) AS mf_pounds_shipped, "
queryGroupByReg = queryGroupByReg & "SUM (mf.adj_pounds_shipped) AS mf_adjusted_pounds_shipped, "
queryGroupByReg = queryGroupByReg & "SUM (mf.gross_sales_amount) AS mf_gross_sales_amount, "
queryGroupByReg = queryGroupByReg & "SUM (mf.allow_amount) AS mf_allow_amount, "
queryGroupByReg = queryGroupByReg & "SUM (mf.revenue_adjustment) AS mf_revenue_adjustment, "
queryGroupByReg = queryGroupByReg & "SUM (mf.off_invoice_amount) AS mf_off_invoice_amount, "
queryGroupByReg = queryGroupByReg & "0 AS ids_pounds_shipped, "
queryGroupByReg = queryGroupByReg & "0 AS ids_indirect_sales_amount "
queryGroupByReg = queryGroupByReg & "FROM tdw_owner.restated_mkt_prd_bus_div_dim mpbd1, "
queryGroupByReg = queryGroupByReg & "tdw_owner.restated_market m1, "
queryGroupByReg = queryGroupByReg & "tdw_owner.month_dim md1, "
queryGroupByReg = queryGroupByReg & "tdw_owner.restated_product p1, "
queryGroupByReg = queryGroupByReg & "tdw_owner.day_dim d1, "
queryGroupByReg = queryGroupByReg & "tdw_owner.margin_fact mf, "
queryGroupByReg = queryGroupByReg & "tdw_owner.group_detail gd, "
queryGroupByReg = queryGroupByReg & "tdw_owner.group_description groupdescr "
queryGroupByReg = queryGroupByReg & "WHERE mf.restated_market_key = m1.restated_market_key "
queryGroupByReg = queryGroupByReg & "AND mf.restated_product_key = p1.restated_product_key "
queryGroupByReg = queryGroupByReg & "AND mf.restated_market_key = mpbd1.restated_market_key "
queryGroupByReg = queryGroupByReg & "AND mf.restated_product_key = mpbd1.restated_product_key "
queryGroupByReg = queryGroupByReg & "AND mf.invoice_day_key = d1.day_key "
queryGroupByReg = queryGroupByReg & "AND d1.month_ending_date = md1.month_ending_date "
queryGroupByReg = queryGroupByReg & "AND gd.GROUP_CODE = groupdescr.GROUP_CODE "
queryGroupByReg = queryGroupByReg & "AND gd.group_field_c  =  m1.DIVISION_CODE "
queryGroupByReg = queryGroupByReg & "AND (mpbd1.business_division_code IN ('F03', 'F04')) "
queryGroupByReg = queryGroupByReg & "AND (m1.selling_group_code IN ('119000', '125000', '610000', '800000', '423000')) "
queryGroupByReg = queryGroupByReg & "AND (md1.year_descr IN (:p_year)) "
queryGroupByReg = queryGroupByReg & "and md1.fiscal_month_number <= :p_Month "
queryGroupByReg = queryGroupByReg & "AND (mpbd1.business_division_code IN (:p_businessdivision)) "
queryGroupByReg = queryGroupByReg & "AND (m1.division_code IN (:p_salesdivision)) "
queryGroupByReg = queryGroupByReg & "AND (m1.region_code IN (:p_salesregion)) "
queryGroupByReg = queryGroupByReg & "AND (m1.primary_broker_code IN (:p_primarybroker)) "
queryGroupByReg = queryGroupByReg & "AND gd.GROUP_CODE in (:vp) "
queryGroupByReg = queryGroupByReg & "GROUP BY mpbd1.business_division_code, "
queryGroupByReg = queryGroupByReg & "mpbd1.business_division_descr, "
queryGroupByReg = queryGroupByReg & "mpbd1.restated_market_key, "
queryGroupByReg = queryGroupByReg & "mpbd1.restated_product_key, "
queryGroupByReg = queryGroupByReg & "md1.year_descr, "
queryGroupByReg = queryGroupByReg & "md1.month_descr, "
queryGroupByReg = queryGroupByReg & "md1.FISCAL_MONTH_NUMBER "
queryGroupByReg = queryGroupByReg & "UNION "
queryGroupByReg = queryGroupByReg & "SELECT   /*+ RULE */ "
queryGroupByReg = queryGroupByReg & "mpbd1.business_division_code, "
queryGroupByReg = queryGroupByReg & "mpbd1.business_division_descr, "
queryGroupByReg = queryGroupByReg & "mpbd1.restated_market_key, "
queryGroupByReg = queryGroupByReg & "mpbd1.restated_product_key, "
queryGroupByReg = queryGroupByReg & "md1.year_descr, "
queryGroupByReg = queryGroupByReg & "md1.month_descr, "
queryGroupByReg = queryGroupByReg & "md1.FISCAL_MONTH_NUMBER, "
queryGroupByReg = queryGroupByReg & "0 AS mf_pounds_shipped, "
queryGroupByReg = queryGroupByReg & "0 AS mf_adjusted_pounds_shipped, "
queryGroupByReg = queryGroupByReg & "0 AS mf_gross_sales_amount, "
queryGroupByReg = queryGroupByReg & "0 AS mf_allow_amount, "
queryGroupByReg = queryGroupByReg & "0 AS mf_revenue_adjustment, "
queryGroupByReg = queryGroupByReg & "0 AS mf_off_invoice_amount, "
queryGroupByReg = queryGroupByReg & "SUM (ids.pounds_shipped) AS ids_pounds_shipped, "
queryGroupByReg = queryGroupByReg & "SUM (ids.indirect_sales_amount) "
queryGroupByReg = queryGroupByReg & "                 AS ids_indirect_sales_amount "
queryGroupByReg = queryGroupByReg & "FROM tdw_owner.restated_mkt_prd_bus_div_dim mpbd1, "
queryGroupByReg = queryGroupByReg & "tdw_owner.restated_market m1, "
queryGroupByReg = queryGroupByReg & "tdw_owner.month_dim md1, "
queryGroupByReg = queryGroupByReg & "tdw_owner.restated_product p1, "
queryGroupByReg = queryGroupByReg & "tdw_owner.indirect_sales ids, "
queryGroupByReg = queryGroupByReg & "tdw_owner.week_dim w1, "
queryGroupByReg = queryGroupByReg & "tdw_owner.group_detail gd, "
queryGroupByReg = queryGroupByReg & "tdw_owner.group_description groupdescr "
queryGroupByReg = queryGroupByReg & "WHERE ids.restated_market_key = m1.restated_market_key "
queryGroupByReg = queryGroupByReg & "AND ids.restated_product_key = p1.restated_product_key "
queryGroupByReg = queryGroupByReg & "AND ids.restated_market_key = mpbd1.restated_market_key "
queryGroupByReg = queryGroupByReg & "AND ids.restated_product_key = mpbd1.restated_product_key "
queryGroupByReg = queryGroupByReg & "AND ids.week_key = w1.week_key "
queryGroupByReg = queryGroupByReg & "AND w1.month_ending_date = md1.month_ending_date "
queryGroupByReg = queryGroupByReg & "AND gd.GROUP_CODE = groupdescr.GROUP_CODE "
queryGroupByReg = queryGroupByReg & "AND gd.group_field_c  =  m1.DIVISION_CODE "
queryGroupByReg = queryGroupByReg & "AND (mpbd1.business_division_code IN ('F03', 'F04')) "
queryGroupByReg = queryGroupByReg & "AND (m1.selling_group_code IN ('119000', '125000', '610000', '800000', '423000')) "
queryGroupByReg = queryGroupByReg & "AND (md1.year_descr IN (:p_year)) "
queryGroupByReg = queryGroupByReg & "and md1.fiscal_month_number <= :p_Month "
queryGroupByReg = queryGroupByReg & "AND (mpbd1.business_division_code IN (:p_businessdivision)) "
queryGroupByReg = queryGroupByReg & "AND (m1.division_code IN (:p_salesdivision)) "
queryGroupByReg = queryGroupByReg & "AND (m1.region_code IN (:p_salesregion)) "
queryGroupByReg = queryGroupByReg & "AND (m1.primary_broker_code IN (:p_primarybroker)) "
queryGroupByReg = queryGroupByReg & "AND gd.GROUP_CODE in (:vp) "
queryGroupByReg = queryGroupByReg & "GROUP BY mpbd1.business_division_code, "
queryGroupByReg = queryGroupByReg & "mpbd1.business_division_descr, "
queryGroupByReg = queryGroupByReg & "mpbd1.restated_market_key, "
queryGroupByReg = queryGroupByReg & "mpbd1.restated_product_key, "
queryGroupByReg = queryGroupByReg & "md1.year_descr, "
queryGroupByReg = queryGroupByReg & "md1.month_descr, "
queryGroupByReg = queryGroupByReg & "md1.FISCAL_MONTH_NUMBER "
queryGroupByReg = queryGroupByReg & ")  ---End sub queryGroupByReg "
queryGroupByReg = queryGroupByReg & "   ids_mf, "
queryGroupByReg = queryGroupByReg & "tdw_owner.restated_mkt_prd_bus_div_dim mpbd, "
queryGroupByReg = queryGroupByReg & "tdw_owner.restated_market m, "
queryGroupByReg = queryGroupByReg & "tdw_owner.restated_product p, "
queryGroupByReg = queryGroupByReg & "tdw_owner.group_detail gd, "
queryGroupByReg = queryGroupByReg & "tdw_owner.group_description groupdescr "
queryGroupByReg = queryGroupByReg & "WHERE ids_mf.restated_market_key = mpbd.restated_market_key "
queryGroupByReg = queryGroupByReg & "AND ids_mf.restated_product_key = mpbd.restated_product_key "
queryGroupByReg = queryGroupByReg & "AND ids_mf.restated_market_key = m.restated_market_key "
queryGroupByReg = queryGroupByReg & "AND ids_mf.restated_product_key = p.restated_product_key "
queryGroupByReg = queryGroupByReg & "AND gd.GROUP_CODE = groupdescr.GROUP_CODE "
queryGroupByReg = queryGroupByReg & "AND gd.group_field_c  =  m.DIVISION_CODE "
queryGroupByReg = queryGroupByReg & "AND (mpbd.business_division_code IN ('F03', 'F04')) "
queryGroupByReg = queryGroupByReg & "AND (m.selling_group_code IN ('119000', '125000', '610000', '800000', '423000')) "
queryGroupByReg = queryGroupByReg & "AND (ids_mf.year_descr IN (:p_year)) "
queryGroupByReg = queryGroupByReg & "and ids_mf.fiscal_month_number <= :p_Month "
queryGroupByReg = queryGroupByReg & "AND (mpbd.business_division_code IN (:p_businessdivision)) "
queryGroupByReg = queryGroupByReg & "AND (m.division_code IN (:p_salesdivision)) "
queryGroupByReg = queryGroupByReg & "AND (m.region_code IN (:p_salesregion)) "
queryGroupByReg = queryGroupByReg & "AND (m.primary_broker_code IN (:p_primarybroker)) "
queryGroupByReg = queryGroupByReg & "AND gd.GROUP_CODE in (:vp) "
queryGroupByReg = queryGroupByReg & "GROUP BY  "
queryGroupByReg = queryGroupByReg & "gd.GROUP_CODE, "
queryGroupByReg = queryGroupByReg & "groupdescr.GROUP_DESCR, "
queryGroupByReg = queryGroupByReg & "m.REGION_CODE, "
queryGroupByReg = queryGroupByReg & "m.REGION_DESCR, "
queryGroupByReg = queryGroupByReg & "'zzz', "
queryGroupByReg = queryGroupByReg & "mpbd.business_division_code, "
queryGroupByReg = queryGroupByReg & "'Total Market/CVP', "
queryGroupByReg = queryGroupByReg & "ids_mf.year_descr, "
queryGroupByReg = queryGroupByReg & "ids_mf.month_descr, "
queryGroupByReg = queryGroupByReg & "ids_mf.FISCAL_MONTH_NUMBER, "
queryGroupByReg = queryGroupByReg & "mpbd.business_division_Descr "
queryGroupByReg = queryGroupByReg & "---Begin Volume Total customer "
queryGroupByReg = queryGroupByReg & "UNION "
queryGroupByReg = queryGroupByReg & "SELECT    "
queryGroupByReg = queryGroupByReg & "'zzz' AS businessunit, "
queryGroupByReg = queryGroupByReg & "0 AS monthexpense_amt, "
queryGroupByReg = queryGroupByReg & "CASE WHEN (ids_mf.FISCAL_MONTH_NUMBER = (:p_Month)) "
queryGroupByReg = queryGroupByReg & "     THEN SUM (  ids_mf.mf_pounds_shipped "
queryGroupByReg = queryGroupByReg & "               + ids_mf.mf_adjusted_pounds_shipped "
queryGroupByReg = queryGroupByReg & "               + ids_mf.ids_pounds_shipped) "
queryGroupByReg = queryGroupByReg & "END AS monthpounds, "
queryGroupByReg = queryGroupByReg & "CASE WHEN (ids_mf.FISCAL_MONTH_NUMBER = (:p_Month)) "
queryGroupByReg = queryGroupByReg & "     THEN SUM (  ids_mf.mf_gross_sales_amount "
queryGroupByReg = queryGroupByReg & "                - ids_mf.mf_allow_amount "
queryGroupByReg = queryGroupByReg & "                - ids_mf.mf_off_invoice_amount "
queryGroupByReg = queryGroupByReg & "                + ids_mf.mf_revenue_adjustment "
queryGroupByReg = queryGroupByReg & "                + ids_mf.ids_indirect_sales_amount) "
queryGroupByReg = queryGroupByReg & "END AS monthnetreceivables, "
queryGroupByReg = queryGroupByReg & "gd.GROUP_CODE, "
queryGroupByReg = queryGroupByReg & "groupdescr.GROUP_DESCR, "
queryGroupByReg = queryGroupByReg & "m.REGION_CODE, "
queryGroupByReg = queryGroupByReg & "m.REGION_DESCR, "
queryGroupByReg = queryGroupByReg & "mpbd.business_division_code, "
queryGroupByReg = queryGroupByReg & "'Total Customer' AS businessdivisiondescr, "
queryGroupByReg = queryGroupByReg & "NULL AS spend_base_descr, "
queryGroupByReg = queryGroupByReg & "NULL AS spend_base_seq, "
queryGroupByReg = queryGroupByReg & "NULL AS spend_subcategory_descr, "
queryGroupByReg = queryGroupByReg & "NULL AS spend_subcategory_seq, "
queryGroupByReg = queryGroupByReg & "ids_mf.year_descr, "
queryGroupByReg = queryGroupByReg & "ids_mf.month_descr, "
queryGroupByReg = queryGroupByReg & "0 AS expense_amt, "
queryGroupByReg = queryGroupByReg & "SUM (  ids_mf.mf_pounds_shipped "
queryGroupByReg = queryGroupByReg & "       + ids_mf.mf_adjusted_pounds_shipped "
queryGroupByReg = queryGroupByReg & "       + ids_mf.ids_pounds_shipped "
queryGroupByReg = queryGroupByReg & "      ) AS total_pounds_shipped, "
queryGroupByReg = queryGroupByReg & "SUM (  ids_mf.mf_gross_sales_amount "
queryGroupByReg = queryGroupByReg & "     - ids_mf.mf_allow_amount "
queryGroupByReg = queryGroupByReg & "     - ids_mf.mf_off_invoice_amount "
queryGroupByReg = queryGroupByReg & "     + ids_mf.mf_revenue_adjustment "
queryGroupByReg = queryGroupByReg & "     + ids_mf.ids_indirect_sales_amount "
queryGroupByReg = queryGroupByReg & "     ) AS net_receivable_dollar "
queryGroupByReg = queryGroupByReg & "FROM ( "
queryGroupByReg = queryGroupByReg & "---Begin sub queryGroupByReg "
queryGroupByReg = queryGroupByReg & "SELECT   mpbd1.business_division_code, "
queryGroupByReg = queryGroupByReg & "mpbd1.business_division_descr, "
queryGroupByReg = queryGroupByReg & "mpbd1.restated_market_key, "
queryGroupByReg = queryGroupByReg & "mpbd1.restated_product_key, "
queryGroupByReg = queryGroupByReg & "md1.year_descr, "
queryGroupByReg = queryGroupByReg & "md1.month_descr, "
queryGroupByReg = queryGroupByReg & "md1.FISCAL_MONTH_NUMBER, "
queryGroupByReg = queryGroupByReg & "SUM (mf.pounds_shipped) AS mf_pounds_shipped, "
queryGroupByReg = queryGroupByReg & "SUM (mf.adj_pounds_shipped) AS mf_adjusted_pounds_shipped, "
queryGroupByReg = queryGroupByReg & "SUM (mf.gross_sales_amount) AS mf_gross_sales_amount, "
queryGroupByReg = queryGroupByReg & "SUM (mf.allow_amount) AS mf_allow_amount, "
queryGroupByReg = queryGroupByReg & "SUM (mf.revenue_adjustment) AS mf_revenue_adjustment, "
queryGroupByReg = queryGroupByReg & "SUM (mf.off_invoice_amount) AS mf_off_invoice_amount, "
queryGroupByReg = queryGroupByReg & "0 AS ids_pounds_shipped, "
queryGroupByReg = queryGroupByReg & "0 AS ids_indirect_sales_amount "
queryGroupByReg = queryGroupByReg & "FROM tdw_owner.restated_mkt_prd_bus_div_dim mpbd1, "
queryGroupByReg = queryGroupByReg & "tdw_owner.restated_market m1, "
queryGroupByReg = queryGroupByReg & "tdw_owner.month_dim md1, "
queryGroupByReg = queryGroupByReg & "tdw_owner.restated_product p1, "
queryGroupByReg = queryGroupByReg & "tdw_owner.day_dim d1, "
queryGroupByReg = queryGroupByReg & "tdw_owner.margin_fact mf, "
queryGroupByReg = queryGroupByReg & "tdw_owner.group_detail gd, "
queryGroupByReg = queryGroupByReg & "tdw_owner.group_description groupdescr "
queryGroupByReg = queryGroupByReg & "WHERE mf.restated_market_key = m1.restated_market_key "
queryGroupByReg = queryGroupByReg & "AND mf.restated_product_key = p1.restated_product_key "
queryGroupByReg = queryGroupByReg & "AND mf.restated_market_key = mpbd1.restated_market_key "
queryGroupByReg = queryGroupByReg & "AND mf.restated_product_key = mpbd1.restated_product_key "
queryGroupByReg = queryGroupByReg & "AND mf.invoice_day_key = d1.day_key "
queryGroupByReg = queryGroupByReg & "AND d1.month_ending_date = md1.month_ending_date "
queryGroupByReg = queryGroupByReg & "AND gd.GROUP_CODE = groupdescr.GROUP_CODE "
queryGroupByReg = queryGroupByReg & "AND gd.group_field_c  =  m1.DIVISION_CODE "
queryGroupByReg = queryGroupByReg & "AND (mpbd1.business_division_code IN ('F01', 'F03', 'F04', 'F08', 'F15')) "
queryGroupByReg = queryGroupByReg & "AND (m1.selling_group_code IN ('119000', '125000', '610000', '800000', '423000')) "
queryGroupByReg = queryGroupByReg & "AND (md1.year_descr IN (:p_year)) "
queryGroupByReg = queryGroupByReg & "and md1.fiscal_month_number <= :p_Month "
queryGroupByReg = queryGroupByReg & "AND (mpbd1.business_division_code IN (:p_businessdivision)) "
queryGroupByReg = queryGroupByReg & "AND (m1.division_code IN (:p_salesdivision)) "
queryGroupByReg = queryGroupByReg & "AND (m1.region_code IN (:p_salesregion)) "
queryGroupByReg = queryGroupByReg & "AND (m1.primary_broker_code IN (:p_primarybroker)) "
queryGroupByReg = queryGroupByReg & "AND gd.GROUP_CODE in (:vp) "
queryGroupByReg = queryGroupByReg & "GROUP BY mpbd1.business_division_code, "
queryGroupByReg = queryGroupByReg & "mpbd1.business_division_descr, "
queryGroupByReg = queryGroupByReg & "mpbd1.restated_market_key, "
queryGroupByReg = queryGroupByReg & "mpbd1.restated_product_key, "
queryGroupByReg = queryGroupByReg & "md1.year_descr, "
queryGroupByReg = queryGroupByReg & "md1.month_descr, "
queryGroupByReg = queryGroupByReg & "md1.FISCAL_MONTH_NUMBER "
queryGroupByReg = queryGroupByReg & "UNION "
queryGroupByReg = queryGroupByReg & "SELECT   /*+ RULE */ "
queryGroupByReg = queryGroupByReg & "mpbd1.business_division_code, "
queryGroupByReg = queryGroupByReg & "mpbd1.business_division_descr, "
queryGroupByReg = queryGroupByReg & "mpbd1.restated_market_key, "
queryGroupByReg = queryGroupByReg & "mpbd1.restated_product_key, "
queryGroupByReg = queryGroupByReg & "md1.year_descr, "
queryGroupByReg = queryGroupByReg & "md1.month_descr, "
queryGroupByReg = queryGroupByReg & "md1.FISCAL_MONTH_NUMBER, "
queryGroupByReg = queryGroupByReg & "0 AS mf_pounds_shipped, "
queryGroupByReg = queryGroupByReg & "0 AS mf_adjusted_pounds_shipped, "
queryGroupByReg = queryGroupByReg & "0 AS mf_gross_sales_amount, "
queryGroupByReg = queryGroupByReg & "0 AS mf_allow_amount, "
queryGroupByReg = queryGroupByReg & "0 AS mf_revenue_adjustment, "
queryGroupByReg = queryGroupByReg & "0 AS mf_off_invoice_amount, "
queryGroupByReg = queryGroupByReg & "SUM (ids.pounds_shipped) AS ids_pounds_shipped, "
queryGroupByReg = queryGroupByReg & "SUM (ids.indirect_sales_amount) "
queryGroupByReg = queryGroupByReg & "                 AS ids_indirect_sales_amount "
queryGroupByReg = queryGroupByReg & "FROM tdw_owner.restated_mkt_prd_bus_div_dim mpbd1, "
queryGroupByReg = queryGroupByReg & "tdw_owner.restated_market m1, "
queryGroupByReg = queryGroupByReg & "tdw_owner.month_dim md1, "
queryGroupByReg = queryGroupByReg & "tdw_owner.restated_product p1, "
queryGroupByReg = queryGroupByReg & "tdw_owner.indirect_sales ids, "
queryGroupByReg = queryGroupByReg & "tdw_owner.week_dim w1, "
queryGroupByReg = queryGroupByReg & "tdw_owner.group_detail gd, "
queryGroupByReg = queryGroupByReg & "tdw_owner.group_description groupdescr "
queryGroupByReg = queryGroupByReg & "WHERE ids.restated_market_key = m1.restated_market_key "
queryGroupByReg = queryGroupByReg & "AND ids.restated_product_key = p1.restated_product_key "
queryGroupByReg = queryGroupByReg & "AND ids.restated_market_key = mpbd1.restated_market_key "
queryGroupByReg = queryGroupByReg & "AND ids.restated_product_key = mpbd1.restated_product_key "
queryGroupByReg = queryGroupByReg & "AND ids.week_key = w1.week_key "
queryGroupByReg = queryGroupByReg & "AND w1.month_ending_date = md1.month_ending_date "
queryGroupByReg = queryGroupByReg & "AND gd.GROUP_CODE = groupdescr.GROUP_CODE "
queryGroupByReg = queryGroupByReg & "AND gd.group_field_c  =  m1.DIVISION_CODE "
queryGroupByReg = queryGroupByReg & "AND (mpbd1.business_division_code IN ('F01', 'F03', 'F04', 'F08', 'F15')) "
queryGroupByReg = queryGroupByReg & "AND (m1.selling_group_code IN ('119000', '125000', '610000', '800000', '423000')) "
queryGroupByReg = queryGroupByReg & "AND (md1.year_descr IN (:p_year)) "
queryGroupByReg = queryGroupByReg & "and md1.fiscal_month_number <= :p_Month "
queryGroupByReg = queryGroupByReg & "AND (mpbd1.business_division_code IN (:p_businessdivision)) "
queryGroupByReg = queryGroupByReg & "AND (m1.division_code IN (:p_salesdivision)) "
queryGroupByReg = queryGroupByReg & "AND (m1.region_code IN (:p_salesregion)) "
queryGroupByReg = queryGroupByReg & "AND (m1.primary_broker_code IN (:p_primarybroker)) "
queryGroupByReg = queryGroupByReg & "AND gd.GROUP_CODE in (:vp) "
queryGroupByReg = queryGroupByReg & "GROUP BY mpbd1.business_division_code, "
queryGroupByReg = queryGroupByReg & "mpbd1.business_division_descr, "
queryGroupByReg = queryGroupByReg & "mpbd1.restated_market_key, "
queryGroupByReg = queryGroupByReg & "mpbd1.restated_product_key, "
queryGroupByReg = queryGroupByReg & "md1.year_descr, "
queryGroupByReg = queryGroupByReg & "md1.month_descr, "
queryGroupByReg = queryGroupByReg & "md1.FISCAL_MONTH_NUMBER "
queryGroupByReg = queryGroupByReg & ")   --end sub queryGroupByReg "
queryGroupByReg = queryGroupByReg & "   ids_mf, "
queryGroupByReg = queryGroupByReg & "tdw_owner.restated_mkt_prd_bus_div_dim mpbd, "
queryGroupByReg = queryGroupByReg & "tdw_owner.restated_market m, "
queryGroupByReg = queryGroupByReg & "tdw_owner.restated_product p, "
queryGroupByReg = queryGroupByReg & "tdw_owner.group_detail gd, "
queryGroupByReg = queryGroupByReg & "tdw_owner.group_description groupdescr "
queryGroupByReg = queryGroupByReg & "WHERE ids_mf.restated_market_key = mpbd.restated_market_key "
queryGroupByReg = queryGroupByReg & "AND ids_mf.restated_product_key = mpbd.restated_product_key "
queryGroupByReg = queryGroupByReg & "AND ids_mf.restated_market_key = m.restated_market_key "
queryGroupByReg = queryGroupByReg & "AND ids_mf.restated_product_key = p.restated_product_key "
queryGroupByReg = queryGroupByReg & "AND gd.GROUP_CODE = groupdescr.GROUP_CODE "
queryGroupByReg = queryGroupByReg & "AND gd.group_field_c  =  m.DIVISION_CODE "
queryGroupByReg = queryGroupByReg & "AND (mpbd.business_division_code IN ('F01', 'F03', 'F04', 'F08', 'F15')) "
queryGroupByReg = queryGroupByReg & "AND (m.selling_group_code IN ('119000', '125000', '610000', '800000', '423000')) "
queryGroupByReg = queryGroupByReg & "AND (ids_mf.year_descr IN (:p_year)) "
queryGroupByReg = queryGroupByReg & "and ids_mf.fiscal_month_number <= :p_Month "
queryGroupByReg = queryGroupByReg & "AND (mpbd.business_division_code IN (:p_businessdivision)) "
queryGroupByReg = queryGroupByReg & "AND (m.division_code IN (:p_salesdivision)) "
queryGroupByReg = queryGroupByReg & "AND (m.region_code IN (:p_salesregion)) "
queryGroupByReg = queryGroupByReg & "AND (m.primary_broker_code IN (:p_primarybroker)) "
queryGroupByReg = queryGroupByReg & "AND gd.GROUP_CODE in (:vp) "
queryGroupByReg = queryGroupByReg & "GROUP BY  "
queryGroupByReg = queryGroupByReg & "gd.GROUP_CODE, "
queryGroupByReg = queryGroupByReg & "groupdescr.GROUP_DESCR, "
queryGroupByReg = queryGroupByReg & "m.REGION_CODE, "
queryGroupByReg = queryGroupByReg & "m.REGION_DESCR, "
queryGroupByReg = queryGroupByReg & "'zzz', "
queryGroupByReg = queryGroupByReg & "mpbd.business_division_code, "
queryGroupByReg = queryGroupByReg & "'Total Customer', "
queryGroupByReg = queryGroupByReg & "ids_mf.year_descr, "
queryGroupByReg = queryGroupByReg & "ids_mf.month_descr, "
queryGroupByReg = queryGroupByReg & "ids_mf.FISCAL_MONTH_NUMBER, "
queryGroupByReg = queryGroupByReg & "mpbd.business_division_Descr "
queryGroupByReg = queryGroupByReg & "ORDER BY businessdivisiondescr, spend_base_seq, spend_subcategory_seq"

Dim queryGroupByVP As String

queryGroupByVP = "SELECT   " 
queryGroupByVP = queryGroupByVP & "CASE WHEN (sc.spend_base_seq IN (1, 2, 3, 4, 5))THEN 'Distributor' "
queryGroupByVP = queryGroupByVP & "     WHEN (sc.spend_base_seq = 6)THEN 'Operator' "
queryGroupByVP = queryGroupByVP & "END AS businessunit, "
queryGroupByVP = queryGroupByVP & "CASE WHEN (md.FISCAL_MONTH_NUMBER = (:p_Month))THEN SUM (epf.expense_amt) "
queryGroupByVP = queryGroupByVP & "END AS monthexpense_amt, "
queryGroupByVP = queryGroupByVP & "0 AS monthpounds, "
queryGroupByVP = queryGroupByVP & "0 AS monthnetreceivables, "
queryGroupByVP = queryGroupByVP & "gd.GROUP_CODE, "
queryGroupByVP = queryGroupByVP & "groupdescr.GROUP_DESCR, "
queryGroupByVP = queryGroupByVP & "mpbd.business_division_code, "
queryGroupByVP = queryGroupByVP & "INITCAP (mpbd.business_division_descr) AS businessdivisiondescr, "
queryGroupByVP = queryGroupByVP & "sc.spend_base_descr, "
queryGroupByVP = queryGroupByVP & "sc.spend_base_seq, "
queryGroupByVP = queryGroupByVP & "sc.spend_subcategory_descr, "
queryGroupByVP = queryGroupByVP & "sc.spend_subcategory_seq, "
queryGroupByVP = queryGroupByVP & "md.year_descr, "
queryGroupByVP = queryGroupByVP & "md.month_descr, "
queryGroupByVP = queryGroupByVP & "SUM (epf.expense_amt) AS expense_amt, "
queryGroupByVP = queryGroupByVP & "0 AS total_pounds_shipped, "
queryGroupByVP = queryGroupByVP & "0 AS net_receivable_dollar "
queryGroupByVP = queryGroupByVP & "FROM tdw_owner.restated_mkt_prd_bus_div_dim mpbd, "
queryGroupByVP = queryGroupByVP & "tdw_owner.expense_payment_fact epf, "
queryGroupByVP = queryGroupByVP & "tdw_owner.fsv_spend_category sc, "
queryGroupByVP = queryGroupByVP & "tdw_owner.restated_market m, "
queryGroupByVP = queryGroupByVP & "tdw_owner.month_dim md, "
queryGroupByVP = queryGroupByVP & "tdw_owner.restated_product p, "
queryGroupByVP = queryGroupByVP & "tdw_owner.acct_dim a, "
queryGroupByVP = queryGroupByVP & "tdw_owner.expense_type et, "
queryGroupByVP = queryGroupByVP & "tdw_owner.spend_request_dim s, "
queryGroupByVP = queryGroupByVP & "tdw_owner.operator_dim o, "
queryGroupByVP = queryGroupByVP & "tdw_owner.day_dim d1, "
queryGroupByVP = queryGroupByVP & "tdw_owner.day_dim d2, "
queryGroupByVP = queryGroupByVP & "tdw_owner.expense_attribute_dim ead, "
queryGroupByVP = queryGroupByVP & "tdw_owner.expense_payee_dim pay, "
queryGroupByVP = queryGroupByVP & "tdw_owner.group_detail gd, "
queryGroupByVP = queryGroupByVP & "tdw_owner.group_description groupdescr "
queryGroupByVP = queryGroupByVP & "WHERE mpbd.restated_mkt_prd_bus_div_key = epf.restated_mkt_prd_bus_div_key "
queryGroupByVP = queryGroupByVP & "AND epf.expense_type_key = sc.expense_type_key "
queryGroupByVP = queryGroupByVP & "AND epf.acct_key = sc.acct_key "
queryGroupByVP = queryGroupByVP & "AND epf.restated_market_key = m.restated_market_key "
queryGroupByVP = queryGroupByVP & "AND epf.month_key = md.month_key "
queryGroupByVP = queryGroupByVP & "AND epf.restated_product_key = p.restated_product_key "
queryGroupByVP = queryGroupByVP & "AND epf.acct_key = a.acct_key "
queryGroupByVP = queryGroupByVP & "AND epf.expense_type_key = et.expense_type_key "
queryGroupByVP = queryGroupByVP & "AND epf.spend_request_key = s.spend_request_key "
queryGroupByVP = queryGroupByVP & "AND epf.operator_key = o.operator_key "
queryGroupByVP = queryGroupByVP & "AND epf.report_period_begin_day_key = d1.day_key "
queryGroupByVP = queryGroupByVP & "AND epf.report_period_end_day_key = d2.day_key "
queryGroupByVP = queryGroupByVP & "AND epf.expense_attribute_key = ead.expense_attribute_key "
queryGroupByVP = queryGroupByVP & "AND epf.expense_payee_key = pay.expense_payee_key "
queryGroupByVP = queryGroupByVP & "AND gd.GROUP_CODE = groupdescr.GROUP_CODE "
queryGroupByVP = queryGroupByVP & "AND gd.group_field_c  =  m.DIVISION_CODE "
queryGroupByVP = queryGroupByVP & "AND sc.spend_base_seq <> 0 "
queryGroupByVP = queryGroupByVP & "AND sc.spend_subcategory_seq <> 0 "
queryGroupByVP = queryGroupByVP & "AND (mpbd.business_division_code IN ('F01', 'F03', 'F04', 'F08', 'F15')) "
queryGroupByVP = queryGroupByVP & "AND (m.selling_group_code IN ('119000', '125000', '610000', '800000', '423000')) "
queryGroupByVP = queryGroupByVP & "AND (md.year_descr IN (:p_year)) "
queryGroupByVP = queryGroupByVP & "and md.fiscal_month_number <= :p_Month "
queryGroupByVP = queryGroupByVP & "AND (mpbd.business_division_code IN (:p_businessdivision)) "
queryGroupByVP = queryGroupByVP & "AND (m.division_code IN (:p_salesdivision)) "
queryGroupByVP = queryGroupByVP & "AND (m.region_code IN (:p_salesregion)) "
queryGroupByVP = queryGroupByVP & "AND (m.primary_broker_code IN (:p_primarybroker)) "
queryGroupByVP = queryGroupByVP & "AND gd.GROUP_CODE in (:vp) "
queryGroupByVP = queryGroupByVP & "GROUP BY  "
queryGroupByVP = queryGroupByVP & "gd.GROUP_CODE, "
queryGroupByVP = queryGroupByVP & "groupdescr.GROUP_DESCR, "
queryGroupByVP = queryGroupByVP & "mpbd.business_division_code, "
queryGroupByVP = queryGroupByVP & "INITCAP (mpbd.business_division_descr), "
queryGroupByVP = queryGroupByVP & "sc.spend_base_descr, "
queryGroupByVP = queryGroupByVP & "sc.spend_base_seq, "
queryGroupByVP = queryGroupByVP & "sc.spend_subcategory_descr, "
queryGroupByVP = queryGroupByVP & "sc.spend_subcategory_seq, "
queryGroupByVP = queryGroupByVP & "md.year_descr, "
queryGroupByVP = queryGroupByVP & "md.month_descr, "
queryGroupByVP = queryGroupByVP & "md.FISCAL_MONTH_NUMBER "
queryGroupByVP = queryGroupByVP & "---Add Expense Total Value Added "
queryGroupByVP = queryGroupByVP & "UNION "
queryGroupByVP = queryGroupByVP & "SELECT    "
queryGroupByVP = queryGroupByVP & "CASE WHEN (sc.spend_base_seq IN (1, 2, 3, 4, 5))THEN 'Distributor' "
queryGroupByVP = queryGroupByVP & "     WHEN (sc.spend_base_seq = 6)THEN 'Operator' "
queryGroupByVP = queryGroupByVP & "END AS businessunit, "
queryGroupByVP = queryGroupByVP & "CASE WHEN (md.FISCAL_MONTH_NUMBER = (:p_Month))THEN SUM (epf.expense_amt) "
queryGroupByVP = queryGroupByVP & "END AS monthexpense_amt, "
queryGroupByVP = queryGroupByVP & "0 AS monthpounds, "
queryGroupByVP = queryGroupByVP & "0 AS monthnetreceivables, "
queryGroupByVP = queryGroupByVP & "gd.GROUP_CODE, "
queryGroupByVP = queryGroupByVP & "groupdescr.GROUP_DESCR, "
queryGroupByVP = queryGroupByVP & "mpbd.business_division_code, "
queryGroupByVP = queryGroupByVP & "'Total Value Added' AS businessdivisiondescr, "
queryGroupByVP = queryGroupByVP & "sc.spend_base_descr, "
queryGroupByVP = queryGroupByVP & "sc.spend_base_seq, "
queryGroupByVP = queryGroupByVP & "sc.spend_subcategory_descr, "
queryGroupByVP = queryGroupByVP & "sc.spend_subcategory_seq, "
queryGroupByVP = queryGroupByVP & "md.year_descr, "
queryGroupByVP = queryGroupByVP & "md.month_descr, "
queryGroupByVP = queryGroupByVP & "SUM (epf.expense_amt) AS expense_amt, "
queryGroupByVP = queryGroupByVP & "0 AS total_pounds_shipped, "
queryGroupByVP = queryGroupByVP & "0 AS net_receivable_dollar "
queryGroupByVP = queryGroupByVP & "FROM tdw_owner.restated_mkt_prd_bus_div_dim mpbd, "
queryGroupByVP = queryGroupByVP & "tdw_owner.expense_payment_fact epf, "
queryGroupByVP = queryGroupByVP & "tdw_owner.fsv_spend_category sc, "
queryGroupByVP = queryGroupByVP & "tdw_owner.restated_market m, "
queryGroupByVP = queryGroupByVP & "tdw_owner.month_dim md, "
queryGroupByVP = queryGroupByVP & "tdw_owner.restated_product p, "
queryGroupByVP = queryGroupByVP & "tdw_owner.acct_dim a, "
queryGroupByVP = queryGroupByVP & "tdw_owner.expense_type et, "
queryGroupByVP = queryGroupByVP & "tdw_owner.spend_request_dim s, "
queryGroupByVP = queryGroupByVP & "tdw_owner.operator_dim o, "
queryGroupByVP = queryGroupByVP & "tdw_owner.day_dim d1, "
queryGroupByVP = queryGroupByVP & "tdw_owner.day_dim d2, "
queryGroupByVP = queryGroupByVP & "tdw_owner.expense_attribute_dim ead, "
queryGroupByVP = queryGroupByVP & "tdw_owner.expense_payee_dim pay, "
queryGroupByVP = queryGroupByVP & "tdw_owner.group_detail gd, "
queryGroupByVP = queryGroupByVP & "tdw_owner.group_description groupdescr "
queryGroupByVP = queryGroupByVP & "WHERE mpbd.restated_mkt_prd_bus_div_key = epf.restated_mkt_prd_bus_div_key "
queryGroupByVP = queryGroupByVP & "AND epf.expense_type_key = sc.expense_type_key "
queryGroupByVP = queryGroupByVP & "AND epf.acct_key = sc.acct_key "
queryGroupByVP = queryGroupByVP & "AND epf.restated_market_key = m.restated_market_key "
queryGroupByVP = queryGroupByVP & "AND epf.month_key = md.month_key "
queryGroupByVP = queryGroupByVP & "AND epf.restated_product_key = p.restated_product_key "
queryGroupByVP = queryGroupByVP & "AND epf.acct_key = a.acct_key "
queryGroupByVP = queryGroupByVP & "AND epf.expense_type_key = et.expense_type_key "
queryGroupByVP = queryGroupByVP & "AND epf.spend_request_key = s.spend_request_key "
queryGroupByVP = queryGroupByVP & "AND epf.operator_key = o.operator_key "
queryGroupByVP = queryGroupByVP & "AND epf.report_period_begin_day_key = d1.day_key "
queryGroupByVP = queryGroupByVP & "AND epf.report_period_end_day_key = d2.day_key "
queryGroupByVP = queryGroupByVP & "AND epf.expense_attribute_key = ead.expense_attribute_key "
queryGroupByVP = queryGroupByVP & "AND epf.expense_payee_key = pay.expense_payee_key "
queryGroupByVP = queryGroupByVP & "AND gd.GROUP_CODE = groupdescr.GROUP_CODE "
queryGroupByVP = queryGroupByVP & "AND gd.group_field_c  =  m.DIVISION_CODE "
queryGroupByVP = queryGroupByVP & "AND sc.spend_base_seq <> 0 "
queryGroupByVP = queryGroupByVP & "AND sc.spend_subcategory_seq <> 0 "
queryGroupByVP = queryGroupByVP & "AND (mpbd.business_division_code IN ('F01', 'F03', 'F04', 'F08', 'F15')) "
queryGroupByVP = queryGroupByVP & "AND (m.selling_group_code IN ('119000', '125000', '610000', '800000', '423000')) "
queryGroupByVP = queryGroupByVP & "AND (md.year_descr IN (:p_year)) "
queryGroupByVP = queryGroupByVP & "and md.fiscal_month_number <= :p_Month "
queryGroupByVP = queryGroupByVP & "AND (mpbd.business_division_code IN (:p_businessdivision)) "
queryGroupByVP = queryGroupByVP & "AND (m.division_code IN (:p_salesdivision)) "
queryGroupByVP = queryGroupByVP & "AND (m.region_code IN (:p_salesregion)) "
queryGroupByVP = queryGroupByVP & "AND (m.primary_broker_code IN (:p_primarybroker)) "
queryGroupByVP = queryGroupByVP & "AND gd.GROUP_CODE in (:vp) "
queryGroupByVP = queryGroupByVP & "GROUP BY  "
queryGroupByVP = queryGroupByVP & "gd.GROUP_CODE, "
queryGroupByVP = queryGroupByVP & "groupdescr.GROUP_DESCR, "
queryGroupByVP = queryGroupByVP & "mpbd.business_division_code, "
queryGroupByVP = queryGroupByVP & "'Total Value Added' , "
queryGroupByVP = queryGroupByVP & "sc.spend_base_descr, "
queryGroupByVP = queryGroupByVP & "sc.spend_base_seq, "
queryGroupByVP = queryGroupByVP & "sc.spend_subcategory_descr, "
queryGroupByVP = queryGroupByVP & "sc.spend_subcategory_seq, "
queryGroupByVP = queryGroupByVP & "md.year_descr, "
queryGroupByVP = queryGroupByVP & "md.month_descr, "
queryGroupByVP = queryGroupByVP & "md.FISCAL_MONTH_NUMBER, "
queryGroupByVP = queryGroupByVP & "mpbd.business_division_Descr "
queryGroupByVP = queryGroupByVP & "--Begin Expense Total Market/CVP "
queryGroupByVP = queryGroupByVP & "UNION "
queryGroupByVP = queryGroupByVP & "SELECT    "
queryGroupByVP = queryGroupByVP & "CASE WHEN (sc.spend_base_seq IN (1, 2, 3, 4, 5))THEN 'Distributor' "
queryGroupByVP = queryGroupByVP & "     WHEN (sc.spend_base_seq = 6)THEN 'Operator' "
queryGroupByVP = queryGroupByVP & "END AS businessunit, "
queryGroupByVP = queryGroupByVP & "CASE WHEN (md.FISCAL_MONTH_NUMBER = (:p_Month))THEN SUM (epf.expense_amt) "
queryGroupByVP = queryGroupByVP & "END AS monthexpense_amt, "
queryGroupByVP = queryGroupByVP & "0 AS monthpounds, "
queryGroupByVP = queryGroupByVP & "0 AS monthnetreceivables, "
queryGroupByVP = queryGroupByVP & "gd.GROUP_CODE, "
queryGroupByVP = queryGroupByVP & "groupdescr.GROUP_DESCR, "
queryGroupByVP = queryGroupByVP & "mpbd.business_division_code, "
queryGroupByVP = queryGroupByVP & "'Total Market/CVP' AS businessdivisiondescr, "
queryGroupByVP = queryGroupByVP & "sc.spend_base_descr, "
queryGroupByVP = queryGroupByVP & "sc.spend_base_seq, "
queryGroupByVP = queryGroupByVP & "sc.spend_subcategory_descr, "
queryGroupByVP = queryGroupByVP & "sc.spend_subcategory_seq, "
queryGroupByVP = queryGroupByVP & "md.year_descr, "
queryGroupByVP = queryGroupByVP & "md.month_descr, "
queryGroupByVP = queryGroupByVP & "SUM (epf.expense_amt) AS expense_amt, "
queryGroupByVP = queryGroupByVP & "0 AS total_pounds_shipped, "
queryGroupByVP = queryGroupByVP & "0 AS net_receivable_dollar "
queryGroupByVP = queryGroupByVP & "FROM tdw_owner.restated_mkt_prd_bus_div_dim mpbd, "
queryGroupByVP = queryGroupByVP & "tdw_owner.expense_payment_fact epf, "
queryGroupByVP = queryGroupByVP & "tdw_owner.fsv_spend_category sc, "
queryGroupByVP = queryGroupByVP & "tdw_owner.restated_market m, "
queryGroupByVP = queryGroupByVP & "tdw_owner.month_dim md, "
queryGroupByVP = queryGroupByVP & "tdw_owner.restated_product p, "
queryGroupByVP = queryGroupByVP & "tdw_owner.acct_dim a, "
queryGroupByVP = queryGroupByVP & "tdw_owner.expense_type et, "
queryGroupByVP = queryGroupByVP & "tdw_owner.spend_request_dim s, "
queryGroupByVP = queryGroupByVP & "tdw_owner.operator_dim o, "
queryGroupByVP = queryGroupByVP & "tdw_owner.day_dim d1, "
queryGroupByVP = queryGroupByVP & "tdw_owner.day_dim d2, "
queryGroupByVP = queryGroupByVP & "tdw_owner.expense_attribute_dim ead, "
queryGroupByVP = queryGroupByVP & "tdw_owner.expense_payee_dim pay, "
queryGroupByVP = queryGroupByVP & "tdw_owner.group_detail gd, "
queryGroupByVP = queryGroupByVP & "tdw_owner.group_description groupdescr "
queryGroupByVP = queryGroupByVP & "WHERE mpbd.restated_mkt_prd_bus_div_key = epf.restated_mkt_prd_bus_div_key "
queryGroupByVP = queryGroupByVP & "AND epf.expense_type_key = sc.expense_type_key "
queryGroupByVP = queryGroupByVP & "AND epf.acct_key = sc.acct_key "
queryGroupByVP = queryGroupByVP & "AND epf.restated_market_key = m.restated_market_key "
queryGroupByVP = queryGroupByVP & "AND epf.month_key = md.month_key "
queryGroupByVP = queryGroupByVP & "AND epf.restated_product_key = p.restated_product_key "
queryGroupByVP = queryGroupByVP & "AND epf.acct_key = a.acct_key "
queryGroupByVP = queryGroupByVP & "AND epf.expense_type_key = et.expense_type_key "
queryGroupByVP = queryGroupByVP & "AND epf.spend_request_key = s.spend_request_key "
queryGroupByVP = queryGroupByVP & "AND epf.operator_key = o.operator_key "
queryGroupByVP = queryGroupByVP & "AND epf.report_period_begin_day_key = d1.day_key "
queryGroupByVP = queryGroupByVP & "AND epf.report_period_end_day_key = d2.day_key "
queryGroupByVP = queryGroupByVP & "AND epf.expense_attribute_key = ead.expense_attribute_key "
queryGroupByVP = queryGroupByVP & "AND epf.expense_payee_key = pay.expense_payee_key "
queryGroupByVP = queryGroupByVP & "AND gd.GROUP_CODE = groupdescr.GROUP_CODE "
queryGroupByVP = queryGroupByVP & "AND gd.group_field_c  =  m.DIVISION_CODE "
queryGroupByVP = queryGroupByVP & "AND sc.spend_base_seq <> 0 "
queryGroupByVP = queryGroupByVP & "AND sc.spend_subcategory_seq <> 0 "
queryGroupByVP = queryGroupByVP & "AND (mpbd.business_division_code IN ('F01', 'F03', 'F04', 'F08', 'F15')) "
queryGroupByVP = queryGroupByVP & "AND (m.selling_group_code IN ('119000', '125000', '610000', '800000', '423000')) "
queryGroupByVP = queryGroupByVP & "AND (md.year_descr IN (:p_year)) "
queryGroupByVP = queryGroupByVP & "and md.fiscal_month_number <= :p_Month "
queryGroupByVP = queryGroupByVP & "AND (mpbd.business_division_code IN (:p_businessdivision)) "
queryGroupByVP = queryGroupByVP & "AND (m.division_code IN (:p_salesdivision)) "
queryGroupByVP = queryGroupByVP & "AND (m.region_code IN (:p_salesregion)) "
queryGroupByVP = queryGroupByVP & "AND (m.primary_broker_code IN (:p_primarybroker)) "
queryGroupByVP = queryGroupByVP & "AND gd.GROUP_CODE in (:vp) "
queryGroupByVP = queryGroupByVP & "GROUP BY  "
queryGroupByVP = queryGroupByVP & "gd.GROUP_CODE, "
queryGroupByVP = queryGroupByVP & "groupdescr.GROUP_DESCR, "
queryGroupByVP = queryGroupByVP & "mpbd.business_division_code, "
queryGroupByVP = queryGroupByVP & "'Total Market/CVP', "
queryGroupByVP = queryGroupByVP & "sc.spend_base_descr, "
queryGroupByVP = queryGroupByVP & "sc.spend_base_seq, "
queryGroupByVP = queryGroupByVP & "sc.spend_subcategory_descr, "
queryGroupByVP = queryGroupByVP & "sc.spend_subcategory_seq, "
queryGroupByVP = queryGroupByVP & "md.year_descr, "
queryGroupByVP = queryGroupByVP & "md.month_descr, "
queryGroupByVP = queryGroupByVP & "md.FISCAL_MONTH_NUMBER, "
queryGroupByVP = queryGroupByVP & "mpbd.business_division_Descr "
queryGroupByVP = queryGroupByVP & "--Begin Expense TotalCustomer "
queryGroupByVP = queryGroupByVP & "UNION "
queryGroupByVP = queryGroupByVP & "SELECT    "
queryGroupByVP = queryGroupByVP & "CASE WHEN (sc.spend_base_seq IN (1, 2, 3, 4, 5))THEN 'Distributor' "
queryGroupByVP = queryGroupByVP & "     WHEN (sc.spend_base_seq = 6)THEN 'Operator' "
queryGroupByVP = queryGroupByVP & "END AS businessunit, "
queryGroupByVP = queryGroupByVP & "CASE WHEN (md.FISCAL_MONTH_NUMBER = (:p_Month))THEN SUM (epf.expense_amt) "
queryGroupByVP = queryGroupByVP & "END AS monthexpense_amt, "
queryGroupByVP = queryGroupByVP & "0 AS monthpounds, "
queryGroupByVP = queryGroupByVP & "0 AS monthnetreceivables, "
queryGroupByVP = queryGroupByVP & "gd.GROUP_CODE, "
queryGroupByVP = queryGroupByVP & "groupdescr.GROUP_DESCR, "
queryGroupByVP = queryGroupByVP & "mpbd.business_division_code, "
queryGroupByVP = queryGroupByVP & "'Total Customer' AS businessdivisiondescr, "
queryGroupByVP = queryGroupByVP & "sc.spend_base_descr, "
queryGroupByVP = queryGroupByVP & "sc.spend_base_seq, "
queryGroupByVP = queryGroupByVP & "sc.spend_subcategory_descr, "
queryGroupByVP = queryGroupByVP & "sc.spend_subcategory_seq, "
queryGroupByVP = queryGroupByVP & "md.year_descr, "
queryGroupByVP = queryGroupByVP & "md.month_descr, "
queryGroupByVP = queryGroupByVP & "SUM (epf.expense_amt) AS expense_amt, "
queryGroupByVP = queryGroupByVP & "0 AS total_pounds_shipped, "
queryGroupByVP = queryGroupByVP & "0 AS net_receivable_dollar "
queryGroupByVP = queryGroupByVP & "FROM tdw_owner.restated_mkt_prd_bus_div_dim mpbd, "
queryGroupByVP = queryGroupByVP & "tdw_owner.expense_payment_fact epf, "
queryGroupByVP = queryGroupByVP & "tdw_owner.fsv_spend_category sc, "
queryGroupByVP = queryGroupByVP & "tdw_owner.restated_market m, "
queryGroupByVP = queryGroupByVP & "tdw_owner.month_dim md, "
queryGroupByVP = queryGroupByVP & "tdw_owner.restated_product p, "
queryGroupByVP = queryGroupByVP & "tdw_owner.acct_dim a, "
queryGroupByVP = queryGroupByVP & "tdw_owner.expense_type et, "
queryGroupByVP = queryGroupByVP & "tdw_owner.spend_request_dim s, "
queryGroupByVP = queryGroupByVP & "tdw_owner.operator_dim o, "
queryGroupByVP = queryGroupByVP & "tdw_owner.day_dim d1, "
queryGroupByVP = queryGroupByVP & "tdw_owner.day_dim d2, "
queryGroupByVP = queryGroupByVP & "tdw_owner.expense_attribute_dim ead, "
queryGroupByVP = queryGroupByVP & "tdw_owner.expense_payee_dim pay, "
queryGroupByVP = queryGroupByVP & "tdw_owner.group_detail gd, "
queryGroupByVP = queryGroupByVP & "tdw_owner.group_description groupdescr "
queryGroupByVP = queryGroupByVP & "WHERE mpbd.restated_mkt_prd_bus_div_key = epf.restated_mkt_prd_bus_div_key "
queryGroupByVP = queryGroupByVP & "AND epf.expense_type_key = sc.expense_type_key "
queryGroupByVP = queryGroupByVP & "AND epf.acct_key = sc.acct_key "
queryGroupByVP = queryGroupByVP & "AND epf.restated_market_key = m.restated_market_key "
queryGroupByVP = queryGroupByVP & "AND epf.month_key = md.month_key "
queryGroupByVP = queryGroupByVP & "AND epf.restated_product_key = p.restated_product_key "
queryGroupByVP = queryGroupByVP & "AND epf.acct_key = a.acct_key "
queryGroupByVP = queryGroupByVP & "AND epf.expense_type_key = et.expense_type_key "
queryGroupByVP = queryGroupByVP & "AND epf.spend_request_key = s.spend_request_key "
queryGroupByVP = queryGroupByVP & "AND epf.operator_key = o.operator_key "
queryGroupByVP = queryGroupByVP & "AND epf.report_period_begin_day_key = d1.day_key "
queryGroupByVP = queryGroupByVP & "AND epf.report_period_end_day_key = d2.day_key "
queryGroupByVP = queryGroupByVP & "AND epf.expense_attribute_key = ead.expense_attribute_key "
queryGroupByVP = queryGroupByVP & "AND epf.expense_payee_key = pay.expense_payee_key "
queryGroupByVP = queryGroupByVP & "AND gd.GROUP_CODE = groupdescr.GROUP_CODE "
queryGroupByVP = queryGroupByVP & "AND gd.group_field_c  =  m.DIVISION_CODE "
queryGroupByVP = queryGroupByVP & "AND sc.spend_base_seq <> 0 "
queryGroupByVP = queryGroupByVP & "AND sc.spend_subcategory_seq <> 0 "
queryGroupByVP = queryGroupByVP & "AND (mpbd.business_division_code IN ('F01', 'F03', 'F04', 'F08', 'F15')) "
queryGroupByVP = queryGroupByVP & "AND (m.selling_group_code IN ('119000', '125000', '610000', '800000', '423000')) "
queryGroupByVP = queryGroupByVP & "AND (md.year_descr IN (:p_year)) "
queryGroupByVP = queryGroupByVP & "and md.fiscal_month_number <= :p_Month "
queryGroupByVP = queryGroupByVP & "AND (mpbd.business_division_code IN (:p_businessdivision)) "
queryGroupByVP = queryGroupByVP & "AND (m.division_code IN (:p_salesdivision)) "
queryGroupByVP = queryGroupByVP & "AND (m.region_code IN (:p_salesregion)) "
queryGroupByVP = queryGroupByVP & "AND (m.primary_broker_code IN (:p_primarybroker)) "
queryGroupByVP = queryGroupByVP & "AND gd.GROUP_CODE in (:vp) "
queryGroupByVP = queryGroupByVP & "GROUP BY  "
queryGroupByVP = queryGroupByVP & "gd.GROUP_CODE, "
queryGroupByVP = queryGroupByVP & "groupdescr.GROUP_DESCR, "
queryGroupByVP = queryGroupByVP & "mpbd.business_division_code, "
queryGroupByVP = queryGroupByVP & "'Total Customer', "
queryGroupByVP = queryGroupByVP & "sc.spend_base_descr, "
queryGroupByVP = queryGroupByVP & "sc.spend_base_seq, "
queryGroupByVP = queryGroupByVP & "sc.spend_subcategory_descr, "
queryGroupByVP = queryGroupByVP & "sc.spend_subcategory_seq, "
queryGroupByVP = queryGroupByVP & "md.year_descr, "
queryGroupByVP = queryGroupByVP & "md.month_descr, "
queryGroupByVP = queryGroupByVP & "md.FISCAL_MONTH_NUMBER, "
queryGroupByVP = queryGroupByVP & "mpbd.business_division_Descr "
queryGroupByVP = queryGroupByVP & " "
queryGroupByVP = queryGroupByVP & "--Begin Volume "
queryGroupByVP = queryGroupByVP & "UNION "
queryGroupByVP = queryGroupByVP & "SELECT   'zzz' AS businessunit, "
queryGroupByVP = queryGroupByVP & "0 AS monthexpense_amt, "
queryGroupByVP = queryGroupByVP & "CASE WHEN (ids_mf.FISCAL_MONTH_NUMBER = (:p_Month)) "
queryGroupByVP = queryGroupByVP & "     THEN SUM (  ids_mf.mf_pounds_shipped "
queryGroupByVP = queryGroupByVP & "               + ids_mf.mf_adjusted_pounds_shipped "
queryGroupByVP = queryGroupByVP & "                + ids_mf.ids_pounds_shipped) "
queryGroupByVP = queryGroupByVP & "END AS monthpounds, "
queryGroupByVP = queryGroupByVP & "CASE WHEN (ids_mf.FISCAL_MONTH_NUMBER = (:p_Month)) "
queryGroupByVP = queryGroupByVP & "     THEN SUM (  ids_mf.mf_gross_sales_amount "
queryGroupByVP = queryGroupByVP & "               - ids_mf.mf_allow_amount "
queryGroupByVP = queryGroupByVP & "               - ids_mf.mf_off_invoice_amount "
queryGroupByVP = queryGroupByVP & "               + ids_mf.mf_revenue_adjustment "
queryGroupByVP = queryGroupByVP & "               + ids_mf.ids_indirect_sales_amount) "
queryGroupByVP = queryGroupByVP & "END AS monthnetreceivables, "
queryGroupByVP = queryGroupByVP & "gd.GROUP_CODE, "
queryGroupByVP = queryGroupByVP & "groupdescr.GROUP_DESCR, "
queryGroupByVP = queryGroupByVP & "mpbd.business_division_code, "
queryGroupByVP = queryGroupByVP & "INITCAP (mpbd.business_division_descr) AS businessdivisiondescr, "
queryGroupByVP = queryGroupByVP & "NULL AS spend_base_descr, "
queryGroupByVP = queryGroupByVP & "NULL AS spend_base_seq, "
queryGroupByVP = queryGroupByVP & "NULL AS spend_subcategory_descr, "
queryGroupByVP = queryGroupByVP & "NULL AS spend_subcategory_seq, "
queryGroupByVP = queryGroupByVP & "ids_mf.year_descr, "
queryGroupByVP = queryGroupByVP & "ids_mf.month_descr, "
queryGroupByVP = queryGroupByVP & "0 AS expense_amt, "
queryGroupByVP = queryGroupByVP & "SUM (  ids_mf.mf_pounds_shipped "
queryGroupByVP = queryGroupByVP & "       + ids_mf.mf_adjusted_pounds_shipped "
queryGroupByVP = queryGroupByVP & "       + ids_mf.ids_pounds_shipped "
queryGroupByVP = queryGroupByVP & "       ) AS total_pounds_shipped, "
queryGroupByVP = queryGroupByVP & "SUM (  ids_mf.mf_gross_sales_amount "
queryGroupByVP = queryGroupByVP & "       - ids_mf.mf_allow_amount "
queryGroupByVP = queryGroupByVP & "       - ids_mf.mf_off_invoice_amount "
queryGroupByVP = queryGroupByVP & "       + ids_mf.mf_revenue_adjustment "
queryGroupByVP = queryGroupByVP & "       + ids_mf.ids_indirect_sales_amount "
queryGroupByVP = queryGroupByVP & "       ) AS net_receivable_dollar "
queryGroupByVP = queryGroupByVP & "FROM (SELECT   mpbd1.business_division_code, "
queryGroupByVP = queryGroupByVP & "mpbd1.business_division_descr, "
queryGroupByVP = queryGroupByVP & "mpbd1.restated_market_key, "
queryGroupByVP = queryGroupByVP & "mpbd1.restated_product_key, "
queryGroupByVP = queryGroupByVP & "md1.year_descr, "
queryGroupByVP = queryGroupByVP & "md1.month_descr, "
queryGroupByVP = queryGroupByVP & "md1.FISCAL_MONTH_NUMBER, "
queryGroupByVP = queryGroupByVP & "SUM (mf.pounds_shipped) AS mf_pounds_shipped, "
queryGroupByVP = queryGroupByVP & "SUM (mf.adj_pounds_shipped) AS mf_adjusted_pounds_shipped, "
queryGroupByVP = queryGroupByVP & "SUM (mf.gross_sales_amount) AS mf_gross_sales_amount, "
queryGroupByVP = queryGroupByVP & "SUM (mf.allow_amount) AS mf_allow_amount, "
queryGroupByVP = queryGroupByVP & "SUM (mf.revenue_adjustment) AS mf_revenue_adjustment, "
queryGroupByVP = queryGroupByVP & "SUM (mf.off_invoice_amount) AS mf_off_invoice_amount, "
queryGroupByVP = queryGroupByVP & "0 AS ids_pounds_shipped, "
queryGroupByVP = queryGroupByVP & "0 AS ids_indirect_sales_amount "
queryGroupByVP = queryGroupByVP & "FROM tdw_owner.restated_mkt_prd_bus_div_dim mpbd1, "
queryGroupByVP = queryGroupByVP & "tdw_owner.restated_market m1, "
queryGroupByVP = queryGroupByVP & "tdw_owner.month_dim md1, "
queryGroupByVP = queryGroupByVP & "tdw_owner.restated_product p1, "
queryGroupByVP = queryGroupByVP & "tdw_owner.day_dim d1, "
queryGroupByVP = queryGroupByVP & "tdw_owner.margin_fact mf, "
queryGroupByVP = queryGroupByVP & "tdw_owner.group_detail gd, "
queryGroupByVP = queryGroupByVP & "tdw_owner.group_description groupdescr "
queryGroupByVP = queryGroupByVP & "WHERE mf.restated_market_key = m1.restated_market_key "
queryGroupByVP = queryGroupByVP & "AND mf.restated_product_key = p1.restated_product_key "
queryGroupByVP = queryGroupByVP & "AND mf.restated_market_key = mpbd1.restated_market_key "
queryGroupByVP = queryGroupByVP & "AND mf.restated_product_key = mpbd1.restated_product_key "
queryGroupByVP = queryGroupByVP & "AND mf.invoice_day_key = d1.day_key "
queryGroupByVP = queryGroupByVP & "AND d1.month_ending_date = md1.month_ending_date "
queryGroupByVP = queryGroupByVP & "AND gd.GROUP_CODE = groupdescr.GROUP_CODE "
queryGroupByVP = queryGroupByVP & "AND gd.group_field_c  =  m1.DIVISION_CODE "
queryGroupByVP = queryGroupByVP & "AND (mpbd1.business_division_code IN ('F01', 'F03', 'F04', 'F08', 'F15')) "
queryGroupByVP = queryGroupByVP & "AND (m1.selling_group_code IN ('119000', '125000', '610000', '800000', '423000')) "
queryGroupByVP = queryGroupByVP & "AND (md1.year_descr IN (:p_year)) "
queryGroupByVP = queryGroupByVP & "and md1.fiscal_month_number <= :p_Month "
queryGroupByVP = queryGroupByVP & "AND (mpbd1.business_division_code IN (:p_businessdivision)) "
queryGroupByVP = queryGroupByVP & "AND (m1.division_code IN (:p_salesdivision)) "
queryGroupByVP = queryGroupByVP & "AND (m1.region_code IN (:p_salesregion)) "
queryGroupByVP = queryGroupByVP & "AND (m1.primary_broker_code IN (:p_primarybroker)) "
queryGroupByVP = queryGroupByVP & "AND gd.GROUP_CODE in (:vp) "
queryGroupByVP = queryGroupByVP & "GROUP BY mpbd1.business_division_code, "
queryGroupByVP = queryGroupByVP & "mpbd1.business_division_descr, "
queryGroupByVP = queryGroupByVP & "mpbd1.restated_market_key, "
queryGroupByVP = queryGroupByVP & "mpbd1.restated_product_key, "
queryGroupByVP = queryGroupByVP & "md1.year_descr, "
queryGroupByVP = queryGroupByVP & "md1.month_descr, "
queryGroupByVP = queryGroupByVP & "md1.FISCAL_MONTH_NUMBER "
queryGroupByVP = queryGroupByVP & "UNION "
queryGroupByVP = queryGroupByVP & "SELECT   /*+ RULE */ "
queryGroupByVP = queryGroupByVP & "mpbd1.business_division_code, "
queryGroupByVP = queryGroupByVP & "mpbd1.business_division_descr, "
queryGroupByVP = queryGroupByVP & "mpbd1.restated_market_key, "
queryGroupByVP = queryGroupByVP & "mpbd1.restated_product_key, "
queryGroupByVP = queryGroupByVP & "md1.year_descr, "
queryGroupByVP = queryGroupByVP & "md1.month_descr, "
queryGroupByVP = queryGroupByVP & "md1.FISCAL_MONTH_NUMBER, "
queryGroupByVP = queryGroupByVP & "0 AS mf_pounds_shipped, "
queryGroupByVP = queryGroupByVP & "0 AS mf_adjusted_pounds_shipped, "
queryGroupByVP = queryGroupByVP & "0 AS mf_gross_sales_amount, "
queryGroupByVP = queryGroupByVP & "0 AS mf_allow_amount, "
queryGroupByVP = queryGroupByVP & "0 AS mf_revenue_adjustment, "
queryGroupByVP = queryGroupByVP & "0 AS mf_off_invoice_amount, "
queryGroupByVP = queryGroupByVP & "SUM (ids.pounds_shipped) AS ids_pounds_shipped, "
queryGroupByVP = queryGroupByVP & "SUM (ids.indirect_sales_amount)AS ids_indirect_sales_amount "
queryGroupByVP = queryGroupByVP & "FROM tdw_owner.restated_mkt_prd_bus_div_dim mpbd1, "
queryGroupByVP = queryGroupByVP & "tdw_owner.restated_market m1, "
queryGroupByVP = queryGroupByVP & "tdw_owner.month_dim md1, "
queryGroupByVP = queryGroupByVP & "tdw_owner.restated_product p1, "
queryGroupByVP = queryGroupByVP & "tdw_owner.indirect_sales ids, "
queryGroupByVP = queryGroupByVP & "tdw_owner.week_dim w1, "
queryGroupByVP = queryGroupByVP & "tdw_owner.group_detail gd, "
queryGroupByVP = queryGroupByVP & "tdw_owner.group_description groupdescr "
queryGroupByVP = queryGroupByVP & "WHERE ids.restated_market_key = m1.restated_market_key "
queryGroupByVP = queryGroupByVP & "AND ids.restated_product_key = p1.restated_product_key "
queryGroupByVP = queryGroupByVP & "AND ids.restated_market_key = mpbd1.restated_market_key "
queryGroupByVP = queryGroupByVP & "AND ids.restated_product_key = mpbd1.restated_product_key "
queryGroupByVP = queryGroupByVP & "AND ids.week_key = w1.week_key "
queryGroupByVP = queryGroupByVP & "AND w1.month_ending_date = md1.month_ending_date "
queryGroupByVP = queryGroupByVP & "AND gd.GROUP_CODE = groupdescr.GROUP_CODE "
queryGroupByVP = queryGroupByVP & "AND gd.group_field_c  =  m1.DIVISION_CODE "
queryGroupByVP = queryGroupByVP & "AND (mpbd1.business_division_code IN ('F01', 'F03', 'F04', 'F08', 'F15')) "
queryGroupByVP = queryGroupByVP & "AND (m1.selling_group_code IN ('119000', '125000', '610000', '800000', '423000')) "
queryGroupByVP = queryGroupByVP & "AND (md1.year_descr IN (:p_year)) "
queryGroupByVP = queryGroupByVP & "and md1.fiscal_month_number <= :p_Month "
queryGroupByVP = queryGroupByVP & "AND (mpbd1.business_division_code IN (:p_businessdivision)) "
queryGroupByVP = queryGroupByVP & "AND (m1.division_code IN (:p_salesdivision)) "
queryGroupByVP = queryGroupByVP & "AND (m1.region_code IN (:p_salesregion)) "
queryGroupByVP = queryGroupByVP & "AND (m1.primary_broker_code IN (:p_primarybroker)) "
queryGroupByVP = queryGroupByVP & "AND gd.GROUP_CODE in (:vp) "
queryGroupByVP = queryGroupByVP & "GROUP BY mpbd1.business_division_code, "
queryGroupByVP = queryGroupByVP & "mpbd1.business_division_descr, "
queryGroupByVP = queryGroupByVP & "mpbd1.restated_market_key, "
queryGroupByVP = queryGroupByVP & "mpbd1.restated_product_key, "
queryGroupByVP = queryGroupByVP & "md1.year_descr, "
queryGroupByVP = queryGroupByVP & "md1.month_descr, "
queryGroupByVP = queryGroupByVP & "md1.FISCAL_MONTH_NUMBER "
queryGroupByVP = queryGroupByVP & ")--end sub queryGroupByVP "
queryGroupByVP = queryGroupByVP & "   ids_mf, "
queryGroupByVP = queryGroupByVP & "tdw_owner.restated_mkt_prd_bus_div_dim mpbd, "
queryGroupByVP = queryGroupByVP & "tdw_owner.restated_market m, "
queryGroupByVP = queryGroupByVP & "tdw_owner.restated_product p, "
queryGroupByVP = queryGroupByVP & "tdw_owner.group_detail gd, "
queryGroupByVP = queryGroupByVP & "tdw_owner.group_description groupdescr "
queryGroupByVP = queryGroupByVP & "WHERE ids_mf.restated_market_key = mpbd.restated_market_key "
queryGroupByVP = queryGroupByVP & "AND ids_mf.restated_product_key = mpbd.restated_product_key "
queryGroupByVP = queryGroupByVP & "AND ids_mf.restated_market_key = m.restated_market_key "
queryGroupByVP = queryGroupByVP & "AND ids_mf.restated_product_key = p.restated_product_key "
queryGroupByVP = queryGroupByVP & "AND gd.GROUP_CODE = groupdescr.GROUP_CODE "
queryGroupByVP = queryGroupByVP & "AND gd.group_field_c  =  m.DIVISION_CODE "
queryGroupByVP = queryGroupByVP & "AND (mpbd.business_division_code IN ('F01', 'F03', 'F04', 'F08', 'F15')) "
queryGroupByVP = queryGroupByVP & "AND (m.selling_group_code IN ('119000', '125000', '610000', '800000', '423000')) "
queryGroupByVP = queryGroupByVP & "AND (ids_mf.year_descr IN (:p_year)) "
queryGroupByVP = queryGroupByVP & "and ids_mf.fiscal_month_number <= :p_Month "
queryGroupByVP = queryGroupByVP & "AND (mpbd.business_division_code IN (:p_businessdivision)) "
queryGroupByVP = queryGroupByVP & "AND (m.division_code IN (:p_salesdivision)) "
queryGroupByVP = queryGroupByVP & "AND (m.region_code IN (:p_salesregion)) "
queryGroupByVP = queryGroupByVP & "AND (m.primary_broker_code IN (:p_primarybroker)) "
queryGroupByVP = queryGroupByVP & "AND gd.GROUP_CODE in (:vp) "
queryGroupByVP = queryGroupByVP & "GROUP BY  "
queryGroupByVP = queryGroupByVP & "gd.GROUP_CODE, "
queryGroupByVP = queryGroupByVP & "groupdescr.GROUP_DESCR, "
queryGroupByVP = queryGroupByVP & "'zzz', "
queryGroupByVP = queryGroupByVP & "mpbd.business_division_code, "
queryGroupByVP = queryGroupByVP & "INITCAP (mpbd.business_division_descr), "
queryGroupByVP = queryGroupByVP & "ids_mf.year_descr, "
queryGroupByVP = queryGroupByVP & "ids_mf.month_descr, "
queryGroupByVP = queryGroupByVP & "ids_mf.FISCAL_MONTH_NUMBER, "
queryGroupByVP = queryGroupByVP & "mpbd.business_division_Descr "
queryGroupByVP = queryGroupByVP & "--Begin Volume 'Total Value Added' "
queryGroupByVP = queryGroupByVP & "UNION "
queryGroupByVP = queryGroupByVP & "SELECT    "
queryGroupByVP = queryGroupByVP & "'zzz' AS businessunit, "
queryGroupByVP = queryGroupByVP & "0 AS monthexpense_amt, "
queryGroupByVP = queryGroupByVP & "CASE WHEN (ids_mf.FISCAL_MONTH_NUMBER = (:p_Month)) "
queryGroupByVP = queryGroupByVP & "     THEN SUM (  ids_mf.mf_pounds_shipped "
queryGroupByVP = queryGroupByVP & "               + ids_mf.mf_adjusted_pounds_shipped "
queryGroupByVP = queryGroupByVP & "               + ids_mf.ids_pounds_shipped) "
queryGroupByVP = queryGroupByVP & "END AS monthpounds, "
queryGroupByVP = queryGroupByVP & "CASE WHEN (ids_mf.FISCAL_MONTH_NUMBER = (:p_Month)) "
queryGroupByVP = queryGroupByVP & "     THEN SUM (  ids_mf.mf_gross_sales_amount "
queryGroupByVP = queryGroupByVP & "               - ids_mf.mf_allow_amount "
queryGroupByVP = queryGroupByVP & "               - ids_mf.mf_off_invoice_amount "
queryGroupByVP = queryGroupByVP & "                 + ids_mf.mf_revenue_adjustment "
queryGroupByVP = queryGroupByVP & "               + ids_mf.ids_indirect_sales_amount) "
queryGroupByVP = queryGroupByVP & "END AS monthnetreceivables, "
queryGroupByVP = queryGroupByVP & "gd.GROUP_CODE, "
queryGroupByVP = queryGroupByVP & "groupdescr.GROUP_DESCR, "
queryGroupByVP = queryGroupByVP & "mpbd.business_division_code, "
queryGroupByVP = queryGroupByVP & "'Total Value Added' AS businessdivisiondescr, "
queryGroupByVP = queryGroupByVP & "NULL AS spend_base_descr, "
queryGroupByVP = queryGroupByVP & "NULL AS spend_base_seq, "
queryGroupByVP = queryGroupByVP & "NULL AS spend_subcategory_descr, "
queryGroupByVP = queryGroupByVP & "NULL AS spend_subcategory_seq, "
queryGroupByVP = queryGroupByVP & "ids_mf.year_descr, "
queryGroupByVP = queryGroupByVP & "ids_mf.month_descr, "
queryGroupByVP = queryGroupByVP & "0 AS expense_amt, "
queryGroupByVP = queryGroupByVP & "SUM (  ids_mf.mf_pounds_shipped "
queryGroupByVP = queryGroupByVP & "        + ids_mf.mf_adjusted_pounds_shipped "
queryGroupByVP = queryGroupByVP & "        + ids_mf.ids_pounds_shipped "
queryGroupByVP = queryGroupByVP & "        ) AS total_pounds_shipped, "
queryGroupByVP = queryGroupByVP & "SUM (  ids_mf.mf_gross_sales_amount "
queryGroupByVP = queryGroupByVP & "       - ids_mf.mf_allow_amount "
queryGroupByVP = queryGroupByVP & "       - ids_mf.mf_off_invoice_amount "
queryGroupByVP = queryGroupByVP & "       + ids_mf.mf_revenue_adjustment "
queryGroupByVP = queryGroupByVP & "       + ids_mf.ids_indirect_sales_amount "
queryGroupByVP = queryGroupByVP & "       ) AS net_receivable_dollar "
queryGroupByVP = queryGroupByVP & "FROM ( "
queryGroupByVP = queryGroupByVP & "--Begin sub queryGroupByVP "
queryGroupByVP = queryGroupByVP & "SELECT   mpbd1.business_division_code, "
queryGroupByVP = queryGroupByVP & "mpbd1.business_division_descr, "
queryGroupByVP = queryGroupByVP & "mpbd1.restated_market_key, "
queryGroupByVP = queryGroupByVP & "mpbd1.restated_product_key, "
queryGroupByVP = queryGroupByVP & "md1.year_descr, "
queryGroupByVP = queryGroupByVP & "md1.month_descr, "
queryGroupByVP = queryGroupByVP & "md1.FISCAL_MONTH_NUMBER, "
queryGroupByVP = queryGroupByVP & "SUM (mf.pounds_shipped) AS mf_pounds_shipped, "
queryGroupByVP = queryGroupByVP & "SUM (mf.adj_pounds_shipped) AS mf_adjusted_pounds_shipped, "
queryGroupByVP = queryGroupByVP & "SUM (mf.gross_sales_amount) AS mf_gross_sales_amount, "
queryGroupByVP = queryGroupByVP & "SUM (mf.allow_amount) AS mf_allow_amount, "
queryGroupByVP = queryGroupByVP & "SUM (mf.revenue_adjustment) AS mf_revenue_adjustment, "
queryGroupByVP = queryGroupByVP & "SUM (mf.off_invoice_amount) AS mf_off_invoice_amount, "
queryGroupByVP = queryGroupByVP & "0 AS ids_pounds_shipped, "
queryGroupByVP = queryGroupByVP & "0 AS ids_indirect_sales_amount "
queryGroupByVP = queryGroupByVP & "FROM tdw_owner.restated_mkt_prd_bus_div_dim mpbd1, "
queryGroupByVP = queryGroupByVP & "tdw_owner.restated_market m1, "
queryGroupByVP = queryGroupByVP & "tdw_owner.month_dim md1, "
queryGroupByVP = queryGroupByVP & "tdw_owner.restated_product p1, "
queryGroupByVP = queryGroupByVP & "tdw_owner.day_dim d1, "
queryGroupByVP = queryGroupByVP & "tdw_owner.margin_fact mf, "
queryGroupByVP = queryGroupByVP & "tdw_owner.group_detail gd, "
queryGroupByVP = queryGroupByVP & "tdw_owner.group_description groupdescr "
queryGroupByVP = queryGroupByVP & "WHERE mf.restated_market_key = m1.restated_market_key "
queryGroupByVP = queryGroupByVP & "AND mf.restated_product_key = p1.restated_product_key "
queryGroupByVP = queryGroupByVP & "AND mf.restated_market_key = mpbd1.restated_market_key "
queryGroupByVP = queryGroupByVP & "AND mf.restated_product_key = mpbd1.restated_product_key "
queryGroupByVP = queryGroupByVP & "AND mf.invoice_day_key = d1.day_key "
queryGroupByVP = queryGroupByVP & "AND d1.month_ending_date = md1.month_ending_date "
queryGroupByVP = queryGroupByVP & "AND gd.GROUP_CODE = groupdescr.GROUP_CODE "
queryGroupByVP = queryGroupByVP & "AND gd.group_field_c  =  m1.DIVISION_CODE "
queryGroupByVP = queryGroupByVP & "AND (mpbd1.business_division_code IN ('F01', 'F08', 'F15')) "
queryGroupByVP = queryGroupByVP & "AND (m1.selling_group_code IN ('119000', '125000', '610000', '800000', '423000')) "
queryGroupByVP = queryGroupByVP & "AND (md1.year_descr IN (:p_year)) "
queryGroupByVP = queryGroupByVP & "and md1.fiscal_month_number <= :p_Month "
queryGroupByVP = queryGroupByVP & "AND (mpbd1.business_division_code IN (:p_businessdivision)) "
queryGroupByVP = queryGroupByVP & "AND (m1.division_code IN (:p_salesdivision)) "
queryGroupByVP = queryGroupByVP & "AND (m1.region_code IN (:p_salesregion)) "
queryGroupByVP = queryGroupByVP & "AND (m1.primary_broker_code IN (:p_primarybroker)) "
queryGroupByVP = queryGroupByVP & "AND gd.GROUP_CODE in (:vp) "
queryGroupByVP = queryGroupByVP & "GROUP BY mpbd1.business_division_code, "
queryGroupByVP = queryGroupByVP & "mpbd1.business_division_descr, "
queryGroupByVP = queryGroupByVP & "mpbd1.restated_market_key, "
queryGroupByVP = queryGroupByVP & "mpbd1.restated_product_key, "
queryGroupByVP = queryGroupByVP & "md1.year_descr, "
queryGroupByVP = queryGroupByVP & "md1.month_descr, "
queryGroupByVP = queryGroupByVP & "md1.FISCAL_MONTH_NUMBER "
queryGroupByVP = queryGroupByVP & "UNION "
queryGroupByVP = queryGroupByVP & "SELECT   /*+ RULE */ "
queryGroupByVP = queryGroupByVP & "mpbd1.business_division_code, "
queryGroupByVP = queryGroupByVP & "mpbd1.business_division_descr, "
queryGroupByVP = queryGroupByVP & "mpbd1.restated_market_key, "
queryGroupByVP = queryGroupByVP & "mpbd1.restated_product_key, "
queryGroupByVP = queryGroupByVP & "md1.year_descr, "
queryGroupByVP = queryGroupByVP & "md1.month_descr, "
queryGroupByVP = queryGroupByVP & "md1.FISCAL_MONTH_NUMBER, "
queryGroupByVP = queryGroupByVP & "0 AS mf_pounds_shipped, "
queryGroupByVP = queryGroupByVP & "0 AS mf_adjusted_pounds_shipped, "
queryGroupByVP = queryGroupByVP & "0 AS mf_gross_sales_amount, "
queryGroupByVP = queryGroupByVP & "0 AS mf_allow_amount, "
queryGroupByVP = queryGroupByVP & "0 AS mf_revenue_adjustment, "
queryGroupByVP = queryGroupByVP & "0 AS mf_off_invoice_amount, "
queryGroupByVP = queryGroupByVP & "SUM (ids.pounds_shipped) AS ids_pounds_shipped, "
queryGroupByVP = queryGroupByVP & "SUM (ids.indirect_sales_amount)AS ids_indirect_sales_amount "
queryGroupByVP = queryGroupByVP & "FROM tdw_owner.restated_mkt_prd_bus_div_dim mpbd1, "
queryGroupByVP = queryGroupByVP & "tdw_owner.restated_market m1, "
queryGroupByVP = queryGroupByVP & "tdw_owner.month_dim md1, "
queryGroupByVP = queryGroupByVP & "tdw_owner.restated_product p1, "
queryGroupByVP = queryGroupByVP & "tdw_owner.indirect_sales ids, "
queryGroupByVP = queryGroupByVP & "tdw_owner.week_dim w1, "
queryGroupByVP = queryGroupByVP & "tdw_owner.group_detail gd, "
queryGroupByVP = queryGroupByVP & "tdw_owner.group_description groupdescr "
queryGroupByVP = queryGroupByVP & "WHERE ids.restated_market_key = m1.restated_market_key "
queryGroupByVP = queryGroupByVP & "AND ids.restated_product_key = p1.restated_product_key "
queryGroupByVP = queryGroupByVP & "AND ids.restated_market_key = mpbd1.restated_market_key "
queryGroupByVP = queryGroupByVP & "AND ids.restated_product_key = mpbd1.restated_product_key "
queryGroupByVP = queryGroupByVP & "AND ids.week_key = w1.week_key "
queryGroupByVP = queryGroupByVP & "AND w1.month_ending_date = md1.month_ending_date "
queryGroupByVP = queryGroupByVP & "AND gd.GROUP_CODE = groupdescr.GROUP_CODE "
queryGroupByVP = queryGroupByVP & "AND gd.group_field_c  =  m1.DIVISION_CODE "
queryGroupByVP = queryGroupByVP & "AND (mpbd1.business_division_code IN ('F01', 'F08', 'F15')) "
queryGroupByVP = queryGroupByVP & "AND (m1.selling_group_code IN ('119000', '125000', '610000', '800000', '423000')) "
queryGroupByVP = queryGroupByVP & "AND (md1.year_descr IN (:p_year)) "
queryGroupByVP = queryGroupByVP & "and md1.fiscal_month_number <= :p_Month "
queryGroupByVP = queryGroupByVP & "AND (mpbd1.business_division_code IN (:p_businessdivision)) "
queryGroupByVP = queryGroupByVP & "AND (m1.division_code IN (:p_salesdivision)) "
queryGroupByVP = queryGroupByVP & "AND (m1.region_code IN (:p_salesregion)) "
queryGroupByVP = queryGroupByVP & "AND (m1.primary_broker_code IN (:p_primarybroker)) "
queryGroupByVP = queryGroupByVP & "AND gd.GROUP_CODE in (:vp) "
queryGroupByVP = queryGroupByVP & "GROUP BY mpbd1.business_division_code, "
queryGroupByVP = queryGroupByVP & "mpbd1.business_division_descr, "
queryGroupByVP = queryGroupByVP & "mpbd1.restated_market_key, "
queryGroupByVP = queryGroupByVP & "mpbd1.restated_product_key, "
queryGroupByVP = queryGroupByVP & "md1.year_descr, "
queryGroupByVP = queryGroupByVP & "md1.month_descr, "
queryGroupByVP = queryGroupByVP & "md1.FISCAL_MONTH_NUMBER "
queryGroupByVP = queryGroupByVP & ") --end sub queryGroupByVP "
queryGroupByVP = queryGroupByVP & "   ids_mf, "
queryGroupByVP = queryGroupByVP & "tdw_owner.restated_mkt_prd_bus_div_dim mpbd, "
queryGroupByVP = queryGroupByVP & "tdw_owner.restated_market m, "
queryGroupByVP = queryGroupByVP & "tdw_owner.restated_product p, "
queryGroupByVP = queryGroupByVP & "tdw_owner.group_detail gd, "
queryGroupByVP = queryGroupByVP & "tdw_owner.group_description groupdescr "
queryGroupByVP = queryGroupByVP & "WHERE ids_mf.restated_market_key = mpbd.restated_market_key "
queryGroupByVP = queryGroupByVP & "AND ids_mf.restated_product_key = mpbd.restated_product_key "
queryGroupByVP = queryGroupByVP & "AND ids_mf.restated_market_key = m.restated_market_key "
queryGroupByVP = queryGroupByVP & "AND ids_mf.restated_product_key = p.restated_product_key "
queryGroupByVP = queryGroupByVP & "AND gd.GROUP_CODE = groupdescr.GROUP_CODE "
queryGroupByVP = queryGroupByVP & "AND gd.group_field_c  =  m.DIVISION_CODE "
queryGroupByVP = queryGroupByVP & "AND (mpbd.business_division_code IN ('F01', 'F08', 'F15')) "
queryGroupByVP = queryGroupByVP & "AND (m.selling_group_code IN ('119000', '125000', '610000', '800000', '423000')) "
queryGroupByVP = queryGroupByVP & "AND (ids_mf.year_descr IN (:p_year)) "
queryGroupByVP = queryGroupByVP & "and ids_mf.fiscal_month_number <= :p_Month "
queryGroupByVP = queryGroupByVP & "AND (mpbd.business_division_code IN (:p_businessdivision)) "
queryGroupByVP = queryGroupByVP & "AND (m.division_code IN (:p_salesdivision)) "
queryGroupByVP = queryGroupByVP & "AND (m.region_code IN (:p_salesregion)) "
queryGroupByVP = queryGroupByVP & "AND (m.primary_broker_code IN (:p_primarybroker)) "
queryGroupByVP = queryGroupByVP & "AND gd.GROUP_CODE in (:vp) "
queryGroupByVP = queryGroupByVP & "GROUP BY  "
queryGroupByVP = queryGroupByVP & "gd.GROUP_CODE, "
queryGroupByVP = queryGroupByVP & "groupdescr.GROUP_DESCR, "
queryGroupByVP = queryGroupByVP & "'zzz', "
queryGroupByVP = queryGroupByVP & "mpbd.business_division_code, "
queryGroupByVP = queryGroupByVP & "'Total Value Added', "
queryGroupByVP = queryGroupByVP & "ids_mf.year_descr, "
queryGroupByVP = queryGroupByVP & "ids_mf.month_descr, "
queryGroupByVP = queryGroupByVP & "ids_mf.FISCAL_MONTH_NUMBER, "
queryGroupByVP = queryGroupByVP & "mpbd.business_division_Descr "
queryGroupByVP = queryGroupByVP & "---Begin Volume Total Market/CVP "
queryGroupByVP = queryGroupByVP & "UNION "
queryGroupByVP = queryGroupByVP & "SELECT    "
queryGroupByVP = queryGroupByVP & "'zzz' AS businessunit, "
queryGroupByVP = queryGroupByVP & "0 AS monthexpense_amt, "
queryGroupByVP = queryGroupByVP & "CASE WHEN (ids_mf.FISCAL_MONTH_NUMBER = (:p_Month)) "
queryGroupByVP = queryGroupByVP & "     THEN SUM (  ids_mf.mf_pounds_shipped "
queryGroupByVP = queryGroupByVP & "               + ids_mf.mf_adjusted_pounds_shipped "
queryGroupByVP = queryGroupByVP & "               + ids_mf.ids_pounds_shipped) "
queryGroupByVP = queryGroupByVP & "END AS monthpounds, "
queryGroupByVP = queryGroupByVP & "CASE WHEN (ids_mf.FISCAL_MONTH_NUMBER = (:p_Month)) "
queryGroupByVP = queryGroupByVP & "     THEN SUM (  ids_mf.mf_gross_sales_amount "
queryGroupByVP = queryGroupByVP & "                - ids_mf.mf_allow_amount "
queryGroupByVP = queryGroupByVP & "                - ids_mf.mf_off_invoice_amount "
queryGroupByVP = queryGroupByVP & "                + ids_mf.mf_revenue_adjustment "
queryGroupByVP = queryGroupByVP & "                + ids_mf.ids_indirect_sales_amount) "
queryGroupByVP = queryGroupByVP & "END AS monthnetreceivables, "
queryGroupByVP = queryGroupByVP & "gd.GROUP_CODE, "
queryGroupByVP = queryGroupByVP & "groupdescr.GROUP_DESCR, "
queryGroupByVP = queryGroupByVP & "mpbd.business_division_code, "
queryGroupByVP = queryGroupByVP & "'Total Market/CVP' AS businessdivisiondescr, "
queryGroupByVP = queryGroupByVP & "NULL AS spend_base_descr, "
queryGroupByVP = queryGroupByVP & "NULL AS spend_base_seq, "
queryGroupByVP = queryGroupByVP & "NULL AS spend_subcategory_descr, "
queryGroupByVP = queryGroupByVP & "NULL AS spend_subcategory_seq, "
queryGroupByVP = queryGroupByVP & "ids_mf.year_descr, "
queryGroupByVP = queryGroupByVP & "ids_mf.month_descr, "
queryGroupByVP = queryGroupByVP & "0 AS expense_amt, "
queryGroupByVP = queryGroupByVP & "SUM (  ids_mf.mf_pounds_shipped "
queryGroupByVP = queryGroupByVP & "        + ids_mf.mf_adjusted_pounds_shipped "
queryGroupByVP = queryGroupByVP & "        + ids_mf.ids_pounds_shipped "
queryGroupByVP = queryGroupByVP & "        ) AS total_pounds_shipped, "
queryGroupByVP = queryGroupByVP & "SUM (  ids_mf.mf_gross_sales_amount "
queryGroupByVP = queryGroupByVP & "        - ids_mf.mf_allow_amount "
queryGroupByVP = queryGroupByVP & "        - ids_mf.mf_off_invoice_amount "
queryGroupByVP = queryGroupByVP & "        + ids_mf.mf_revenue_adjustment "
queryGroupByVP = queryGroupByVP & "        + ids_mf.ids_indirect_sales_amount "
queryGroupByVP = queryGroupByVP & ") AS net_receivable_dollar "
queryGroupByVP = queryGroupByVP & "FROM ( "
queryGroupByVP = queryGroupByVP & "---Begin sub queryGroupByVP "
queryGroupByVP = queryGroupByVP & "SELECT   mpbd1.business_division_code, "
queryGroupByVP = queryGroupByVP & "mpbd1.business_division_descr, "
queryGroupByVP = queryGroupByVP & "mpbd1.restated_market_key, "
queryGroupByVP = queryGroupByVP & "mpbd1.restated_product_key, "
queryGroupByVP = queryGroupByVP & "md1.year_descr, "
queryGroupByVP = queryGroupByVP & "md1.month_descr, "
queryGroupByVP = queryGroupByVP & "md1.FISCAL_MONTH_NUMBER, "
queryGroupByVP = queryGroupByVP & "SUM (mf.pounds_shipped) AS mf_pounds_shipped, "
queryGroupByVP = queryGroupByVP & "SUM (mf.adj_pounds_shipped) AS mf_adjusted_pounds_shipped, "
queryGroupByVP = queryGroupByVP & "SUM (mf.gross_sales_amount) AS mf_gross_sales_amount, "
queryGroupByVP = queryGroupByVP & "SUM (mf.allow_amount) AS mf_allow_amount, "
queryGroupByVP = queryGroupByVP & "SUM (mf.revenue_adjustment) AS mf_revenue_adjustment, "
queryGroupByVP = queryGroupByVP & "SUM (mf.off_invoice_amount) AS mf_off_invoice_amount, "
queryGroupByVP = queryGroupByVP & "0 AS ids_pounds_shipped, "
queryGroupByVP = queryGroupByVP & "0 AS ids_indirect_sales_amount "
queryGroupByVP = queryGroupByVP & "FROM tdw_owner.restated_mkt_prd_bus_div_dim mpbd1, "
queryGroupByVP = queryGroupByVP & "tdw_owner.restated_market m1, "
queryGroupByVP = queryGroupByVP & "tdw_owner.month_dim md1, "
queryGroupByVP = queryGroupByVP & "tdw_owner.restated_product p1, "
queryGroupByVP = queryGroupByVP & "tdw_owner.day_dim d1, "
queryGroupByVP = queryGroupByVP & "tdw_owner.margin_fact mf, "
queryGroupByVP = queryGroupByVP & "tdw_owner.group_detail gd, "
queryGroupByVP = queryGroupByVP & "tdw_owner.group_description groupdescr "
queryGroupByVP = queryGroupByVP & "WHERE mf.restated_market_key = m1.restated_market_key "
queryGroupByVP = queryGroupByVP & "AND mf.restated_product_key = p1.restated_product_key "
queryGroupByVP = queryGroupByVP & "AND mf.restated_market_key = mpbd1.restated_market_key "
queryGroupByVP = queryGroupByVP & "AND mf.restated_product_key = mpbd1.restated_product_key "
queryGroupByVP = queryGroupByVP & "AND mf.invoice_day_key = d1.day_key "
queryGroupByVP = queryGroupByVP & "AND d1.month_ending_date = md1.month_ending_date "
queryGroupByVP = queryGroupByVP & "AND gd.GROUP_CODE = groupdescr.GROUP_CODE "
queryGroupByVP = queryGroupByVP & "AND gd.group_field_c  =  m1.DIVISION_CODE "
queryGroupByVP = queryGroupByVP & "AND (mpbd1.business_division_code IN ('F03', 'F04')) "
queryGroupByVP = queryGroupByVP & "AND (m1.selling_group_code IN ('119000', '125000', '610000', '800000', '423000')) "
queryGroupByVP = queryGroupByVP & "AND (md1.year_descr IN (:p_year)) "
queryGroupByVP = queryGroupByVP & "and md1.fiscal_month_number <= :p_Month "
queryGroupByVP = queryGroupByVP & "AND (mpbd1.business_division_code IN (:p_businessdivision)) "
queryGroupByVP = queryGroupByVP & "AND (m1.division_code IN (:p_salesdivision)) "
queryGroupByVP = queryGroupByVP & "AND (m1.region_code IN (:p_salesregion)) "
queryGroupByVP = queryGroupByVP & "AND (m1.primary_broker_code IN (:p_primarybroker)) "
queryGroupByVP = queryGroupByVP & "AND gd.GROUP_CODE in (:vp) "
queryGroupByVP = queryGroupByVP & "GROUP BY mpbd1.business_division_code, "
queryGroupByVP = queryGroupByVP & "mpbd1.business_division_descr, "
queryGroupByVP = queryGroupByVP & "mpbd1.restated_market_key, "
queryGroupByVP = queryGroupByVP & "mpbd1.restated_product_key, "
queryGroupByVP = queryGroupByVP & "md1.year_descr, "
queryGroupByVP = queryGroupByVP & "md1.month_descr, "
queryGroupByVP = queryGroupByVP & "md1.FISCAL_MONTH_NUMBER "
queryGroupByVP = queryGroupByVP & "UNION "
queryGroupByVP = queryGroupByVP & "SELECT   /*+ RULE */ "
queryGroupByVP = queryGroupByVP & "mpbd1.business_division_code, "
queryGroupByVP = queryGroupByVP & "mpbd1.business_division_descr, "
queryGroupByVP = queryGroupByVP & "mpbd1.restated_market_key, "
queryGroupByVP = queryGroupByVP & "mpbd1.restated_product_key, "
queryGroupByVP = queryGroupByVP & "md1.year_descr, "
queryGroupByVP = queryGroupByVP & "md1.month_descr, "
queryGroupByVP = queryGroupByVP & "md1.FISCAL_MONTH_NUMBER, "
queryGroupByVP = queryGroupByVP & "0 AS mf_pounds_shipped, "
queryGroupByVP = queryGroupByVP & "0 AS mf_adjusted_pounds_shipped, "
queryGroupByVP = queryGroupByVP & "0 AS mf_gross_sales_amount, "
queryGroupByVP = queryGroupByVP & "0 AS mf_allow_amount, "
queryGroupByVP = queryGroupByVP & "0 AS mf_revenue_adjustment, "
queryGroupByVP = queryGroupByVP & "0 AS mf_off_invoice_amount, "
queryGroupByVP = queryGroupByVP & "SUM (ids.pounds_shipped) AS ids_pounds_shipped, "
queryGroupByVP = queryGroupByVP & "SUM (ids.indirect_sales_amount) "
queryGroupByVP = queryGroupByVP & "                 AS ids_indirect_sales_amount "
queryGroupByVP = queryGroupByVP & "FROM tdw_owner.restated_mkt_prd_bus_div_dim mpbd1, "
queryGroupByVP = queryGroupByVP & "tdw_owner.restated_market m1, "
queryGroupByVP = queryGroupByVP & "tdw_owner.month_dim md1, "
queryGroupByVP = queryGroupByVP & "tdw_owner.restated_product p1, "
queryGroupByVP = queryGroupByVP & "tdw_owner.indirect_sales ids, "
queryGroupByVP = queryGroupByVP & "tdw_owner.week_dim w1, "
queryGroupByVP = queryGroupByVP & "tdw_owner.group_detail gd, "
queryGroupByVP = queryGroupByVP & "tdw_owner.group_description groupdescr "
queryGroupByVP = queryGroupByVP & "WHERE ids.restated_market_key = m1.restated_market_key "
queryGroupByVP = queryGroupByVP & "AND ids.restated_product_key = p1.restated_product_key "
queryGroupByVP = queryGroupByVP & "AND ids.restated_market_key = mpbd1.restated_market_key "
queryGroupByVP = queryGroupByVP & "AND ids.restated_product_key = mpbd1.restated_product_key "
queryGroupByVP = queryGroupByVP & "AND ids.week_key = w1.week_key "
queryGroupByVP = queryGroupByVP & "AND w1.month_ending_date = md1.month_ending_date "
queryGroupByVP = queryGroupByVP & "AND gd.GROUP_CODE = groupdescr.GROUP_CODE "
queryGroupByVP = queryGroupByVP & "AND gd.group_field_c  =  m1.DIVISION_CODE "
queryGroupByVP = queryGroupByVP & "AND (mpbd1.business_division_code IN ('F03', 'F04')) "
queryGroupByVP = queryGroupByVP & "AND (m1.selling_group_code IN ('119000', '125000', '610000', '800000', '423000')) "
queryGroupByVP = queryGroupByVP & "AND (md1.year_descr IN (:p_year)) "
queryGroupByVP = queryGroupByVP & "and md1.fiscal_month_number <= :p_Month "
queryGroupByVP = queryGroupByVP & "AND (mpbd1.business_division_code IN (:p_businessdivision)) "
queryGroupByVP = queryGroupByVP & "AND (m1.division_code IN (:p_salesdivision)) "
queryGroupByVP = queryGroupByVP & "AND (m1.region_code IN (:p_salesregion)) "
queryGroupByVP = queryGroupByVP & "AND (m1.primary_broker_code IN (:p_primarybroker)) "
queryGroupByVP = queryGroupByVP & "AND gd.GROUP_CODE in (:vp) "
queryGroupByVP = queryGroupByVP & "GROUP BY mpbd1.business_division_code, "
queryGroupByVP = queryGroupByVP & "mpbd1.business_division_descr, "
queryGroupByVP = queryGroupByVP & "mpbd1.restated_market_key, "
queryGroupByVP = queryGroupByVP & "mpbd1.restated_product_key, "
queryGroupByVP = queryGroupByVP & "md1.year_descr, "
queryGroupByVP = queryGroupByVP & "md1.month_descr, "
queryGroupByVP = queryGroupByVP & "md1.FISCAL_MONTH_NUMBER "
queryGroupByVP = queryGroupByVP & ")  ---End sub queryGroupByVP "
queryGroupByVP = queryGroupByVP & "   ids_mf, "
queryGroupByVP = queryGroupByVP & "tdw_owner.restated_mkt_prd_bus_div_dim mpbd, "
queryGroupByVP = queryGroupByVP & "tdw_owner.restated_market m, "
queryGroupByVP = queryGroupByVP & "tdw_owner.restated_product p, "
queryGroupByVP = queryGroupByVP & "tdw_owner.group_detail gd, "
queryGroupByVP = queryGroupByVP & "tdw_owner.group_description groupdescr "
queryGroupByVP = queryGroupByVP & "WHERE ids_mf.restated_market_key = mpbd.restated_market_key "
queryGroupByVP = queryGroupByVP & "AND ids_mf.restated_product_key = mpbd.restated_product_key "
queryGroupByVP = queryGroupByVP & "AND ids_mf.restated_market_key = m.restated_market_key "
queryGroupByVP = queryGroupByVP & "AND ids_mf.restated_product_key = p.restated_product_key "
queryGroupByVP = queryGroupByVP & "AND gd.GROUP_CODE = groupdescr.GROUP_CODE "
queryGroupByVP = queryGroupByVP & "AND gd.group_field_c  =  m.DIVISION_CODE "
queryGroupByVP = queryGroupByVP & "AND (mpbd.business_division_code IN ('F03', 'F04')) "
queryGroupByVP = queryGroupByVP & "AND (m.selling_group_code IN ('119000', '125000', '610000', '800000', '423000')) "
queryGroupByVP = queryGroupByVP & "AND (ids_mf.year_descr IN (:p_year)) "
queryGroupByVP = queryGroupByVP & "and ids_mf.fiscal_month_number <= :p_Month "
queryGroupByVP = queryGroupByVP & "AND (mpbd.business_division_code IN (:p_businessdivision)) "
queryGroupByVP = queryGroupByVP & "AND (m.division_code IN (:p_salesdivision)) "
queryGroupByVP = queryGroupByVP & "AND (m.region_code IN (:p_salesregion)) "
queryGroupByVP = queryGroupByVP & "AND (m.primary_broker_code IN (:p_primarybroker)) "
queryGroupByVP = queryGroupByVP & "AND gd.GROUP_CODE in (:vp) "
queryGroupByVP = queryGroupByVP & "GROUP BY  "
queryGroupByVP = queryGroupByVP & "gd.GROUP_CODE, "
queryGroupByVP = queryGroupByVP & "groupdescr.GROUP_DESCR, "
queryGroupByVP = queryGroupByVP & "'zzz', "
queryGroupByVP = queryGroupByVP & "mpbd.business_division_code, "
queryGroupByVP = queryGroupByVP & "'Total Market/CVP', "
queryGroupByVP = queryGroupByVP & "ids_mf.year_descr, "
queryGroupByVP = queryGroupByVP & "ids_mf.month_descr, "
queryGroupByVP = queryGroupByVP & "ids_mf.FISCAL_MONTH_NUMBER, "
queryGroupByVP = queryGroupByVP & "mpbd.business_division_Descr "
queryGroupByVP = queryGroupByVP & "---Begin Volume Total customer "
queryGroupByVP = queryGroupByVP & "UNION "
queryGroupByVP = queryGroupByVP & "SELECT    "
queryGroupByVP = queryGroupByVP & "'zzz' AS businessunit, "
queryGroupByVP = queryGroupByVP & "0 AS monthexpense_amt, "
queryGroupByVP = queryGroupByVP & "CASE WHEN (ids_mf.FISCAL_MONTH_NUMBER = (:p_Month)) "
queryGroupByVP = queryGroupByVP & "     THEN SUM (  ids_mf.mf_pounds_shipped "
queryGroupByVP = queryGroupByVP & "               + ids_mf.mf_adjusted_pounds_shipped "
queryGroupByVP = queryGroupByVP & "               + ids_mf.ids_pounds_shipped) "
queryGroupByVP = queryGroupByVP & "END AS monthpounds, "
queryGroupByVP = queryGroupByVP & "CASE WHEN (ids_mf.FISCAL_MONTH_NUMBER = (:p_Month)) "
queryGroupByVP = queryGroupByVP & "     THEN SUM (  ids_mf.mf_gross_sales_amount "
queryGroupByVP = queryGroupByVP & "                - ids_mf.mf_allow_amount "
queryGroupByVP = queryGroupByVP & "                - ids_mf.mf_off_invoice_amount "
queryGroupByVP = queryGroupByVP & "                + ids_mf.mf_revenue_adjustment "
queryGroupByVP = queryGroupByVP & "                + ids_mf.ids_indirect_sales_amount) "
queryGroupByVP = queryGroupByVP & "END AS monthnetreceivables, "
queryGroupByVP = queryGroupByVP & "gd.GROUP_CODE, "
queryGroupByVP = queryGroupByVP & "groupdescr.GROUP_DESCR, "
queryGroupByVP = queryGroupByVP & "mpbd.business_division_code, "
queryGroupByVP = queryGroupByVP & "'Total Customer' AS businessdivisiondescr, "
queryGroupByVP = queryGroupByVP & "NULL AS spend_base_descr, "
queryGroupByVP = queryGroupByVP & "NULL AS spend_base_seq, "
queryGroupByVP = queryGroupByVP & "NULL AS spend_subcategory_descr, "
queryGroupByVP = queryGroupByVP & "NULL AS spend_subcategory_seq, "
queryGroupByVP = queryGroupByVP & "ids_mf.year_descr, "
queryGroupByVP = queryGroupByVP & "ids_mf.month_descr, "
queryGroupByVP = queryGroupByVP & "0 AS expense_amt, "
queryGroupByVP = queryGroupByVP & "SUM (  ids_mf.mf_pounds_shipped "
queryGroupByVP = queryGroupByVP & "       + ids_mf.mf_adjusted_pounds_shipped "
queryGroupByVP = queryGroupByVP & "       + ids_mf.ids_pounds_shipped "
queryGroupByVP = queryGroupByVP & "      ) AS total_pounds_shipped, "
queryGroupByVP = queryGroupByVP & "SUM (  ids_mf.mf_gross_sales_amount "
queryGroupByVP = queryGroupByVP & "     - ids_mf.mf_allow_amount "
queryGroupByVP = queryGroupByVP & "     - ids_mf.mf_off_invoice_amount "
queryGroupByVP = queryGroupByVP & "     + ids_mf.mf_revenue_adjustment "
queryGroupByVP = queryGroupByVP & "     + ids_mf.ids_indirect_sales_amount "
queryGroupByVP = queryGroupByVP & "     ) AS net_receivable_dollar "
queryGroupByVP = queryGroupByVP & "FROM ( "
queryGroupByVP = queryGroupByVP & "---Begin sub queryGroupByVP "
queryGroupByVP = queryGroupByVP & "SELECT   mpbd1.business_division_code, "
queryGroupByVP = queryGroupByVP & "mpbd1.business_division_descr, "
queryGroupByVP = queryGroupByVP & "mpbd1.restated_market_key, "
queryGroupByVP = queryGroupByVP & "mpbd1.restated_product_key, "
queryGroupByVP = queryGroupByVP & "md1.year_descr, "
queryGroupByVP = queryGroupByVP & "md1.month_descr, "
queryGroupByVP = queryGroupByVP & "md1.FISCAL_MONTH_NUMBER, "
queryGroupByVP = queryGroupByVP & "SUM (mf.pounds_shipped) AS mf_pounds_shipped, "
queryGroupByVP = queryGroupByVP & "SUM (mf.adj_pounds_shipped) AS mf_adjusted_pounds_shipped, "
queryGroupByVP = queryGroupByVP & "SUM (mf.gross_sales_amount) AS mf_gross_sales_amount, "
queryGroupByVP = queryGroupByVP & "SUM (mf.allow_amount) AS mf_allow_amount, "
queryGroupByVP = queryGroupByVP & "SUM (mf.revenue_adjustment) AS mf_revenue_adjustment, "
queryGroupByVP = queryGroupByVP & "SUM (mf.off_invoice_amount) AS mf_off_invoice_amount, "
queryGroupByVP = queryGroupByVP & "0 AS ids_pounds_shipped, "
queryGroupByVP = queryGroupByVP & "0 AS ids_indirect_sales_amount "
queryGroupByVP = queryGroupByVP & "FROM tdw_owner.restated_mkt_prd_bus_div_dim mpbd1, "
queryGroupByVP = queryGroupByVP & "tdw_owner.restated_market m1, "
queryGroupByVP = queryGroupByVP & "tdw_owner.month_dim md1, "
queryGroupByVP = queryGroupByVP & "tdw_owner.restated_product p1, "
queryGroupByVP = queryGroupByVP & "tdw_owner.day_dim d1, "
queryGroupByVP = queryGroupByVP & "tdw_owner.margin_fact mf, "
queryGroupByVP = queryGroupByVP & "tdw_owner.group_detail gd, "
queryGroupByVP = queryGroupByVP & "tdw_owner.group_description groupdescr "
queryGroupByVP = queryGroupByVP & "WHERE mf.restated_market_key = m1.restated_market_key "
queryGroupByVP = queryGroupByVP & "AND mf.restated_product_key = p1.restated_product_key "
queryGroupByVP = queryGroupByVP & "AND mf.restated_market_key = mpbd1.restated_market_key "
queryGroupByVP = queryGroupByVP & "AND mf.restated_product_key = mpbd1.restated_product_key "
queryGroupByVP = queryGroupByVP & "AND mf.invoice_day_key = d1.day_key "
queryGroupByVP = queryGroupByVP & "AND d1.month_ending_date = md1.month_ending_date "
queryGroupByVP = queryGroupByVP & "AND gd.GROUP_CODE = groupdescr.GROUP_CODE "
queryGroupByVP = queryGroupByVP & "AND gd.group_field_c  =  m1.DIVISION_CODE "
queryGroupByVP = queryGroupByVP & "AND (mpbd1.business_division_code IN ('F01', 'F03', 'F04', 'F08', 'F15')) "
queryGroupByVP = queryGroupByVP & "AND (m1.selling_group_code IN ('119000', '125000', '610000', '800000', '423000')) "
queryGroupByVP = queryGroupByVP & "AND (md1.year_descr IN (:p_year)) "
queryGroupByVP = queryGroupByVP & "and md1.fiscal_month_number <= :p_Month "
queryGroupByVP = queryGroupByVP & "AND (mpbd1.business_division_code IN (:p_businessdivision)) "
queryGroupByVP = queryGroupByVP & "AND (m1.division_code IN (:p_salesdivision)) "
queryGroupByVP = queryGroupByVP & "AND (m1.region_code IN (:p_salesregion)) "
queryGroupByVP = queryGroupByVP & "AND (m1.primary_broker_code IN (:p_primarybroker)) "
queryGroupByVP = queryGroupByVP & "AND gd.GROUP_CODE in (:vp) "
queryGroupByVP = queryGroupByVP & "GROUP BY mpbd1.business_division_code, "
queryGroupByVP = queryGroupByVP & "mpbd1.business_division_descr, "
queryGroupByVP = queryGroupByVP & "mpbd1.restated_market_key, "
queryGroupByVP = queryGroupByVP & "mpbd1.restated_product_key, "
queryGroupByVP = queryGroupByVP & "md1.year_descr, "
queryGroupByVP = queryGroupByVP & "md1.month_descr, "
queryGroupByVP = queryGroupByVP & "md1.FISCAL_MONTH_NUMBER "
queryGroupByVP = queryGroupByVP & "UNION "
queryGroupByVP = queryGroupByVP & "SELECT   /*+ RULE */ "
queryGroupByVP = queryGroupByVP & "mpbd1.business_division_code, "
queryGroupByVP = queryGroupByVP & "mpbd1.business_division_descr, "
queryGroupByVP = queryGroupByVP & "mpbd1.restated_market_key, "
queryGroupByVP = queryGroupByVP & "mpbd1.restated_product_key, "
queryGroupByVP = queryGroupByVP & "md1.year_descr, "
queryGroupByVP = queryGroupByVP & "md1.month_descr, "
queryGroupByVP = queryGroupByVP & "md1.FISCAL_MONTH_NUMBER, "
queryGroupByVP = queryGroupByVP & "0 AS mf_pounds_shipped, "
queryGroupByVP = queryGroupByVP & "0 AS mf_adjusted_pounds_shipped, "
queryGroupByVP = queryGroupByVP & "0 AS mf_gross_sales_amount, "
queryGroupByVP = queryGroupByVP & "0 AS mf_allow_amount, "
queryGroupByVP = queryGroupByVP & "0 AS mf_revenue_adjustment, "
queryGroupByVP = queryGroupByVP & "0 AS mf_off_invoice_amount, "
queryGroupByVP = queryGroupByVP & "SUM (ids.pounds_shipped) AS ids_pounds_shipped, "
queryGroupByVP = queryGroupByVP & "SUM (ids.indirect_sales_amount) "
queryGroupByVP = queryGroupByVP & "                 AS ids_indirect_sales_amount "
queryGroupByVP = queryGroupByVP & "FROM tdw_owner.restated_mkt_prd_bus_div_dim mpbd1, "
queryGroupByVP = queryGroupByVP & "tdw_owner.restated_market m1, "
queryGroupByVP = queryGroupByVP & "tdw_owner.month_dim md1, "
queryGroupByVP = queryGroupByVP & "tdw_owner.restated_product p1, "
queryGroupByVP = queryGroupByVP & "tdw_owner.indirect_sales ids, "
queryGroupByVP = queryGroupByVP & "tdw_owner.week_dim w1, "
queryGroupByVP = queryGroupByVP & "tdw_owner.group_detail gd, "
queryGroupByVP = queryGroupByVP & "tdw_owner.group_description groupdescr "
queryGroupByVP = queryGroupByVP & "WHERE ids.restated_market_key = m1.restated_market_key "
queryGroupByVP = queryGroupByVP & "AND ids.restated_product_key = p1.restated_product_key "
queryGroupByVP = queryGroupByVP & "AND ids.restated_market_key = mpbd1.restated_market_key "
queryGroupByVP = queryGroupByVP & "AND ids.restated_product_key = mpbd1.restated_product_key "
queryGroupByVP = queryGroupByVP & "AND ids.week_key = w1.week_key "
queryGroupByVP = queryGroupByVP & "AND w1.month_ending_date = md1.month_ending_date "
queryGroupByVP = queryGroupByVP & "AND gd.GROUP_CODE = groupdescr.GROUP_CODE "
queryGroupByVP = queryGroupByVP & "AND gd.group_field_c  =  m1.DIVISION_CODE "
queryGroupByVP = queryGroupByVP & "AND (mpbd1.business_division_code IN ('F01', 'F03', 'F04', 'F08', 'F15')) "
queryGroupByVP = queryGroupByVP & "AND (m1.selling_group_code IN ('119000', '125000', '610000', '800000', '423000')) "
queryGroupByVP = queryGroupByVP & "AND (md1.year_descr IN (:p_year)) "
queryGroupByVP = queryGroupByVP & "and md1.fiscal_month_number <= :p_Month "
queryGroupByVP = queryGroupByVP & "AND (mpbd1.business_division_code IN (:p_businessdivision)) "
queryGroupByVP = queryGroupByVP & "AND (m1.division_code IN (:p_salesdivision)) "
queryGroupByVP = queryGroupByVP & "AND (m1.region_code IN (:p_salesregion)) "
queryGroupByVP = queryGroupByVP & "AND (m1.primary_broker_code IN (:p_primarybroker)) "
queryGroupByVP = queryGroupByVP & "AND gd.GROUP_CODE in (:vp) "
queryGroupByVP = queryGroupByVP & "GROUP BY mpbd1.business_division_code, "
queryGroupByVP = queryGroupByVP & "mpbd1.business_division_descr, "
queryGroupByVP = queryGroupByVP & "mpbd1.restated_market_key, "
queryGroupByVP = queryGroupByVP & "mpbd1.restated_product_key, "
queryGroupByVP = queryGroupByVP & "md1.year_descr, "
queryGroupByVP = queryGroupByVP & "md1.month_descr, "
queryGroupByVP = queryGroupByVP & "md1.FISCAL_MONTH_NUMBER "
queryGroupByVP = queryGroupByVP & ")   --end sub queryGroupByVP "
queryGroupByVP = queryGroupByVP & "   ids_mf, "
queryGroupByVP = queryGroupByVP & "tdw_owner.restated_mkt_prd_bus_div_dim mpbd, "
queryGroupByVP = queryGroupByVP & "tdw_owner.restated_market m, "
queryGroupByVP = queryGroupByVP & "tdw_owner.restated_product p, "
queryGroupByVP = queryGroupByVP & "tdw_owner.group_detail gd, "
queryGroupByVP = queryGroupByVP & "tdw_owner.group_description groupdescr "
queryGroupByVP = queryGroupByVP & "WHERE ids_mf.restated_market_key = mpbd.restated_market_key "
queryGroupByVP = queryGroupByVP & "AND ids_mf.restated_product_key = mpbd.restated_product_key "
queryGroupByVP = queryGroupByVP & "AND ids_mf.restated_market_key = m.restated_market_key "
queryGroupByVP = queryGroupByVP & "AND ids_mf.restated_product_key = p.restated_product_key "
queryGroupByVP = queryGroupByVP & "AND gd.GROUP_CODE = groupdescr.GROUP_CODE "
queryGroupByVP = queryGroupByVP & "AND gd.group_field_c  =  m.DIVISION_CODE "
queryGroupByVP = queryGroupByVP & "AND (mpbd.business_division_code IN ('F01', 'F03', 'F04', 'F08', 'F15')) "
queryGroupByVP = queryGroupByVP & "AND (m.selling_group_code IN ('119000', '125000', '610000', '800000', '423000')) "
queryGroupByVP = queryGroupByVP & "AND (ids_mf.year_descr IN (:p_year)) "
queryGroupByVP = queryGroupByVP & "and ids_mf.fiscal_month_number <= :p_Month "
queryGroupByVP = queryGroupByVP & "AND (mpbd.business_division_code IN (:p_businessdivision)) "
queryGroupByVP = queryGroupByVP & "AND (m.division_code IN (:p_salesdivision)) "
queryGroupByVP = queryGroupByVP & "AND (m.region_code IN (:p_salesregion)) "
queryGroupByVP = queryGroupByVP & "AND (m.primary_broker_code IN (:p_primarybroker)) "
queryGroupByVP = queryGroupByVP & "AND gd.GROUP_CODE in (:vp) "
queryGroupByVP = queryGroupByVP & "GROUP BY  "
queryGroupByVP = queryGroupByVP & "gd.GROUP_CODE, "
queryGroupByVP = queryGroupByVP & "groupdescr.GROUP_DESCR, "
queryGroupByVP = queryGroupByVP & "'zzz', "
queryGroupByVP = queryGroupByVP & "mpbd.business_division_code, "
queryGroupByVP = queryGroupByVP & "'Total Customer', "
queryGroupByVP = queryGroupByVP & "ids_mf.year_descr, "
queryGroupByVP = queryGroupByVP & "ids_mf.month_descr, "
queryGroupByVP = queryGroupByVP & "ids_mf.FISCAL_MONTH_NUMBER, "
queryGroupByVP = queryGroupByVP & "mpbd.business_division_Descr "
queryGroupByVP = queryGroupByVP & "ORDER BY businessdivisiondescr, spend_base_seq, spend_subcategory_seq"