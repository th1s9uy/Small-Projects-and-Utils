query =    "       						SELECT    "
query = query & "		                sc.DEPT_LEVEL, "
query = query & "		                sc.DEPT_LEVEL_SEQ, "
query = query & "		                sc.CUSTOMER_LEVEL_SEQ, "
query = query & "		                sc.CUSTOMER_LEVEL, "
query = query & "		                sc.MANAGEMENT_LEVEL, "
query = query & "		                sc.MANAGEMENT_LEVEL_SEQ, "
query = query & "		                CASE WHEN (md.FISCAL_MONTH_NUMBER = (:p_Month))THEN SUM (epf.expense_amt)   "
query = query & "		                END AS monthexpense_amt,   "
query = query & "		                0 AS monthpounds,   "
query = query & "		                0 AS monthnetreceivables,   "
query = query & "						mpbd.sales_unit_code,   "
query = query & "		                case when mpbd.sales_unit_code = 'F01' Then 'Distribution Frozen'  "
query = query & "		                     when mpbd.sales_unit_code = 'F08' Then 'Distribut Prep Foods' "
query = query & "		                     when mpbd.sales_unit_code = 'F15' Then 'Distribution Other'    "
query = query & "		                     when mpbd.sales_unit_code = 'F03' Then 'Distribution Market'  "
query = query & "		                     when mpbd.sales_unit_code = 'F04' Then 'Distribution CVP'     "
query = query & "		                     when mpbd.sales_unit_code = 'F20' Then 'Distribution Fowl'    "
query = query & "		                     when mpbd.sales_unit_code = 'F30' Then 'Gov''t Sales-Poultry' "
query = query & "		                     when mpbd.sales_unit_code = 'F31' Then 'Gov''t Sales-Prepared' "
query = query & "                                     End as sales_unit_descr,	 "
query = query & "		                sc.spend_base_descr,   "
query = query & "		                sc.spend_base_seq,   "
query = query & "		                sc.spend_subcategory_descr,   "
query = query & "		                sc.spend_subcategory_seq,   "
query = query & "		                md.year_descr,   "
query = query & "		                md.month_descr,   "
query = query & "		                SUM (epf.expense_amt) AS expense_amt,   "
query = query & "		                0 AS total_pounds_shipped,   "
query = query & "		                0 AS net_receivable_dollar   "
query = query & "		                FROM tdw_owner.restated_mkt_prd_bus_div_dim mpbd,   "
query = query & "		                tdw_owner.expense_payment_fact epf,   "
query = query & "		                tdw_owner.fsv_spend_category sc,   "
query = query & "		                tdw_owner.restated_market m,   "
query = query & "		                tdw_owner.month_dim md,   "
query = query & "		                tdw_owner.restated_product p,   "
query = query & "		                tdw_owner.acct_dim a,   "
query = query & "		                tdw_owner.expense_type et,   "
query = query & "		                tdw_owner.spend_request_dim s,   "
query = query & "		                tdw_owner.operator_dim o,   "
query = query & "		                tdw_owner.day_dim d1,   "
query = query & "		                tdw_owner.day_dim d2,   "
query = query & "		                tdw_owner.expense_attribute_dim ead,   "
query = query & "		                tdw_owner.expense_payee_dim pay,   "
query = query & "		                tdw_owner.group_detail gd,   "
query = query & "		                tdw_owner.group_description groupdescr   "
query = query & "		                WHERE mpbd.restated_mkt_prd_bus_div_key = epf.restated_mkt_prd_bus_div_key   "
query = query & "		                AND epf.expense_type_key = sc.expense_type_key   "
query = query & "		                AND epf.acct_key = sc.acct_key   "
query = query & "		                AND epf.restated_market_key = m.restated_market_key   "
query = query & "		                AND epf.month_key = md.month_key   "
query = query & "		                AND epf.restated_product_key = p.restated_product_key   "
query = query & "		                AND epf.acct_key = a.acct_key   "
query = query & "		                AND epf.expense_type_key = et.expense_type_key   "
query = query & "		                AND epf.spend_request_key = s.spend_request_key   "
query = query & "		                AND epf.operator_key = o.operator_key   "
query = query & "		                AND epf.report_period_begin_day_key = d1.day_key   "
query = query & "		                AND epf.report_period_end_day_key = d2.day_key   "
query = query & "		                AND epf.expense_attribute_key = ead.expense_attribute_key   "
query = query & "		                AND epf.expense_payee_key = pay.expense_payee_key   "
query = query & "		                AND gd.GROUP_CODE = groupdescr.GROUP_CODE   "
query = query & "		                AND gd.group_field_c  =  m.DIVISION_CODE   "
query = query & "		                AND sc.spend_base_seq <> 0   "
query = query & "		                AND sc.spend_subcategory_seq <> 0   "
query = query & "		                AND (mpbd.sales_unit_code IN ('F01', 'F03', 'F04', 'F08', 'F30' ,'F31' ,'F15','F20'))   "
query = query & "		                AND (m.selling_group_code IN ('119000', '125000', '610000', '800000', '423000'))   "
query = query & "		                AND (md.year_descr IN (:p_year))   "
query = query & "		                and md.fiscal_month_number <= :p_Month   "
query = query & "		                AND (mpbd.sales_unit_code IN (:p_sales_unit))   "
query = query & "		                AND (m.division_code IN (:p_salesdivision))   "
query = query & "		                AND (m.region_code IN (:p_salesregion))   "
query = query & "		                AND (m.primary_broker_code IN (:p_primarybroker))   "
query = query & "		                AND gd.GROUP_CODE in (:vp)   "
query = query & "		                GROUP BY "
query = query & "		                sc.DEPT_LEVEL, "
query = query & "		                sc.DEPT_LEVEL_SEQ, "
query = query & "		                sc.CUSTOMER_LEVEL_SEQ, "
query = query & "		                sc.CUSTOMER_LEVEL, "
query = query & "		                sc.MANAGEMENT_LEVEL, "
query = query & "		                sc.MANAGEMENT_LEVEL_SEQ, "
query = query & "						mpbd.sales_unit_code,   "
query = query & "		                sc.spend_base_descr,   "
query = query & "		                sc.spend_base_seq,   "
query = query & "		                sc.spend_subcategory_descr,   "
query = query & "		                sc.spend_subcategory_seq,   "
query = query & "		                md.year_descr,   "
query = query & "		                md.month_descr,   "
query = query & "		                md.FISCAL_MONTH_NUMBER   "
query = query & "						  "
query = query & "		                /*-Add Expense Total Value Added*/   "
query = query & "		                UNION  ALL "
query = query & "		                SELECT      "
query = query & "		                sc.DEPT_LEVEL, "
query = query & "		                sc.DEPT_LEVEL_SEQ, "
query = query & "		                sc.CUSTOMER_LEVEL_SEQ, "
query = query & "		                sc.CUSTOMER_LEVEL, "
query = query & "		                sc.MANAGEMENT_LEVEL, "
query = query & "		                sc.MANAGEMENT_LEVEL_SEQ,   "
query = query & "		                CASE WHEN (md.FISCAL_MONTH_NUMBER = (:p_Month))THEN SUM (epf.expense_amt)   "
query = query & "		                END AS monthexpense_amt,   "
query = query & "		                0 AS monthpounds,   "
query = query & "		                0 AS monthnetreceivables,   "
query = query & "						mpbd.sales_unit_code,   "
query = query & "		               case when (mpbd.sales_unit_code IN  ('F01', 'F08', 'F15'))Then 'Total Value Added'  "
query = query & "		                    when (mpbd.sales_unit_code IN  ('F03', 'F04'))Then 'Total Market/CVP'          "
query = query & "			      when (mpbd.sales_unit_code IN  ('F30', 'F31'))Then 'Total Government Sales'    "
query = query & "		                    when (mpbd.sales_unit_code IN  ('F01', 'F08','F15', 'F03', 'F04','F20'))Then 'Total Distribution'     "
query = query & "		                    End as sales_unit_descr, "
query = query & "		                sc.spend_base_descr,   "
query = query & "		                sc.spend_base_seq,   "
query = query & "		                sc.spend_subcategory_descr,   "
query = query & "		                sc.spend_subcategory_seq,   "
query = query & "		                md.year_descr,   "
query = query & "		                md.month_descr,   "
query = query & "		                SUM (epf.expense_amt) AS expense_amt,   "
query = query & "		                0 AS total_pounds_shipped,   "
query = query & "		                0 AS net_receivable_dollar   "
query = query & "		                FROM tdw_owner.restated_mkt_prd_bus_div_dim mpbd,   "
query = query & "		                tdw_owner.expense_payment_fact epf,   "
query = query & "		                tdw_owner.fsv_spend_category sc,   "
query = query & "		                tdw_owner.restated_market m,   "
query = query & "		                tdw_owner.month_dim md,   "
query = query & "		                tdw_owner.restated_product p,   "
query = query & "		                tdw_owner.acct_dim a,   "
query = query & "		                tdw_owner.expense_type et,   "
query = query & "		                tdw_owner.spend_request_dim s,   "
query = query & "		                tdw_owner.operator_dim o,   "
query = query & "		                tdw_owner.day_dim d1,   "
query = query & "		                tdw_owner.day_dim d2,   "
query = query & "		                tdw_owner.expense_attribute_dim ead,   "
query = query & "		                tdw_owner.expense_payee_dim pay,   "
query = query & "		                tdw_owner.group_detail gd,   "
query = query & "		                tdw_owner.group_description groupdescr   "
query = query & "		                WHERE mpbd.restated_mkt_prd_bus_div_key = epf.restated_mkt_prd_bus_div_key   "
query = query & "		                AND epf.expense_type_key = sc.expense_type_key   "
query = query & "		                AND epf.acct_key = sc.acct_key   "
query = query & "		                AND epf.restated_market_key = m.restated_market_key   "
query = query & "		                AND epf.month_key = md.month_key   "
query = query & "		                AND epf.restated_product_key = p.restated_product_key   "
query = query & "		                AND epf.acct_key = a.acct_key   "
query = query & "		                AND epf.expense_type_key = et.expense_type_key   "
query = query & "		                AND epf.spend_request_key = s.spend_request_key   "
query = query & "		                AND epf.operator_key = o.operator_key   "
query = query & "		                AND epf.report_period_begin_day_key = d1.day_key   "
query = query & "		                AND epf.report_period_end_day_key = d2.day_key   "
query = query & "		                AND epf.expense_attribute_key = ead.expense_attribute_key   "
query = query & "		                AND epf.expense_payee_key = pay.expense_payee_key   "
query = query & "		                AND gd.GROUP_CODE = groupdescr.GROUP_CODE   "
query = query & "		                AND gd.group_field_c  =  m.DIVISION_CODE   "
query = query & "		                AND sc.spend_base_seq <> 0   "
query = query & "		                AND sc.spend_subcategory_seq <> 0   "
query = query & "				  AND (mpbd.sales_unit_code IN ('F01', 'F03', 'F04', 'F08', 'F30' ,'F31' ,'F15','F20')) "
query = query & "		                AND (m.selling_group_code IN ('119000', '125000', '610000', '800000', '423000'))   "
query = query & "		                AND (md.year_descr IN (:p_year))   "
query = query & "		                and md.fiscal_month_number <= :p_Month   "
query = query & "		                AND (mpbd.sales_unit_code IN (:p_sales_unit))   "
query = query & "		                AND (m.division_code IN (:p_salesdivision))   "
query = query & "		                AND (m.region_code IN (:p_salesregion))   "
query = query & "		                AND (m.primary_broker_code IN (:p_primarybroker))   "
query = query & "		                AND gd.GROUP_CODE in (:vp)   "
query = query & "		                GROUP BY "
query = query & "		                sc.DEPT_LEVEL, "
query = query & "		                sc.DEPT_LEVEL_SEQ, "
query = query & "		                sc.CUSTOMER_LEVEL_SEQ, "
query = query & "		                sc.CUSTOMER_LEVEL, "
query = query & "		                sc.MANAGEMENT_LEVEL, "
query = query & "		                sc.MANAGEMENT_LEVEL_SEQ, "
query = query & "						mpbd.sales_unit_code,   "
query = query & "		                sc.spend_base_descr,   "
query = query & "		                sc.spend_base_seq,   "
query = query & "		                sc.spend_subcategory_descr,   "
query = query & "		                sc.spend_subcategory_seq,   "
query = query & "		                md.year_descr,   "
query = query & "		                md.month_descr,   "
query = query & "		                md.FISCAL_MONTH_NUMBER   "
query = query & "		                          		 "
query = query & "		                /* Add - Expense Total customer*/  		 "
query = query & "		                UNION  ALL "
query = query & "		                SELECT      "
query = query & "		                sc.DEPT_LEVEL, "
query = query & "		                sc.DEPT_LEVEL_SEQ, "
query = query & "		                sc.CUSTOMER_LEVEL_SEQ, "
query = query & "		                sc.CUSTOMER_LEVEL, "
query = query & "		                sc.MANAGEMENT_LEVEL, "
query = query & "		                sc.MANAGEMENT_LEVEL_SEQ,   "
query = query & "		                CASE WHEN (md.FISCAL_MONTH_NUMBER = (:p_Month))THEN SUM (epf.expense_amt)   "
query = query & "		                END AS monthexpense_amt,   "
query = query & "		                0 AS monthpounds,   "
query = query & "		                0 AS monthnetreceivables,         		 "
query = query & "						mpbd.sales_unit_code,    "
query = query & "		                case when (mpbd.sales_unit_code IN  ('F01', 'F03', 'F04', 'F08', 'F30', 'F31', 'F15','F20'))Then 'Total Customer' "
query = query & "		                     End as sales_unit_descr,   "
query = query & "		                sc.spend_base_descr,   "
query = query & "		                sc.spend_base_seq,   "
query = query & "		                sc.spend_subcategory_descr,   "
query = query & "		                sc.spend_subcategory_seq,   "
query = query & "		                md.year_descr,   "
query = query & "		                md.month_descr,   "
query = query & "		                SUM (epf.expense_amt) AS expense_amt,   "
query = query & "		                0 AS total_pounds_shipped,   "
query = query & "		                0 AS net_receivable_dollar   "
query = query & "		                FROM tdw_owner.restated_mkt_prd_bus_div_dim mpbd,   "
query = query & "		                tdw_owner.expense_payment_fact epf,   "
query = query & "		                tdw_owner.fsv_spend_category sc,   "
query = query & "		                tdw_owner.restated_market m,   "
query = query & "		                tdw_owner.month_dim md,   "
query = query & "		                tdw_owner.restated_product p,   "
query = query & "		                tdw_owner.acct_dim a,   "
query = query & "		                tdw_owner.expense_type et,   "
query = query & "		                tdw_owner.spend_request_dim s,   "
query = query & "		                tdw_owner.operator_dim o,   "
query = query & "		                tdw_owner.day_dim d1,   "
query = query & "		                tdw_owner.day_dim d2,   "
query = query & "		                tdw_owner.expense_attribute_dim ead,   "
query = query & "		                tdw_owner.expense_payee_dim pay,   "
query = query & "		                tdw_owner.group_detail gd,   "
query = query & "		                tdw_owner.group_description groupdescr   "
query = query & "		                WHERE mpbd.restated_mkt_prd_bus_div_key = epf.restated_mkt_prd_bus_div_key   "
query = query & "		                AND epf.expense_type_key = sc.expense_type_key   "
query = query & "		                AND epf.acct_key = sc.acct_key   "
query = query & "		                AND epf.restated_market_key = m.restated_market_key   "
query = query & "		                AND epf.month_key = md.month_key   "
query = query & "		                AND epf.restated_product_key = p.restated_product_key   "
query = query & "		                AND epf.acct_key = a.acct_key   "
query = query & "		                AND epf.expense_type_key = et.expense_type_key   "
query = query & "		                AND epf.spend_request_key = s.spend_request_key   "
query = query & "		                AND epf.operator_key = o.operator_key   "
query = query & "		                AND epf.report_period_begin_day_key = d1.day_key   "
query = query & "		                AND epf.report_period_end_day_key = d2.day_key   "
query = query & "		                AND epf.expense_attribute_key = ead.expense_attribute_key   "
query = query & "		                AND epf.expense_payee_key = pay.expense_payee_key   "
query = query & "		                AND gd.GROUP_CODE = groupdescr.GROUP_CODE   "
query = query & "		                AND gd.group_field_c  =  m.DIVISION_CODE   "
query = query & "		                AND sc.spend_base_seq <> 0   "
query = query & "		                AND sc.spend_subcategory_seq <> 0   "
query = query & "				  AND (mpbd.sales_unit_code IN ('F01', 'F03', 'F04', 'F08', 'F30' ,'F31' ,'F15','F20'))  "
query = query & "		                AND (m.selling_group_code IN ('119000', '125000', '610000', '800000', '423000'))   "
query = query & "		                AND (md.year_descr IN (:p_year))   "
query = query & "		                and md.fiscal_month_number <= :p_Month   "
query = query & "		                AND (mpbd.sales_unit_code IN (:p_sales_unit))   "
query = query & "		                AND (m.division_code IN (:p_salesdivision))   "
query = query & "		                AND (m.region_code IN (:p_salesregion))   "
query = query & "		                AND (m.primary_broker_code IN (:p_primarybroker))   "
query = query & "		                AND gd.GROUP_CODE in (:vp)   "
query = query & "		                GROUP BY "
query = query & "		                sc.DEPT_LEVEL, "
query = query & "		                sc.DEPT_LEVEL_SEQ, "
query = query & "		                sc.CUSTOMER_LEVEL_SEQ, "
query = query & "		                sc.CUSTOMER_LEVEL, "
query = query & "		                sc.MANAGEMENT_LEVEL, "
query = query & "		                sc.MANAGEMENT_LEVEL_SEQ, "
query = query & "						mpbd.sales_unit_code,  "
query = query & "		                sc.spend_base_descr,   "
query = query & "		                sc.spend_base_seq,   "
query = query & "		                sc.spend_subcategory_descr,   "
query = query & "		                sc.spend_subcategory_seq,   "
query = query & "		                md.year_descr,   "
query = query & "		                md.month_descr,   "
query = query & "		                md.FISCAL_MONTH_NUMBER   "
query = query & "		                          "
query = query & "		       /*Begin Volume*/   "
query = query & "				UNION  ALL "
query = query & "					SELECT "
query = query & "		           'zzz' AS DEPT_LEVEL, "
query = query & "		           999 AS DEPT_LEVEL_SEQ, "
query = query & "		           999 AS CUSTOMER_LEVEL_SEQ, "
query = query & "		           'zzz' AS CUSTOMER_LEVEL, "
query = query & "		           'zzz' AS MANAGEMENT_LEVEL, "
query = query & "		           999 AS MANAGEMENT_LEVEL_SEQ, "
query = query & "		           0 AS monthexpense_amt,   "
query = query & "		           CASE WHEN (ids_mf.FISCAL_MONTH_NUMBER = (:p_Month))   "
query = query & "		                THEN SUM (  ids_mf.mf_pounds_shipped   "
query = query & "		                            + ids_mf.ids_pounds_shipped)   "
query = query & "		           END AS monthpounds,   "
query = query & "		           CASE WHEN (ids_mf.FISCAL_MONTH_NUMBER = (:p_Month))   "
query = query & "		                THEN SUM (  ids_mf.mf_gross_sales_amount   "
query = query & "		                          - ids_mf.mf_allow_amount   "
query = query & "		                          - ids_mf.mf_off_invoice_amount   "
query = query & "		                          + ids_mf.mf_revenue_adjustment                         "
query = query & "		                          + ids_mf.ids_indirect_sales_amount)   "
query = query & "		           END AS monthnetreceivables,   "
query = query & "				   ids_mf.sales_unit_code,   "
query = query & "		           ids_mf.sales_unit_descr, "
query = query & "		           NULL AS spend_base_descr,   "
query = query & "		           NULL AS spend_base_seq,   "
query = query & "		           NULL AS spend_subcategory_descr,   "
query = query & "		           NULL AS spend_subcategory_seq,   "
query = query & "		           ids_mf.year_descr,   "
query = query & "		           ids_mf.month_descr,   "
query = query & "		           0 AS expense_amt,   "
query = query & "		           SUM (  ids_mf.mf_pounds_shipped   "
query = query & "		                  + ids_mf.ids_pounds_shipped   "
query = query & "		                  ) AS total_pounds_shipped,   "
query = query & "		           SUM (  ids_mf.mf_gross_sales_amount   "
query = query & "		                  - ids_mf.mf_allow_amount   "
query = query & "		                  - ids_mf.mf_off_invoice_amount   "
query = query & "		                  + ids_mf.mf_revenue_adjustment   "
query = query & "		                  + ids_mf.ids_indirect_sales_amount   "
query = query & "		                  ) AS net_receivable_dollar   "
query = query & "		           FROM ( "
query = query & "			       SELECT mpbd1.sales_unit_code,   "
query = query & "		               case when mpbd1.sales_unit_code = 'F01' Then 'Distribution Frozen' 		 "
query = query & "		                    when mpbd1.sales_unit_code = 'F08' Then 'Distribut Prep Foods' "
query = query & "		                    when mpbd1.sales_unit_code = 'F15' Then 'Distribution Other'   "
query = query & "		                    when mpbd1.sales_unit_code = 'F03' Then 'Distribution Market'  "
query = query & "		                    when mpbd1.sales_unit_code = 'F04' Then 'Distribution CVP'     "
query = query & "		                    when mpbd1.sales_unit_code = 'F20' Then 'Distribution Fowl'    "
query = query & "		                    when mpbd1.sales_unit_code = 'F30' Then 'Gov''t Sales-Poultry' "
query = query & "		                    when mpbd1.sales_unit_code = 'F31' Then 'Gov''t Sales-Prepared' "
query = query & "                                    End as sales_unit_descr,		 "
query = query & "		               gd.group_code, "
query = query & "		               groupdescr.GROUP_DESCR, "
query = query & "		               m1.DIVISION_CODE,  "
query = query & "		               m1.DIVISION_DESCR,  "
query = query & "		               m1.REGION_CODE,  "
query = query & "		               m1.REGION_DESCR, "
query = query & "		               wd1.year_descr, "
query = query & "		               wd1.month_descr, "
query = query & "		               wd1.FISCAL_MONTH_NUMBER, "
query = query & "		               mf.pounds_shipped AS mf_pounds_shipped,   "
query = query & "		               mf.gross_sales_amount AS mf_gross_sales_amount,   "
query = query & "		               mf.allow_amount AS mf_allow_amount,   "
query = query & "		               mf.gross_sales_variance AS mf_revenue_adjustment,  "
query = query & "		               mf.off_invoice_amount AS mf_off_invoice_amount,   "
query = query & "		               0 AS ids_pounds_shipped,   "
query = query & "		               0 AS ids_indirect_sales_amount   "
query = query & "		               FROM tdw_owner.restated_mkt_prd_bus_div_dim mpbd1,   "
query = query & "		               tdw_owner.restated_market m1,   "
query = query & "		               tdw_owner.restated_product p1,   "
query = query & "		               tdw_owner.ta_margin_fact_view mf, "
query = query & "		               tdw_owner.week_dim wd1,  "
query = query & "		               tdw_owner.group_detail gd,   "
query = query & "		               tdw_owner.group_description groupdescr   "
query = query & "		               WHERE mf.restated_market_key = m1.restated_market_key   "
query = query & "		               AND mf.restated_product_key = p1.restated_product_key   "
query = query & "		               AND mf.restated_market_key = mpbd1.restated_market_key   "
query = query & "		               AND mf.restated_product_key = mpbd1.restated_product_key   "
query = query & "		               AND To_DATE(mf.week_key,'YYYYMMDD')  = wd1.week_ending_date "
query = query & "		               AND gd.GROUP_CODE = groupdescr.GROUP_CODE   "
query = query & "		               AND gd.group_field_c  =  m1.DIVISION_CODE   "
query = query & "		               AND (mpbd1.sales_unit_code IN ('F01', 'F03', 'F04', 'F08', 'F30' ,'F31' ,'F15','F20'))  "
query = query & "		               AND (m1.selling_group_code IN ('119000', '125000', '610000', '800000', '423000'))    "
query = query & "		               AND (wd1.YEAR_DESCR IN (:p_year)) "
query = query & "		               AND wd1.FISCAL_MONTH_NUMBER <= :p_Month  "
query = query & "		               AND (mpbd1.sales_unit_code IN (:p_sales_unit)) "
query = query & "		               AND (m1.division_code IN (:p_salesdivision))   "
query = query & "		               AND (m1.region_code IN (:p_salesregion))   "
query = query & "		               AND (m1.primary_broker_code IN (:p_primarybroker))   "
query = query & "		               AND gd.GROUP_CODE in (:vp)   "
query = query & "		                 "
query = query & "		               UNION  ALL "
query = query & "		                "
query = query & "		               SELECT  "
query = query & "		               mpbd1.sales_unit_code,  		 "
query = query & "		               case when mpbd1.sales_unit_code = 'F01' Then 'Distribution Frozen' "
query = query & "		                    when mpbd1.sales_unit_code = 'F08' Then 'Distribut Prep Foods' "
query = query & "		                    when mpbd1.sales_unit_code = 'F15' Then 'Distribution Other'  "
query = query & "		                    when mpbd1.sales_unit_code = 'F03' Then 'Distribution Market' "
query = query & "		                    when mpbd1.sales_unit_code = 'F04' Then 'Distribution CVP'    "
query = query & "		                    when mpbd1.sales_unit_code = 'F20' Then 'Distribution Fowl'   "
query = query & "		                    when mpbd1.sales_unit_code = 'F30' Then 'Gov''t Sales-Poultry' "
query = query & "		                    when mpbd1.sales_unit_code = 'F31' Then 'Gov''t Sales-Prepared' "
query = query & "                                    End as sales_unit_descr,		 "
query = query & "		               gd.group_code, "
query = query & "		               groupdescr.GROUP_DESCR, "
query = query & "		               m1.DIVISION_CODE,  "
query = query & "		               m1.DIVISION_DESCR,  "
query = query & "		               m1.REGION_CODE,  "
query = query & "		               m1.REGION_DESCR, "
query = query & "		               md1.year_descr,   "
query = query & "		               md1.month_descr,   "
query = query & "		               md1.FISCAL_MONTH_NUMBER,   "
query = query & "		               0 AS mf_pounds_shipped,   "
query = query & "		               0 AS mf_gross_sales_amount,   "
query = query & "		               0 AS mf_allow_amount,   "
query = query & "		               0 AS mf_revenue_adjustment,   "
query = query & "		               0 AS mf_off_invoice_amount,   "
query = query & "		               ids.pounds_shipped AS ids_pounds_shipped,   "
query = query & "		               ids.indirect_sales_amount AS ids_indirect_sales_amount   "
query = query & "		               FROM tdw_owner.restated_mkt_prd_bus_div_dim mpbd1,   "
query = query & "		               tdw_owner.restated_market m1,   "
query = query & "		               tdw_owner.month_dim md1,   "
query = query & "		               tdw_owner.restated_product p1,   "
query = query & "		               tdw_owner.indirect_sales ids,   "
query = query & "		               tdw_owner.week_dim w1,   "
query = query & "		               tdw_owner.group_detail gd,   "
query = query & "		               tdw_owner.group_description groupdescr   "
query = query & "		               WHERE ids.restated_market_key = m1.restated_market_key   "
query = query & "		               AND ids.restated_product_key = p1.restated_product_key   "
query = query & "		               AND ids.restated_market_key = mpbd1.restated_market_key   "
query = query & "		               AND ids.restated_product_key = mpbd1.restated_product_key   "
query = query & "		               AND ids.week_key = w1.week_key   "
query = query & "		               AND w1.month_ending_date = md1.month_ending_date   "
query = query & "		               AND gd.GROUP_CODE = groupdescr.GROUP_CODE   "
query = query & "		               AND gd.group_field_c  =  m1.DIVISION_CODE   "
query = query & "		               AND (mpbd1.sales_unit_code IN ('F01', 'F03', 'F04', 'F08', 'F30' ,'F31' ,'F15','F20')) "
query = query & "		               AND (m1.selling_group_code IN ('119000', '125000', '610000', '800000', '423000'))   "
query = query & "		               AND (md1.year_descr IN (:p_year))   "
query = query & "		               AND md1.fiscal_month_number <= :p_Month   "
query = query & "		               AND (mpbd1.sales_unit_code IN (:p_sales_unit)) "
query = query & "		               AND (m1.division_code IN (:p_salesdivision))   "
query = query & "		               AND (m1.region_code IN (:p_salesregion))   "
query = query & "		               AND (m1.primary_broker_code IN (:p_primarybroker))   "
query = query & "		               AND gd.GROUP_CODE in (:vp)   "
query = query & "		               )/*end sub query*/   "
query = query & "				    ids_mf "
query = query & "					GROUP BY "
query = query & "					1, "
query = query & "					2, "
query = query & "					3, "
query = query & "					4, "
query = query & "					5, "
query = query & "					6, "
query = query & "					ids_mf.sales_unit_code,     "
query = query & "					ids_mf.sales_unit_descr,   "
query = query & "					ids_mf.year_descr,   "
query = query & "					ids_mf.month_descr,   "
query = query & "					ids_mf.FISCAL_MONTH_NUMBER "
query = query & "		                 "
query = query & "		               /*Begin Volume 'Total Value Added'*/   "
query = query & "				  UNION  ALL "
query = query & "		                SELECT      "
query = query & "		               'zzz' AS DEPT_LEVEL, "
query = query & "		               999 AS DEPT_LEVEL_SEQ, "
query = query & "		               999 AS CUSTOMER_LEVEL_SEQ, "
query = query & "		               'zzz' AS CUSTOMER_LEVEL, "
query = query & "		               'zzz' AS MANAGEMENT_LEVEL, "
query = query & "		               999 AS MANAGEMENT_LEVEL_SEQ,   "
query = query & "		               0 AS monthexpense_amt,   "
query = query & "		               CASE WHEN (ids_mf.FISCAL_MONTH_NUMBER = (:p_Month))   "
query = query & "		                    THEN SUM (  ids_mf.mf_pounds_shipped   "
query = query & "		                              + ids_mf.ids_pounds_shipped)   "
query = query & "		               END AS monthpounds,   "
query = query & "		               CASE WHEN (ids_mf.FISCAL_MONTH_NUMBER = (:p_Month))   "
query = query & "		                    THEN SUM (  ids_mf.mf_gross_sales_amount   "
query = query & "		                              - ids_mf.mf_allow_amount   "
query = query & "		                              - ids_mf.mf_off_invoice_amount   "
query = query & "		                                + ids_mf.mf_revenue_adjustment   "
query = query & "		                              + ids_mf.ids_indirect_sales_amount)   "
query = query & "		               END AS monthnetreceivables, "
query = query & "					   ids_mf.sales_unit_code,   "
query = query & "		               case when (ids_mf.sales_unit_code IN ('F01', 'F08', 'F15'))Then 'Total Value Added'  "
query = query & "		                    when (ids_mf.sales_unit_code IN ('F03', 'F04'))Then 'Total Market/CVP'          "
query = query & "		                    when (ids_mf.sales_unit_code IN ('F30', 'F31'))Then 'Government Sales Total'    "
query = query & "		                    when (ids_mf.sales_unit_code IN ('F01', 'F08', 'F15','F03', 'F04','F20'))Then 'Total Distribution' "
query = query & "		                    End AS businessdivisiondescr,  		 "
query = query & "		               NULL AS spend_base_descr,   "
query = query & "		               NULL AS spend_base_seq,   "
query = query & "		               NULL AS spend_subcategory_descr,   "
query = query & "		               NULL AS spend_subcategory_seq,   "
query = query & "		               ids_mf.year_descr,   "
query = query & "		               ids_mf.month_descr,   "
query = query & "		               0 AS expense_amt,   "
query = query & "		                SUM (  ids_mf.mf_pounds_shipped   "
query = query & "		                      + ids_mf.ids_pounds_shipped   "
query = query & "		                      ) AS total_pounds_shipped,   "
query = query & "		               SUM (  ids_mf.mf_gross_sales_amount   "
query = query & "		                      - ids_mf.mf_allow_amount   "
query = query & "		                      - ids_mf.mf_off_invoice_amount   "
query = query & "		                      + ids_mf.mf_revenue_adjustment   "
query = query & "		                      + ids_mf.ids_indirect_sales_amount   "
query = query & "		                      ) AS net_receivable_dollar   "
query = query & "		               FROM ( "
query = query & "		                   SELECT    "
query = query & "		                   mpbd1.sales_unit_code,   "
query = query & "		                   case when mpbd1.sales_unit_code = 'F01' Then 'Distribution Frozen' "
query = query & "		                        when mpbd1.sales_unit_code = 'F08' Then 'Distribut Prep Foods' "
query = query & "		                        when mpbd1.sales_unit_code = 'F15' Then 'Distribution Other'  "
query = query & "		                        when mpbd1.sales_unit_code = 'F03' Then 'Distribution Market' "
query = query & "		                        when mpbd1.sales_unit_code = 'F04' Then 'Distribution CVP'    "
query = query & "		                        when mpbd1.sales_unit_code = 'F20' Then 'Distribution Fowl'   "
query = query & "		                        when mpbd1.sales_unit_code = 'F30' Then 'Gov''t Sales-Poultry' "
query = query & "		                        when mpbd1.sales_unit_code = 'F31' Then 'Gov''t Sales-Prepared' "
query = query & "                                        End as sales_unit_descr,		 "
query = query & "		                   gd.group_code, "
query = query & "		                   groupdescr.group_descr, "
query = query & "		                   m1.DIVISION_CODE, "
query = query & "		                   m1.DIVISION_DESCR, "
query = query & "		                   m1.REGION_CODE, "
query = query & "		                   m1.REGION_DESCR, "
query = query & "		                   wd1.year_descr,  "
query = query & "		                   wd1.month_descr,  "
query = query & "		                   wd1.FISCAL_MONTH_NUMBER, "
query = query & "		                   mf.pounds_shipped AS mf_pounds_shipped,    "
query = query & "		                   mf.gross_sales_amount AS mf_gross_sales_amount,   "
query = query & "		                   mf.allow_amount AS mf_allow_amount,   "
query = query & "		                   mf.gross_sales_variance AS mf_revenue_adjustment, "
query = query & "		                   mf.off_invoice_amount AS mf_off_invoice_amount,   "
query = query & "		                   0 AS ids_pounds_shipped,   "
query = query & "		                   0 AS ids_indirect_sales_amount   "
query = query & "		                   FROM tdw_owner.restated_mkt_prd_bus_div_dim mpbd1,   "
query = query & "		                   tdw_owner.restated_market m1,   "
query = query & "		                   tdw_owner.restated_product p1,   "
query = query & "		                   tdw_owner.ta_margin_fact_view mf, "
query = query & "		                   tdw_owner.week_dim wd1,  "
query = query & "		                   tdw_owner.group_detail gd,   "
query = query & "		                   tdw_owner.group_description groupdescr   "
query = query & "		                   WHERE mf.restated_market_key = m1.restated_market_key   "
query = query & "		                   AND mf.restated_product_key = p1.restated_product_key   "
query = query & "		                   AND mf.restated_market_key = mpbd1.restated_market_key   "
query = query & "		                   AND mf.restated_product_key = mpbd1.restated_product_key   "
query = query & "		                   AND To_DATE(mf.week_key,'YYYYMMDD')  = wd1.week_ending_date "
query = query & "		                   AND gd.GROUP_CODE = groupdescr.GROUP_CODE   "
query = query & "		                   AND gd.group_field_c  =  m1.DIVISION_CODE   "
query = query & "		                   AND (mpbd1.sales_unit_code IN ('F01', 'F03', 'F04', 'F08', 'F30' ,'F31' ,'F15','F20'))  "
query = query & "		                   AND (m1.selling_group_code IN ('119000', '125000', '610000', '800000', '423000')) "
query = query & "		                   AND (wd1.YEAR_DESCR IN (:p_year)) "
query = query & "		                   AND wd1.FISCAL_MONTH_NUMBER <= :p_Month "
query = query & "		                   AND (mpbd1.sales_unit_code IN (:p_sales_unit))  "
query = query & "		                   AND (m1.division_code IN (:p_salesdivision))   "
query = query & "		                   AND (m1.region_code IN (:p_salesregion))   "
query = query & "		                   AND (m1.primary_broker_code IN (:p_primarybroker))   "
query = query & "		                   AND gd.GROUP_CODE in (:vp)   "
query = query & "		 "
query = query & "		                   UNION  ALL "
query = query & "		                    "
query = query & "		                   SELECT   "
query = query & "		                   mpbd1.sales_unit_code,   		 "
query = query & "		                   case when mpbd1.sales_unit_code = 'F01' Then 'Distribution Frozen'  "
query = query & "		                        when mpbd1.sales_unit_code = 'F08' Then 'Distribut Prep Foods' "
query = query & "		                        when mpbd1.sales_unit_code = 'F15' Then 'Distribution Other'   "
query = query & "		                        when mpbd1.sales_unit_code = 'F03' Then 'Distribution Market'  "
query = query & "		                        when mpbd1.sales_unit_code = 'F04' Then 'Distribution CVP'     "
query = query & "		                        when mpbd1.sales_unit_code = 'F20' Then 'Distribution Fowl'    "
query = query & "		                        when mpbd1.sales_unit_code = 'F30' Then 'Gov''t Sales-Poultry' "
query = query & "		                        when mpbd1.sales_unit_code = 'F31' Then 'Gov''t Sales-Prepared' "
query = query & "                                        End as sales_unit_descr,	 "
query = query & "		                   gd.group_code, "
query = query & "		                   groupdescr.group_descr, "
query = query & "		                   m1.DIVISION_CODE, "
query = query & "		                   m1.DIVISION_DESCR, "
query = query & "		                   m1.REGION_CODE, "
query = query & "		                   m1.REGION_DESCR, "
query = query & "		                   md1.year_descr,   "
query = query & "		                   md1.month_descr,   "
query = query & "		                   md1.FISCAL_MONTH_NUMBER,   "
query = query & "		                   0 AS mf_pounds_shipped, "
query = query & "		                   0 AS mf_gross_sales_amount,   "
query = query & "		                   0 AS mf_allow_amount,   "
query = query & "		                   0 AS mf_revenue_adjustment,   "
query = query & "		                   0 AS mf_off_invoice_amount,   "
query = query & "		                   ids.pounds_shipped AS ids_pounds_shipped,   "
query = query & "		                   ids.indirect_sales_amount AS ids_indirect_sales_amount   "
query = query & "		                   FROM tdw_owner.restated_mkt_prd_bus_div_dim mpbd1,   "
query = query & "		                   tdw_owner.restated_market m1,   "
query = query & "		                   tdw_owner.month_dim md1,   "
query = query & "		                   tdw_owner.restated_product p1,   "
query = query & "		                   tdw_owner.indirect_sales ids,   "
query = query & "		                   tdw_owner.week_dim w1,   "
query = query & "		                   tdw_owner.group_detail gd,   "
query = query & "		                   tdw_owner.group_description groupdescr   "
query = query & "		                   WHERE ids.restated_market_key = m1.restated_market_key   "
query = query & "		                   AND ids.restated_product_key = p1.restated_product_key   "
query = query & "		                   AND ids.restated_market_key = mpbd1.restated_market_key   "
query = query & "		                   AND ids.restated_product_key = mpbd1.restated_product_key   "
query = query & "		                   AND ids.week_key = w1.week_key   "
query = query & "		                   AND w1.month_ending_date = md1.month_ending_date   "
query = query & "		                   AND gd.GROUP_CODE = groupdescr.GROUP_CODE   "
query = query & "		                   AND gd.group_field_c  =  m1.DIVISION_CODE   "
query = query & "		                   AND (mpbd1.sales_unit_code IN ('F01', 'F03', 'F04', 'F08', 'F30' ,'F31' ,'F15','F20'))  "
query = query & "		                   AND (m1.selling_group_code IN ('119000', '125000', '610000', '800000', '423000'))   "
query = query & "		                   AND (md1.year_descr IN (:p_year))   "
query = query & "		                   and md1.fiscal_month_number <= :p_Month   "
query = query & "		                   AND (mpbd1.sales_unit_code IN (:p_sales_unit))   "
query = query & "		                   AND (m1.division_code IN (:p_salesdivision))   "
query = query & "		                   AND (m1.region_code IN (:p_salesregion))   "
query = query & "		                   AND (m1.primary_broker_code IN (:p_primarybroker))   "
query = query & "		                   AND gd.GROUP_CODE in (:vp) "
query = query & "		                   ) /*end sub query*/   "
query = query & "		               ids_mf "
query = query & "		               GROUP BY "
query = query & "		               1, "
query = query & "		               2, "
query = query & "		               3, "
query = query & "		               4, "
query = query & "		               5, "
query = query & "		               6, "
query = query & "					   ids_mf.sales_unit_code,   "
query = query & "		               ids_mf.year_descr,   "
query = query & "		               ids_mf.month_descr,   "
query = query & "		               ids_mf.FISCAL_MONTH_NUMBER   "
query = query & "		               /*Begin Volume Total customer*/   "
query = query & "		               UNION  ALL "
query = query & "		                               SELECT      "
query = query & "		               'zzz' AS DEPT_LEVEL, "
query = query & "		                999 AS DEPT_LEVEL_SEQ, "
query = query & "		                999 AS CUSTOMER_LEVEL_SEQ, "
query = query & "		                'zzz' AS CUSTOMER_LEVEL, "
query = query & "		                'zzz' AS MANAGEMENT_LEVEL, "
query = query & "		                999 AS MANAGEMENT_LEVEL_SEQ,   "
query = query & "		               0 AS monthexpense_amt,   "
query = query & "		               CASE WHEN (ids_mf.FISCAL_MONTH_NUMBER = (:p_Month))   "
query = query & "		                    THEN SUM (  ids_mf.mf_pounds_shipped "
query = query & "		                              + ids_mf.ids_pounds_shipped)   "
query = query & "		               END AS monthpounds,   "
query = query & "		               CASE WHEN (ids_mf.FISCAL_MONTH_NUMBER = (:p_Month))   "
query = query & "		                    THEN SUM (  ids_mf.mf_gross_sales_amount   "
query = query & "		                              - ids_mf.mf_allow_amount   "
query = query & "		                              - ids_mf.mf_off_invoice_amount   "
query = query & "		                                + ids_mf.mf_revenue_adjustment   "
query = query & "		                              + ids_mf.ids_indirect_sales_amount)   "
query = query & "		               END AS monthnetreceivables, "
query = query & "					   ids_mf.sales_unit_code,  "
query = query & "		               case when (ids_mf.sales_unit_code IN ('F01', 'F08', 'F15','F03', 'F04','F20','F30','F31'))Then 'Total Customer' "
query = query & "		                    End as sales_unit_descr,    "
query = query & "		               NULL AS spend_base_descr,   "
query = query & "		               NULL AS spend_base_seq,   "
query = query & "		               NULL AS spend_subcategory_descr,   "
query = query & "		               NULL AS spend_subcategory_seq,   "
query = query & "		               ids_mf.year_descr,   "
query = query & "		               ids_mf.month_descr,   "
query = query & "		               0 AS expense_amt,   "
query = query & "		               SUM (  ids_mf.mf_pounds_shipped "
query = query & "		                       + ids_mf.ids_pounds_shipped   "
query = query & "		                       ) AS total_pounds_shipped,   "
query = query & "		               SUM (  ids_mf.mf_gross_sales_amount   "
query = query & "		                      - ids_mf.mf_allow_amount   "
query = query & "		                      - ids_mf.mf_off_invoice_amount   "
query = query & "		                      + ids_mf.mf_revenue_adjustment   "
query = query & "		                      + ids_mf.ids_indirect_sales_amount   "
query = query & "		                      ) AS net_receivable_dollar   "
query = query & "		               FROM (   "
query = query & "		                 /*Begin sub query*/   "
query = query & "		                SELECT   mpbd1.sales_unit_code,   "
query = query & "		                case when mpbd1.sales_unit_code = 'F01' Then 'Distribution Frozen'  "
query = query & "		                     when mpbd1.sales_unit_code = 'F08' Then 'Distribut Prep Foods' "
query = query & "		                     when mpbd1.sales_unit_code = 'F15' Then 'Distribution Other'   "
query = query & "		                     when mpbd1.sales_unit_code = 'F03' Then 'Distribution Market'  "
query = query & "		                     when mpbd1.sales_unit_code = 'F04' Then 'Distribution CVP'     "
query = query & "		                     when mpbd1.sales_unit_code = 'F20' Then 'Distribution Fowl'    "
query = query & "		                     when mpbd1.sales_unit_code = 'F30' Then 'Gov''t Sales-Poultry' "
query = query & "		                     when mpbd1.sales_unit_code = 'F31' Then 'Gov''t Sales-Prepared' "
query = query & "                                     End as sales_unit_descr,		 "
query = query & "		                 gd.group_code, "
query = query & "		                 groupdescr.group_descr, "
query = query & "		                 m1.division_code, "
query = query & "		                 m1.division_descr, "
query = query & "		                 m1.region_code, "
query = query & "		                 m1.region_descr, "
query = query & "		                 wd1.year_descr,  "
query = query & "		                 wd1.month_descr, "
query = query & "		                 wd1.FISCAL_MONTH_NUMBER, "
query = query & "		                 mf.pounds_shipped AS mf_pounds_shipped, "
query = query & "		                 mf.gross_sales_amount AS mf_gross_sales_amount,   "
query = query & "		                 mf.allow_amount AS mf_allow_amount, "
query = query & "		                 mf.gross_sales_variance AS mf_revenue_adjustment, "
query = query & "		                 mf.off_invoice_amount AS mf_off_invoice_amount,   "
query = query & "		                 0 AS ids_pounds_shipped,   "
query = query & "		                 0 AS ids_indirect_sales_amount   "
query = query & "		                 FROM tdw_owner.restated_mkt_prd_bus_div_dim mpbd1,   "
query = query & "		                 tdw_owner.restated_market m1,  "
query = query & "		                 tdw_owner.restated_product p1, "
query = query & "		                 tdw_owner.ta_margin_fact_view mf, "
query = query & "		                 tdw_owner.week_dim wd1, "
query = query & "		                 tdw_owner.group_detail gd,   "
query = query & "		                 tdw_owner.group_description groupdescr   "
query = query & "		                 WHERE mf.restated_market_key = m1.restated_market_key   "
query = query & "		                 AND mf.restated_product_key = p1.restated_product_key   "
query = query & "		                 AND mf.restated_market_key = mpbd1.restated_market_key   "
query = query & "		                 AND mf.restated_product_key = mpbd1.restated_product_key "
query = query & "		                 AND To_DATE(mf.week_key,'YYYYMMDD')  = wd1.week_ending_date "
query = query & "		                 AND gd.GROUP_CODE = groupdescr.GROUP_CODE   "
query = query & "		                 AND gd.group_field_c  =  m1.DIVISION_CODE   "
query = query & "		                 AND (mpbd1.sales_unit_code IN ('F01', 'F03', 'F04', 'F08', 'F30' ,'F31' ,'F15','F20'))  "
query = query & "		                 AND (m1.selling_group_code IN ('119000', '125000', '610000', '800000', '423000')) "
query = query & "		                 AND (wd1.YEAR_DESCR IN (:p_year)) "
query = query & "		                 AND wd1.FISCAL_MONTH_NUMBER <= :p_Month "
query = query & "		                 AND (mpbd1.sales_unit_code IN (:p_sales_unit))  "
query = query & "		                 AND (m1.division_code IN (:p_salesdivision))   "
query = query & "		                 AND (m1.region_code IN (:p_salesregion))   "
query = query & "		                 AND (m1.primary_broker_code IN (:p_primarybroker))   "
query = query & "		                 AND gd.GROUP_CODE in (:vp) "
query = query & "		                  "
query = query & "		                 UNION  ALL "
query = query & "		                  "
query = query & "		                 SELECT   "
query = query & "		                 mpbd1.sales_unit_code,  		 "
query = query & "		                 case when mpbd1.sales_unit_code = 'F01' Then 'Distribution Frozen'   "
query = query & "		                      when mpbd1.sales_unit_code = 'F08' Then 'Distribut Prep Foods'  "
query = query & "		                      when mpbd1.sales_unit_code = 'F15' Then 'Distribution Other'    "
query = query & "		                      when mpbd1.sales_unit_code = 'F03' Then 'Distribution Market'   "
query = query & "		                      when mpbd1.sales_unit_code = 'F04' Then 'Distribution CVP'      "
query = query & "		                      when mpbd1.sales_unit_code = 'F20' Then 'Distribution Fowl'     "
query = query & "		                      when mpbd1.sales_unit_code = 'F30' Then 'Gov''t Sales-Poultry'  "
query = query & "		                      when mpbd1.sales_unit_code = 'F31' Then 'Gov''t Sales-Prepared' "
query = query & "                                      End as sales_unit_descr,		 "
query = query & "		                 gd.group_code, "
query = query & "		                 groupdescr.group_descr, "
query = query & "		                 m1.division_code, "
query = query & "		                 m1.division_descr, "
query = query & "		                 m1.region_code, "
query = query & "		                 m1.region_descr, "
query = query & "		                 md1.year_descr,   "
query = query & "		                 md1.month_descr,   "
query = query & "		                 md1.FISCAL_MONTH_NUMBER,   "
query = query & "		                 0 AS mf_pounds_shipped,   "
query = query & "		                 0 AS mf_gross_sales_amount,   "
query = query & "		                 0 AS mf_allow_amount,   "
query = query & "		                 0 AS mf_revenue_adjustment,   "
query = query & "		                 0 AS mf_off_invoice_amount,   "
query = query & "		                 ids.pounds_shipped AS ids_pounds_shipped,   "
query = query & "		                 ids.indirect_sales_amount AS ids_indirect_sales_amount   "
query = query & "		                 FROM tdw_owner.restated_mkt_prd_bus_div_dim mpbd1,   "
query = query & "		                 tdw_owner.restated_market m1,   "
query = query & "		                 tdw_owner.month_dim md1,   "
query = query & "		                 tdw_owner.restated_product p1,   "
query = query & "		                 tdw_owner.indirect_sales ids,   "
query = query & "		                 tdw_owner.week_dim w1,   "
query = query & "		                 tdw_owner.group_detail gd,   "
query = query & "		                 tdw_owner.group_description groupdescr   "
query = query & "		                 WHERE ids.restated_market_key = m1.restated_market_key   "
query = query & "		                 AND ids.restated_product_key = p1.restated_product_key   "
query = query & "		                 AND ids.restated_market_key = mpbd1.restated_market_key   "
query = query & "		                 AND ids.restated_product_key = mpbd1.restated_product_key   "
query = query & "		                 AND ids.week_key = w1.week_key   "
query = query & "		                 AND w1.month_ending_date = md1.month_ending_date   "
query = query & "		                 AND gd.GROUP_CODE = groupdescr.GROUP_CODE   "
query = query & "		                 AND gd.group_field_c  =  m1.DIVISION_CODE "
query = query & "		                 AND (mpbd1.sales_unit_code IN ('F01', 'F03', 'F04', 'F08', 'F30' ,'F31' ,'F15','F20')) "
query = query & "		                 AND (m1.selling_group_code IN ('119000', '125000', '610000', '800000', '423000'))   "
query = query & "		                 AND (md1.year_descr IN (:p_year))   "
query = query & "		                 and md1.fiscal_month_number <= :p_Month   "
query = query & "		                 AND (mpbd1.sales_unit_code IN (:p_sales_unit))  "
query = query & "		                 AND (m1.division_code IN (:p_salesdivision))   "
query = query & "		                 AND (m1.region_code IN (:p_salesregion))   "
query = query & "		                 AND (m1.primary_broker_code IN (:p_primarybroker))   "
query = query & "		                 AND gd.GROUP_CODE in (:vp)   "
query = query & "		               ) /*end sub query*/   "
query = query & "		               ids_mf "
query = query & "		               GROUP BY "
query = query & "		               1, "
query = query & "		               2, "
query = query & "		               3, "
query = query & "		               4, "
query = query & "		               5, "
query = query & "		               6, "
query = query & "					   ids_mf.sales_unit_code,    "
query = query & "		               ids_mf.year_descr,   "
query = query & "		               ids_mf.month_descr,   "
query = query & "		               ids_mf.FISCAL_MONTH_NUMBER,   "
query = query & "		               ids_mf.sales_unit_descr "
query = query & "		               ORDER BY DEPT_LEVEL_SEQ, CUSTOMER_LEVEL_SEQ, MANAGEMENT_LEVEL_SEQ, spend_base_seq, spend_subcategory_seq"