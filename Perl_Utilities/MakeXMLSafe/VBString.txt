query = "SELECT IDS_MF.BUSINESS_DIVISION_CODE                                              ," 
query = query & "  INITCAP(IDS_MF.BUSINESS_DIVISION_DESCR)AS BusinessDivisionDescr                  , "
query = query & "  (IDS_MF.BUSINESS_DIVISION_CODE "
query = query & "  ||'--' "
query = query & "  ||INITCAP(IDS_MF.BUSINESS_DIVISION_DESCR))AS BusinessDivisionCodeDescr           , "
query = query & "  IDS_MF.REGION_CODE                                                               , "
query = query & "  IDS_MF.REGION_DESCR                                                              , "
query = query & "  IDS_MF.MINOR_LINE_CODE                                                           , "
query = query & "  INITCAP(IDS_MF.MINOR_LINE_DESCR) AS MINOR_LINE_DESCR                             , "
query = query & "  IDS_MF.YEAR_DESCR                                                                , "
query = query & "  IDS_MF.MONTH_DESCR                                                               , "
query = query & "  SUM(IDS_MF.MF_Pounds_Shipped     + IDS_MF.IDS_Pounds_Shipped)                                                                                               AS TOTAL_POUNDS_SHIPPED, "
query = query & "  SUM(IDS_MF.MF_Gross_Sales_Amount - IDS_MF.MF_Allow_Amount - IDS_MF.MF_Off_Invoice_Amount + IDS_MF.MF_Revenue_Adjustment + IDS_MF.IDS_Indirect_Sales_Amount) AS NET_RECEIVABLE_DOLLAR "
query = query & "   FROM "
query = query & "  ( "
query = query & "  /*Begin Sub query*/ "
query = query & "   SELECT MPBD1.BUSINESS_DIVISION_CODE                  , "
query = query & "    MPBD1.BUSINESS_DIVISION_DESCR                       , "
query = query & "    M1.REGION_CODE                                      , "
query = query & "    M1.REGION_DESCR                                     , "
query = query & "    P1.MINOR_LINE_CODE                                  , "
query = query & "    P1.MINOR_LINE_DESCR                                 , "
query = query & "    WD.YEAR_DESCR                                       , "
query = query & "    WD.MONTH_DESCR                                      , "
query = query & "    MF.POUNDS_SHIPPED     AS MF_Pounds_Shipped     , "
query = query & "    MF.GROSS_SALES_AMOUNT AS MF_Gross_Sales_Amount , "
query = query & "    MF.ALLOW_AMOUNT   AS MF_Allow_Amount       , "
query = query & "    mf.gross_sales_variance AS MF_Revenue_Adjustment , "
query = query & "    MF.OFF_INVOICE_AMOUNT AS MF_Off_Invoice_Amount , "
query = query & "    0                            AS IDS_Pounds_Shipped    , "
query = query & "    0                            AS IDS_Indirect_Sales_Amount "
query = query & "     FROM TDW_OWNER.RESTATED_MKT_PRD_BUS_DIV_DIM MPBD1 , "
query = query & "    TDW_OWNER.RESTATED_MARKET M1                       , "
query = query & "    TDW_OWNER.RESTATED_PRODUCT P1                      , "
query = query & "    tdw_owner.ta_margin_fact_view mf                   , "
query = query & "    tdw_owner.week_dim wd "
query = query & "    WHERE MF.RESTATED_MARKET_KEY      = M1.RESTATED_MARKET_KEY "
query = query & "  AND MF.RESTATED_PRODUCT_KEY         = P1.RESTATED_PRODUCT_KEY "
query = query & "  AND MF.RESTATED_MARKET_KEY          = MPBD1.RESTATED_MARKET_KEY "
query = query & "  AND MF.RESTATED_PRODUCT_KEY         = MPBD1.RESTATED_PRODUCT_KEY "
query = query & "  AND To_DATE(mf.week_key,'YYYYMMDD') = wd.week_ending_date "
query = query & "  AND(MPBD1.BUSINESS_DIVISION_CODE IN ('F01', 'F03','F04', 'F08', 'F11', 'F12', 'F15')) "
query = query & "  AND (M1.SELLING_GROUP_CODE       IN ('119000','125000','610000','800000','423000')) "
query = query & "  AND (wd.YEAR_DESCR               IN ('FY2009')) "
query = query & "  AND wd.FISCAL_MONTH_NUMBER <= 12 "
query = query & "  AND (MPBD1.BUSINESS_DIVISION_CODE IN('F01', 'F03', 'F04', 'F08', 'F11', 'F12', 'F15')) "
query = query & "  AND(M1.DIVISION_CODE              IN('102','141')) "
query = query & "  AND (M1.REGION_CODE               IN('137','169')) "
query = query & "  AND (M1.PRIMARY_BROKER_CODE       IN('321','544')) "
query = query & "                 "
query = query & " "
query = query & "    UNION ALL "
query = query & "    "
query = query & "   SELECT "
query = query & "    MPBD1.BUSINESS_DIVISION_CODE                 , "
query = query & "    MPBD1.BUSINESS_DIVISION_DESCR                , "
query = query & "    M1.REGION_CODE                               , "
query = query & "    M1.REGION_DESCR                              , "
query = query & "    P1.MINOR_LINE_CODE                           , "
query = query & "    P1.MINOR_LINE_DESCR                          , "
query = query & "    MD.YEAR_DESCR                                , "
query = query & "    MD.MONTH_DESCR                               , "
query = query & "    0 AS MF_Pounds_Shipped                       , "
query = query & "    0 AS MF_Gross_Sales_Amount                   , "
query = query & "    0 AS MF_Allow_Amount                         , "
query = query & "    0 AS MF_Revenue_Adjustment                   , "
query = query & "    0 AS MF_Off_Invoice_Amount                   , "
query = query & "    IDS.POUNDS_SHIPPED AS IDS_Pounds_Shipped , "
query = query & "    IDS.INDIRECT_SALES_AMOUNT AS IDS_Indirect_Sales_Amount "
query = query & "     FROM TDW_OWNER.RESTATED_MKT_PRD_BUS_DIV_DIM MPBD1 , "
query = query & "    TDW_OWNER.RESTATED_MARKET M1                       , "
query = query & "    TDW_OWNER.MONTH_DIM MD                             , "
query = query & "    TDW_OWNER.RESTATED_PRODUCT P1                      , "
query = query & "    TDW_OWNER.INDIRECT_SALES IDS                       , "
query = query & "    TDW_OWNER.WEEK_DIM W "
query = query & "    WHERE IDS.RESTATED_MARKET_KEY    = M1.RESTATED_MARKET_KEY "
query = query & "  AND IDS.RESTATED_PRODUCT_KEY       = P1.RESTATED_PRODUCT_KEY "
query = query & "  AND IDS.RESTATED_MARKET_KEY        = MPBD1.RESTATED_MARKET_KEY "
query = query & "  AND IDS.RESTATED_PRODUCT_KEY       = MPBD1.RESTATED_PRODUCT_KEY "
query = query & "  AND IDS.WEEK_KEY                   = W.WEEK_KEY "
query = query & "  AND W.MONTH_ENDING_DATE            = MD.MONTH_ENDING_DATE "
query = query & "  AND(MPBD1.BUSINESS_DIVISION_CODE  IN ('F01', 'F03', 'F04', 'F08', 'F11', 'F12', 'F15')) "
query = query & "  AND (M1.SELLING_GROUP_CODE        IN ('119000','125000','610000','800000','423000')) "
query = query & "  AND (MD.YEAR_DESCR                IN('FY2009')) "
query = query & "  AND (MD.FISCAL_MONTH_NUMBER        = (12)) "
query = query & "  AND (MPBD1.BUSINESS_DIVISION_CODE IN('F01','F03','F04','F08','F11','F12','F15')) "
query = query & "  AND (M1.DIVISION_CODE             IN('102','141')) "
query = query & "  AND (M1.REGION_CODE               IN('137','169')) "
query = query & "  AND (M1.PRIMARY_BROKER_CODE       IN('321','544')) "
query = query & "  ) "
query = query & "  /*end sub query*/ "
query = query & "  IDS_MF "
query = query & "GROUP BY IDS_MF.BUSINESS_DIVISION_CODE   , "
query = query & "  INITCAP(IDS_MF.BUSINESS_DIVISION_DESCR), "
query = query & "  IDS_MF.REGION_CODE                        , "
query = query & "  IDS_MF.REGION_DESCR                       , "
query = query & "  IDS_MF.MINOR_LINE_CODE                    , "
query = query & "  INITCAP(IDS_MF.MINOR_LINE_DESCR)          , "
query = query & "  IDS_MF.YEAR_DESCR                    , "
query = query & "  IDS_MF.MONTH_DESCR "
query = query & "ORDER BY BusinessDivisionDescr, "
query = query & "IDS_MF.MINOR_LINE_CODE "
query = query & ""